"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([["9007"],{9990:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>a,toc:()=>d,default:()=>c,metadata:()=>r,assets:()=>l,contentTitle:()=>t});var r=JSON.parse('{"id":"admin/upgrade/12.0-bookworm/index","title":"Migrer de 11.x vers 12.x","description":"L\'objectif cette page est de d\xe9crire le processus de migration d\'une instance en YunoHost 11.x (tournant sous Debian Bullseye) vers YunoHost 12.x (tournant sous Debian Bookworm).","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/admin/55.upgrade/12.0-bookworm/index.mdx","sourceDirName":"admin/55.upgrade/12.0-bookworm","slug":"/admin/upgrade/12.0-bookworm/","permalink":"/doc/pr-2675/fr/admin/upgrade/12.0-bookworm/","draft":false,"unlisted":false,"editUrl":"https://github.com/YunoHost/doc/tree/main/i18n/fr/docusaurus-plugin-content-docs/current/admin/55.upgrade/12.0-bookworm/index.mdx","tags":[],"version":"current","frontMatter":{"title":"Migrer de 11.x vers 12.x"},"sidebar":"admin","previous":{"title":"Migrating from 4.x to 11.x","permalink":"/doc/pr-2675/fr/admin/upgrade/11.0-bullseye"},"next":{"title":"Migration isues FAQ","permalink":"/doc/pr-2675/fr/admin/upgrade/12.0-bookworm/issues_faq"}}'),s=i(4848),o=i(4429);let a={title:"Migrer de 11.x vers 12.x"},t,l={},d=[{value:"Notes importantes",id:"notes-importantes",level:2},{value:"Proc\xe9dure de migration",id:"proc\xe9dure-de-migration",level:2},{value:"Depuis la webadmin",id:"depuis-la-webadmin",level:3},{value:"Depuis la ligne de commande",id:"depuis-la-ligne-de-commande",level:3},{value:"Pendant la migration",id:"pendant-la-migration",level:2},{value:"Si la migration \xe9choue",id:"si-la-migration-\xe9choue",level:2},{value:"Apr\xe8s la migration",id:"apr\xe8s-la-migration",level:2},{value:"V\xe9rifier la version de Debian et YunoHost",id:"v\xe9rifier-la-version-de-debian-et-yunohost",level:3},{value:"Ex\xe9cuter les nouvelles migrations",id:"ex\xe9cuter-les-nouvelles-migrations",level:3},{value:"Agreeing to the new Terms of Service via command line",id:"agreeing-to-the-new-terms-of-service-via-command-line",level:4},{value:"V\xe9rifiez que le diagnostic ne rapporte pas de probl\xe8me particulier",id:"v\xe9rifiez-que-le-diagnostic-ne-rapporte-pas-de-probl\xe8me-particulier",level:3},{value:"V\xe9rifiez que les applications fonctionnent",id:"v\xe9rifiez-que-les-applications-fonctionnent",level:3},{value:"Soucis connus apr\xe8s la migration",id:"soucis-connus-apr\xe8s-la-migration",level:2}];function u(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"L'objectif cette page est de d\xe9crire le processus de migration d'une instance en YunoHost 11.x (tournant sous Debian Bullseye) vers YunoHost 12.x (tournant sous Debian Bookworm)."}),"\n",(0,s.jsx)(n.h2,{id:"notes-importantes",children:"Notes importantes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"The YunoHost team did its best to make sure that the migration is as smooth as possible and was tested over the course of several months in several cases."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Please ",(0,s.jsx)(n.a,{href:"/admin/backups",children:"backup your data and server"}),"! This migration is a complex operation and covering every pitfall is quite hard. And in any case, be patient and attentive during the migration."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:['Ne vous pr\xe9cipitez pas \xe0 vouloir faire une r\xe9installation de votre syst\xe8me en pensant que cela serait "plus simple" (sigh). (Une attitude qui revient r\xe9guli\xe8rement est de vouloir r\xe9installer son syst\xe8me \xe0 la moindre complication...). \xc0 la place, si vous rencontrez des probl\xe8mes, nous vous encourageons \xe0 investiguer, chercher \xe0 comprendre et ',(0,s.jsx)(n.a,{href:"/community/help",children:"trouver de l'aide sur le chat ou le forum"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"You should watch the known issues at the bottom of this page, to be sure your migrations will work properly."})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"proc\xe9dure-de-migration",children:"Proc\xe9dure de migration"}),"\n",(0,s.jsx)(n.p,{children:"Vous devez d'abord vous assurer que votre syst\xe8me est \xe0 jour. La migration est disponible \xe0 partir de la version 11.3."}),"\n",(0,s.jsx)(n.p,{children:"Il est recommend\xe9 de lancer la migration depuis la ligne de commande, mais elle peut tr\xe8s bien \xeatre effectu\xe9e depuis la webadmin."}),"\n",(0,s.jsx)(n.h3,{id:"depuis-la-webadmin",children:"Depuis la webadmin"}),"\n",(0,s.jsx)(n.p,{children:"Allez dans Outils > Migrations pour acc\xe9der \xe0 l'interface de migration. Il vous faudra ensuite lire l'avertissement attentivement et l'accepter pour lancer la migration."}),"\n",(0,s.jsx)(n.p,{children:"Notez que m\xeame si vous fermez la page d'admin, la migration continuera (par contre l'interface d'admin sera partiellement indisponible)."}),"\n",(0,s.jsx)(n.h3,{id:"depuis-la-ligne-de-commande",children:"Depuis la ligne de commande"}),"\n",(0,s.jsx)(n.p,{children:"Lancez simplement :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo yunohost tools migrations run\n"})}),"\n",(0,s.jsx)(n.p,{children:"puis lisez attentivement l'avertissement et les instructions."}),"\n",(0,s.jsx)(n.h2,{id:"pendant-la-migration",children:"Pendant la migration"}),"\n",(0,s.jsx)(n.p,{children:"En fonction de votre mat\xe9riel et des paquets install\xe9s, la migration peut prendre jusqu'\xe0 une ou deux heures."}),"\n",(0,s.jsx)(n.p,{children:"Les logs seront affich\xe9s dans la barre de message au centre de la page (vous pouvez approcher la souris dessus pour voir l'historique en entier). Ils seront \xe9galement consultable apr\xe8s coup (comme les autres op\xe9rations) dans Outils > Journaux."}),"\n",(0,s.jsx)(n.h2,{id:"si-la-migration-\xe9choue",children:"Si la migration \xe9choue"}),"\n",(0,s.jsxs)(n.p,{children:["Si la migration a \xe9chou\xe9 a un moment donn\xe9, la premi\xe8re chose \xe0 faire est de tenter de la relancer. Si cela ne fonctionne toujours pas, il vous faut ",(0,s.jsx)(n.a,{href:"/community/help",children:"trouver de l'aide"})," (pri\xe8re de fournir le/les messages correspondants ou tout \xe9l\xe9ment qui vous fait penser que \xe7a n'a pas march\xe9)."]}),"\n",(0,s.jsx)(n.h2,{id:"apr\xe8s-la-migration",children:"Apr\xe8s la migration"}),"\n",(0,s.jsx)(n.h3,{id:"v\xe9rifier-la-version-de-debian-et-yunohost",children:"V\xe9rifier la version de Debian et YunoHost"}),"\n",(0,s.jsx)(n.p,{children:"Pour cela allez dans l'outil de diagnostics ou regardez en bas \xe0 droite de la webadmin pour trouver la version de YunoHost."}),"\n",(0,s.jsxs)(n.p,{children:["En ligne de commande vous pouvez utiliser ",(0,s.jsx)(n.code,{children:"lsb_release -a"})," et ",(0,s.jsx)(n.code,{children:"yunohost --version"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"ex\xe9cuter-les-nouvelles-migrations",children:"Ex\xe9cuter les nouvelles migrations"}),"\n",(0,s.jsx)(n.p,{children:"Apr\xe8s la mise \xe0 niveau, de nouvelles migrations sont apparues :"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Rebuilding the virtualenvs of your Python apps"}),"\n",(0,s.jsx)(n.li,{children:"Migrate from PostgreSQL 13 to 15"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Vous devez les lancer le plus t\xf4t possible pour garantir le bon fonctionnement de vos applis."}),"\n",(0,s.jsx)(n.h4,{id:"agreeing-to-the-new-terms-of-service-via-command-line",children:"Agreeing to the new Terms of Service via command line"}),"\n",(0,s.jsxs)(n.p,{children:["YunoHost 12.x now requires that you agree to the new ",(0,s.jsx)(n.a,{href:"https://doc.yunohost.org/terms_of_services/",children:"Terms of Service"}),". After reading and accepting them you can run:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"yunohost tools migrations run 0031_terms_of_services --accept-disclaimer\n"})}),"\n",(0,s.jsx)(n.h3,{id:"v\xe9rifiez-que-le-diagnostic-ne-rapporte-pas-de-probl\xe8me-particulier",children:"V\xe9rifiez que le diagnostic ne rapporte pas de probl\xe8me particulier"}),"\n",(0,s.jsx)(n.p,{children:"Dans l'outil de diagnostics de la webadmin, v\xe9rifiez qu'il n'y a pas de probl\xe8me apparu suite \xe0 la migration (par exemple un service qui ne tournerais plus...)"}),"\n",(0,s.jsx)(n.h3,{id:"v\xe9rifiez-que-les-applications-fonctionnent",children:"V\xe9rifiez que les applications fonctionnent"}),"\n",(0,s.jsx)(n.p,{children:"V\xe9rifiez que vos applications install\xe9es fonctionnent... Si elles ne fonctionnent pas, il est recommand\xe9 de tenter de les mettre \xe0 jour. (ou bien de mani\xe8re g\xe9n\xe9rale, il est recommand\xe9 de les mettre \xe0 jour m\xeame si elles fonctionnent\u202F!)."}),"\n",(0,s.jsxs)(n.p,{children:["Si votre app est cass\xe9e et que vous \xe9tiez d\xe9j\xe0 sur la derni\xe8re version d'une application, vous pouvez relancer la mise \xe0 jour gr\xe2ce \xe0 l'option ",(0,s.jsx)(n.code,{children:"--force"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yunohost app upgrade --force APP_NAME\n"})}),"\n",(0,s.jsx)(n.h2,{id:"soucis-connus-apr\xe8s-la-migration",children:"Soucis connus apr\xe8s la migration"}),"\n",(0,s.jsxs)(n.p,{children:["Veuillez consulter ",(0,s.jsx)(n.a,{href:"/admin/upgrade/12.0-bookworm/issues_faq/",children:"la FAQ des probl\xe8mes de migration"})," (en anglais)."]})]})}function c(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},4429:function(e,n,i){i.d(n,{R:()=>a,x:()=>t});var r=i(6540);let s={},o=r.createContext(s);function a(e){let n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);