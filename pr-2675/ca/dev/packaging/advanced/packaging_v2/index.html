<!doctype html><html lang=ca dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-dev/packaging/advanced/packaging_v2" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>Packaging v2 | Yunohost</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:image content=https://yunohost.org/assets/img/portal_simple_dark.jpg /><meta data-rh=true name=twitter:image content=https://yunohost.org/assets/img/portal_simple_dark.jpg /><meta data-rh=true property=og:url content=https://doc.next.yunohost.org/doc/pr-2675/ca/dev/packaging/advanced/packaging_v2 /><meta data-rh=true property=og:locale content=ca /><meta data-rh=true property=og:locale:alternate content=ar /><meta data-rh=true property=og:locale:alternate content=de /><meta data-rh=true property=og:locale:alternate content=en /><meta data-rh=true property=og:locale:alternate content=es /><meta data-rh=true property=og:locale:alternate content=fr /><meta data-rh=true property=og:locale:alternate content=it /><meta data-rh=true property=og:locale:alternate content=oc /><meta data-rh=true property=og:locale:alternate content=ru /><meta data-rh=true property=og:locale:alternate content=en_GB /><meta data-rh=true name=docusaurus_locale content=ca /><meta data-rh=true name=docsearch:language content=ca /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content="Packaging v2 | Yunohost"/><meta data-rh=true name=description content="Packaging v2 is a major improvement for the packaging introduced in YunoHost 11.1"/><meta data-rh=true property=og:description content="Packaging v2 is a major improvement for the packaging introduced in YunoHost 11.1"/><link data-rh=true rel=icon href=/doc/pr-2675/ca/img/favicon.png /><link data-rh=true rel=canonical href=https://doc.next.yunohost.org/doc/pr-2675/ca/dev/packaging/advanced/packaging_v2 /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2675/ar/dev/packaging/advanced/packaging_v2 hreflang=ar /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2675/ca/dev/packaging/advanced/packaging_v2 hreflang=ca /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2675/de/dev/packaging/advanced/packaging_v2 hreflang=de /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2675/en/dev/packaging/advanced/packaging_v2 hreflang=en /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2675/es/dev/packaging/advanced/packaging_v2 hreflang=es /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2675/fr/dev/packaging/advanced/packaging_v2 hreflang=fr /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2675/it/dev/packaging/advanced/packaging_v2 hreflang=it /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2675/oc/dev/packaging/advanced/packaging_v2 hreflang=oc /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2675/ru/dev/packaging/advanced/packaging_v2 hreflang=ru /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2675/dev/packaging/advanced/packaging_v2 hreflang=en-GB /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2675/dev/packaging/advanced/packaging_v2 hreflang=x-default /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://doc.next.yunohost.org/doc/pr-2675/ca/dev/packaging/","name":"üì¶ Application packaging","position":1},{"@type":"ListItem","item":"https://doc.next.yunohost.org/doc/pr-2675/ca/packaging/advanced","name":"Advanced","position":2},{"@type":"ListItem","item":"https://doc.next.yunohost.org/doc/pr-2675/ca/dev/packaging/advanced/packaging_v2","name":"Packaging v2","position":3}]}</script><script src=/js/language-detect.js async data-language-redirect='{"ar":"/ar/","ca":"/ca/","de":"/de/","en":"/en/","es":"/es/","fr":"/fr/","it":"/it/","oc":"/oc/","ru":"/ru/"}'></script><link rel=stylesheet href=/doc/pr-2675/ca/assets/css/styles.c3b944cb.css /><script src=/doc/pr-2675/ca/assets/js/runtime~main.9f139cb5.js defer></script><script src=/doc/pr-2675/ca/assets/js/main.99d06db4.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/doc/pr-2675/ca/img/icons/logo-ynh_horizontal.png /><link rel=preload as=image href=/doc/pr-2675/ca/img/icons/ynh_logo_roundcorner.png /><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/doc/pr-2675/ca/><div class=navbar__logo><img src=/doc/pr-2675/ca/img/icons/logo-ynh_horizontal.png alt="Yunohost Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/doc/pr-2675/ca/img/icons/logo-ynh_horizontal.png alt="Yunohost Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div><b class="navbar__title text--truncate">Docs</b></a><a class="navbar__item navbar__link" href=/doc/pr-2675/ca/admin/>Administration</a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/doc/pr-2675/ca/dev/>Development and packaging</a><a class="navbar__item navbar__link" href=/doc/pr-2675/ca/community/>Community</a><a href=https://apps.yunohost.org/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">Apps catalog<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class=navbarSearchContainer_Bca1><div class=navbar__search><span aria-label="expand searchbar" role=button class=search-icon tabindex=0></span><input id=search_input_react type=search placeholder=Loading... aria-label=Search class="navbar__search-input search-bar" disabled/></div></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>Catal√†</a><ul class=dropdown__menu><li><a href="/doc/pr-2675/ar/dev/packaging/advanced/packaging_v2?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=ar>ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</a><li><a href="/doc/pr-2675/ca/dev/packaging/advanced/packaging_v2?persistLocale=true" target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=ca>Catal√†</a><li><a href="/doc/pr-2675/de/dev/packaging/advanced/packaging_v2?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=de>Deutsch</a><li><a href="/doc/pr-2675/en/dev/packaging/advanced/packaging_v2?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href="/doc/pr-2675/es/dev/packaging/advanced/packaging_v2?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=es>Espa√±ol</a><li><a href="/doc/pr-2675/fr/dev/packaging/advanced/packaging_v2?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=fr>Fran√ßais</a><li><a href="/doc/pr-2675/it/dev/packaging/advanced/packaging_v2?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=it>Italiano</a><li><a href="/doc/pr-2675/oc/dev/packaging/advanced/packaging_v2?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=oc>Occitan</a><li><a href="/doc/pr-2675/ru/dev/packaging/advanced/packaging_v2?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=ru>–†—É—Å—Å–∫–∏–π</a><li><a href="/doc/pr-2675/dev/packaging/advanced/packaging_v2?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=en-GB>British English</a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/doc/pr-2675/ca/><img src=/doc/pr-2675/ca/img/icons/logo-ynh_horizontal.png alt="Yunohost Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/doc/pr-2675/ca/img/icons/logo-ynh_horizontal.png alt="Yunohost Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/><b>Docs</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/doc/pr-2675/ca/dev/><span title="Contributing to YunoHost" class=linkLabel_WmDU>Contributing to YunoHost</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/doc/pr-2675/ca/dev/git/><span title="üõ†Ô∏è Working with Git / Github" class=linkLabel_WmDU>üõ†Ô∏è Working with Git / Github</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/doc/pr-2675/ca/dev/doc/><span title="üìù Working on the documentation" class=linkLabel_WmDU>üìù Working on the documentation</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href=/doc/pr-2675/ca/dev/packaging/><span title="üì¶ Application packaging" class=categoryLinkLabel_W154>üì¶ Application packaging</span></a><button aria-label="Collapse sidebar category 'üì¶ Application packaging'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/structure><span title="App structure" class=linkLabel_WmDU>App structure</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/manifest><span title=manifest.toml class=linkLabel_WmDU>manifest.toml</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/resources><span title=Resources class=linkLabel_WmDU>Resources</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/doc/pr-2675/ca/dev/packaging/scripts/><span title="App scripts" class=categoryLinkLabel_W154>App scripts</span></a><button aria-label="Collapse sidebar category 'App scripts'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/scripts/shell_variables_scope><span title="General scope of variables" class=linkLabel_WmDU>General scope of variables</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/scripts/helpers_v2.0><span title="App helpers (v2)" class=linkLabel_WmDU>App helpers (v2)</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/scripts/helpers_v2.1><span title="App helpers (v2.1)" class=linkLabel_WmDU>App helpers (v2.1)</span></a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/doc><span title="Documenting apps" class=linkLabel_WmDU>Documenting apps</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/test><span title="Testing your app" class=linkLabel_WmDU>Testing your app</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/publish><span title="Publishing your app on the catalog" class=linkLabel_WmDU>Publishing your app on the catalog</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex=0 href=/doc/pr-2675/ca/packaging/advanced><span title=Advanced class=categoryLinkLabel_W154>Advanced</span></a><button aria-label="Collapse sidebar category 'Advanced'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/advanced/config_panels><span title="Config Panels" class=linkLabel_WmDU>Config Panels</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/advanced/sso_ldap_integration><span title="SSO/LDAP integration" class=linkLabel_WmDU>SSO/LDAP integration</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/advanced/hooks><span title=Hooks class=linkLabel_WmDU>Hooks</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/advanced/advanced_packagers><span title="Advanced packagers" class=linkLabel_WmDU>Advanced packagers</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/doc/pr-2675/ca/dev/packaging/advanced/packaging_v2><span title="Packaging v2" class=linkLabel_WmDU>Packaging v2</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/doc/pr-2675/ca/category/misc-resources><span title="Misc resources" class=categoryLinkLabel_W154>Misc resources</span></a><button aria-label="Expand sidebar category 'Misc resources'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2675/ca/dev/packaging/policy><span title="Catalog policy" class=linkLabel_WmDU>Catalog policy</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/doc/pr-2675/ca/dev/core/><span title="‚öôÔ∏è Core development" class=categoryLinkLabel_W154>‚öôÔ∏è Core development</span></a><button aria-label="Expand sidebar category '‚öôÔ∏è Core development'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/doc/pr-2675/ca/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/doc/pr-2675/ca/dev/packaging/><span>üì¶ Application packaging</span></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/doc/pr-2675/ca/packaging/advanced><span>Advanced</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Packaging v2</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Packaging v2</h1></header><p>Packaging v2 is a major improvement for the packaging introduced in YunoHost 11.1</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=motivation>Motivation<a href=#motivation class=hash-link aria-label="Direct link to Motivation" title="Direct link to Motivation" translate=no>‚Äã</a></h3>
<p>The motivations for this new format is:</p>
<ul>
<li class="">to get rid of some boring or unecessarily complex or duplicateds stuff such as saving/loading settings, creating a system user, etc.. during the install/upgrade/restore script, which are common things accross many apps.</li>
<li class="">to get rid of funky historical, not-super-semantic stuff such as <code>__FINALPATH__</code> being replaced by <code>$final_path</code> (with underscore), or <code>__PATH__</code> being replaced by <code>$path_url</code>, etc.</li>
<li class="">formalize some aspects such as the existence of the install dir, data dir, apt dependencies, database, etc. which in turn unlock possible future developments such as computing the space used by an app at one given moment, auto-upgrading apt dependencies during Debian major migration, etc.</li>
<li class="">formalize some meta-info such as LDAP/SSO support, architectures supports, and other pre-install / post-install, pre-upgrade / post-upgrade notifications (replacing the infamous <code>ynh_send_readme_to_admin</code>) for better UI/UX during the install and upgrade process.</li>
</ul>
<p>However, this "v2" is not the end of the story and should be seen as an intermediate stage before a "v3" packaging. In particular this "v3" packaging should also formalize the handling of the system and app configurations files and ultimately rework the entire paradigm of the install/remove/upgrade/backup/restore scripts.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=adapting-a-v1-app-to-v2>Adapting a v1 app to v2<a href=#adapting-a-v1-app-to-v2 class=hash-link aria-label="Direct link to Adapting a v1 app to v2" title="Direct link to Adapting a v1 app to v2" translate=no>‚Äã</a></h3>
<p>A script is available in <a href=https://github.com/YunoHost/apps_tools/tree/main/packaging_v2 target=_blank rel="noopener noreferrer" class="">the apps_tools repository</a> and will attempt to convert what it can from the v1 format to the v2 format, in particular:</p>
<ul>
<li class="">initializing a <code>manifest.toml</code> and prefilling it with info scrapped from the various scripts</li>
<li class="">comment out now-unecessary lines in the various scripts</li>
</ul>
<p>Usage: <code>python3 convert_app_to_packaging_v2.py /path/yo/your/app</code></p>
<p>This will edit the file in place and you should then carefully review and iterate over what the script did for you.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=highlights-of-the-new-format>Highlights of the new format<a href=#highlights-of-the-new-format class=hash-link aria-label="Direct link to Highlights of the new format" title="Direct link to Highlights of the new format" translate=no>‚Äã</a></h3>
<p>The <a href=https://github.com/YunoHost/example_ynh target=_blank rel="noopener noreferrer" class="">example repo</a> illustrates the below.</p>
<ul>
<li class=""><strong>The manifest is now written as toml (<code>manifest.toml</code>)</strong> instead of json (<code>manifest.json</code>). The structure of the manifest itself has been reworked and now include:<!-- -->
<ul>
<li class="">The <code>upstream</code> section (now mandatory)</li>
<li class="">An <code>integration</code> section meant to formalize what minimum YunoHost version is required, the list of supported architectures, declare if SSO/LDAP is supported, typical resource usage. This is meant to be displayed both in the catalog (similar to app stores) and on the app info page after installing the app - though this is still work in progress.</li>
<li class="">A <code>resource</code> section (detailed below)</li>
</ul>
</li>
<li class=""><strong>Install questions are now automatically saved as settings</strong> (except user-provided password and other specific infos)</li>
<li class=""><strong>All settings are now automatically loaded in app script environments</strong> (so e.g. directly define <code>$domain</code>, etc.)</li>
<li class=""><strong>Auto-enable <code>set -eu</code></strong> a.k.a. <code>ynh_abort_if_errors</code> in appropriate scripts</li>
<li class=""><strong>The safety-backup-before-upgrade is now automatically handled by the core</strong></li>
<li class=""><strong>Simplify writing change-url scripts</strong>: old the <code>new</code>/<code>old</code>/<code>change</code> <code>domain</code>/<code>path</code> are now automatically available in the context and a new helper <code>ynh_change_url_nginx_config</code> takes care of tweaking the nginx conf. Your script should essentially just call that helper and possibly tweak the app's conf and possibly restart the app's service</li>
<li class=""><strong>Introduce a new <code>resource</code> mechanism</strong>
<ul>
<li class="">Resources are declared in the <code>manifest.toml</code>.</li>
<li class="">They are meant to formalize recurring app needs that are to be provisioned/deprovisioned by the core.</li>
<li class="">They include for example: system user, apt dependencies, install dir, data dir, port, permissions, SQL database...</li>
<li class="">Each resource is to be provisioned <em>before</em> running the install script, deprovisioned <em>after</em> the remove script, and automatically upgraded if needed before running the upgrade script (or provisionned if introduced in the new app version, or deprovisioned if removed w.r.t. the previous app version)</li>
<li class="">More infos about resources and their options and behavior are available in the dedicated doc page</li>
</ul>
</li>
<li class=""><strong>Permissions are automatically initialized using the answer to the <code>init_main_permission</code> install question</strong> (replacing the <code>is_public</code> question). No need to write a boring <code>if $is_public ...</code> in the install script to add visitors anymore ! There is a similar mechanism to init other permissions, eg <code>init_admin_permission</code> (cf also the doc about the <code>permission</code> resource)</li>
<li class=""><strong>The content of the <code>doc/</code> folder is now meant to be integrated in the webadmin</strong> (though this is still WIP as of writing this). In particular:<!-- -->
<ul>
<li class=""><code>DESCRIPTION.md</code> and the <code>screenshots/</code> folder are expected to be displayed prior to the app install form (similar to app stores on mobile)</li>
<li class=""><code>ADMIN.md</code> is expected to be made available somewhere in the info page and should contain technical admin notes. Other pages can be defined (just name it <code>WHATEVER.md</code>). Lang codes are also supported following the existing scheme for the README, eg <code>README_fr.md</code> is the French version, hence you can create <code>ADMIN_fr.md</code>, etc.</li>
<li class="">Note that the <code>ADMIN.md</code> page supports the <code>__FOOBAR__</code> notation that will be automatically replaced with the app's <code>foobar</code> setting</li>
</ul>
</li>
<li class=""><strong>Special files called 'notifications' are meant to replace the <code>ynh_send_readme_to_admin</code> mechanics</strong>. They are also to be added to the <code>doc</code> folder:<!-- -->
<ul>
<li class=""><code>doc/PRE_INSTALL.md</code>: a note to be displayed prior to the app install. Typically to warn of something unusual, such as "the app install will automatically add 1GB swap to the system".</li>
<li class=""><code>doc/POST_INSTALL.md</code>: a note to be displayed after the app install. Typically to explain post-install operations to be performed manually by the admin and that cannot be automated.</li>
<li class=""><code>doc/PRE_UPGRADE.md</code>: a note to be displayed prior to any upgrade of this app.</li>
<li class=""><code>doc/PRE_UPGRADE.d/{version}.md</code>: a note to be displayed prior to a specific version upgrade.</li>
<li class=""><code>doc/POST_UPGRADE.md</code>: a note to be displayed after the app upgrade. For example in the context of Nextcloud, the fact that you may need to re-enable custom modules manually?</li>
<li class="">Note that the notifications, like <code>ADMIN.md</code>, supports the <code>__FOOBAR__</code> notation that will be automatically replaced with the app's <code>foobar</code> setting</li>
</ul>
</li>
<li class=""><strong>Replace some historical names with more sensible ones</strong>, or homogenize some practices:<!-- -->
<ul>
<li class=""><code>final_path</code> is now <code>install_dir</code> (this migration should be automatically handled by the core and the <code>convert_app_to_packaging_v2.py</code> script)</li>
<li class=""><code>datadir</code> is now <code>data_dir</code> to be consistent with <code>install_dir</code> (this migration should be automatically handled by the core and the <code>convert_app_to_packaging_v2.py</code> script)</li>
<li class=""><code>path</code> is now always loaded as <code>$path</code>, no funky <code>$path_url</code>-but-it-is-saved-as-<code>path</code> anymore (this migration should be automatically handled by the core and the <code>convert_app_to_packaging_v2.py</code> script)</li>
<li class=""><code>mysqldbpwd</code> and <code>psqlpwd</code> or whatever are now always saved as <code>db_pwd</code> (cf the <code>database</code> resource) (this migration should be automatically handled by the core and the <code>convert_app_to_packaging_v2.py</code> script)</li>
<li class="">ports settings are now always named either <code>$port</code> or <code>$port_foo_bar</code> instead of <code>$foo_bar_port</code> (cf the <code>port</code> resource) (this migration should be automatically handled by the core and the <code>convert_app_to_packaging_v2.py</code> script)</li>
<li class="">the install dir is to be set to <code>/var/www/$app</code> by default for web apps (or can be changed to <code>/opt/????</code> for non-webapps). Note that YunoHost will <strong>automatically move</strong> the old install dir to the new <code>install_dir</code> during the corresponding upgrade.</li>
</ul>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href=https://github.com/YunoHost/doc/tree/main/docs/dev/50.packaging/60.advanced/70.packaging_v2.mdx target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/doc/pr-2675/ca/dev/packaging/advanced/advanced_packagers><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Advanced packagers</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/doc/pr-2675/ca/category/misc-resources><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Misc resources</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#motivation class="table-of-contents__link toc-highlight">Motivation</a><li><a href=#adapting-a-v1-app-to-v2 class="table-of-contents__link toc-highlight">Adapting a v1 app to v2</a><li><a href=#highlights-of-the-new-format class="table-of-contents__link toc-highlight">Highlights of the new format</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Legal</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/YunoHost/yunohost/blob/dev/LICENSE target=_blank rel="noopener noreferrer" class=footer__link-item>License<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a class=footer__link-item href=/doc/pr-2675/ca/community/terms_of_services>CGUs</a><li class=footer__item><a href=https://github.com/YunoHost/project-organization target=_blank rel="noopener noreferrer" class=footer__link-item>Organization<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Follow us</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://forum.yunohost.org/c/announcement/8/none target=_blank rel="noopener noreferrer" class=footer__link-item>Blog<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://toot.aquilenet.fr/@yunohost target=_blank rel="noopener noreferrer" class=footer__link-item>Mastodon<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href="https://videos.globenet.org/a/yunohost/videos?s=1" target=_blank rel="noopener noreferrer" class=footer__link-item>Peertube<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Use</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/doc/pr-2675/ca/>Documentation</a><li class=footer__item><a href=https://apps.yunohost.org/ target=_blank rel="noopener noreferrer" class=footer__link-item>Apps catalog<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://forum.yunohost.org/ target=_blank rel="noopener noreferrer" class=footer__link-item>Forum<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a class=footer__link-item href=/doc/pr-2675/ca/community/help>Ask for help</a><li class=footer__item><a href=https://status.yunohost.org/ target=_blank rel="noopener noreferrer" class=footer__link-item>Service status<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://github.com/YunoHost/yunohost/blob/dev/debian/changelog target=_blank rel="noopener noreferrer" class=footer__link-item>Changelog<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Contribute</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://donate.yunohost.org/ target=_blank rel="noopener noreferrer" class=footer__link-item>Donate<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://github.com/YunoHost/issues/issues target=_blank rel="noopener noreferrer" class=footer__link-item>Issues<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://github.com/YunoHost target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub (core)<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://github.com/YunoHost-Apps target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub (apps)<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://translate.yunohost.org/ target=_blank rel="noopener noreferrer" class=footer__link-item>Translate<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=margin-bottom--sm><img src=/doc/pr-2675/ca/img/icons/ynh_logo_roundcorner.png alt="Yunohost Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/doc/pr-2675/ca/img/icons/ynh_logo_roundcorner.png alt="Yunohost Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"/></div><div class=footer__copyright>Build with Docusaurus for YunoHost</div></div></div></footer></div></body>