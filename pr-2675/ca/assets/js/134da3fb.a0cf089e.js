"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([["3552"],{4126:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>a,toc:()=>h,default:()=>c,metadata:()=>t,assets:()=>l,contentTitle:()=>s});var t=JSON.parse('{"id":"admin/upgrade/12.0-bookworm/index","title":"Migrating from 11.x to 12.x","description":"This page is dedicated to help you migrating an instance from YunoHost 11.x (running on Debian Bullseye) to YunoHost 12 (running on Debian Bookworm).","source":"@site/docs/admin/55.upgrade/12.0-bookworm/index.mdx","sourceDirName":"admin/55.upgrade/12.0-bookworm","slug":"/admin/upgrade/12.0-bookworm/","permalink":"/doc/pr-2675/ca/admin/upgrade/12.0-bookworm/","draft":false,"unlisted":false,"editUrl":"https://github.com/YunoHost/doc/tree/main/docs/admin/55.upgrade/12.0-bookworm/index.mdx","tags":[],"version":"current","frontMatter":{"title":"Migrating from 11.x to 12.x"},"sidebar":"admin","previous":{"title":"Migrating from 4.x to 11.x","permalink":"/doc/pr-2675/ca/admin/upgrade/11.0-bullseye"},"next":{"title":"Migration isues FAQ","permalink":"/doc/pr-2675/ca/admin/upgrade/12.0-bookworm/issues_faq"}}'),o=i(4848),r=i(4429);let a={title:"Migrating from 11.x to 12.x"},s,l={},h=[{value:"Important notes",id:"important-notes",level:2},{value:"Migration procedure",id:"migration-procedure",level:2},{value:"From the webadmin",id:"from-the-webadmin",level:3},{value:"From the command line",id:"from-the-command-line",level:3},{value:"During the migration",id:"during-the-migration",level:2},{value:"If the migration fails at some point",id:"if-the-migration-fails-at-some-point",level:2},{value:"After the migration",id:"after-the-migration",level:2},{value:"Check that you actually are on Debian Bookworm and YunoHost 12.x",id:"check-that-you-actually-are-on-debian-bookworm-and-yunohost-12x",level:3},{value:"Run the new pending migrations",id:"run-the-new-pending-migrations",level:3},{value:"Agreeing to the new Terms of Service via command line",id:"agreeing-to-the-new-terms-of-service-via-command-line",level:4},{value:"Check the Diagnosis",id:"check-the-diagnosis",level:3},{value:"Check that your applications are working",id:"check-that-your-applications-are-working",level:3},{value:"Current known issues after the migration",id:"current-known-issues-after-the-migration",level:2}];function d(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"This page is dedicated to help you migrating an instance from YunoHost 11.x (running on Debian Bullseye) to YunoHost 12 (running on Debian Bookworm)."}),"\n",(0,o.jsx)(n.h2,{id:"important-notes",children:"Important notes"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"The YunoHost team did its best to make sure that the migration is as smooth as possible and was tested over the course of several months in several cases."}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Please ",(0,o.jsx)(n.a,{href:"/admin/backups",children:"backup your data and server"}),"! This migration is a complex operation and covering every pitfall is quite hard. And in any case, be patient and attentive during the migration."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Please don't rush into thinking that you should need to reinstall your system from scratch thinking it would be \"simpler\" (sigh). (A common attitude is to be willing to reinstall a server at the slightest complication...). Instead, if you happen to run into issues, we encourage you to try to investigate and understand what's going on and ",(0,o.jsx)(n.a,{href:"/community/help",children:"reach for help on the chat and the forum"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"You should watch the known issues at the bottom of this page, to be sure your migrations will work properly."})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"migration-procedure",children:"Migration procedure"}),"\n",(0,o.jsx)(n.p,{children:"You first need to ensure your system is up to date. The migration is available starting with the version 11.3."}),"\n",(0,o.jsx)(n.p,{children:"It is recommended to run the migration from the command line, but it can still be done from the webadmin."}),"\n",(0,o.jsx)(n.h3,{id:"from-the-webadmin",children:"From the webadmin"}),"\n",(0,o.jsx)(n.p,{children:"Go to Tools > Migrations to access the migrations interface. You will have to read carefully and accept the disclaimer then launch the migration."}),"\n",(0,o.jsx)(n.p,{children:"Note that even if you close the webadmin page for some reason, the migration will continue in the background (but the webadmin will be partially unavailable)."}),"\n",(0,o.jsx)(n.h3,{id:"from-the-command-line",children:"From the command line"}),"\n",(0,o.jsx)(n.p,{children:"Run :"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo yunohost tools migrations run\n"})}),"\n",(0,o.jsx)(n.p,{children:"then read carefully and accept the disclaimer."}),"\n",(0,o.jsx)(n.h2,{id:"during-the-migration",children:"During the migration"}),"\n",(0,o.jsx)(n.p,{children:"Depending on your hardware and installed apps and packages, the migration can take up to one or two hours."}),"\n",(0,o.jsx)(n.p,{children:"Logs will be displayed in the webadmin's modal window in the middle of the page. They will also be browsable after the migration like any other major operation under Tools > Logs."}),"\n",(0,o.jsx)(n.h2,{id:"if-the-migration-fails-at-some-point",children:"If the migration fails at some point"}),"\n",(0,o.jsxs)(n.p,{children:["If the migration fails, the first thing to try should be relaunch it. If it still doesn't work, your should ",(0,o.jsx)(n.a,{href:"/community/help",children:"ask for help to the community"})," (please provide error message, full logs and any context element that would help debugging the issue)."]}),"\n",(0,o.jsx)(n.h2,{id:"after-the-migration",children:"After the migration"}),"\n",(0,o.jsx)(n.h3,{id:"check-that-you-actually-are-on-debian-bookworm-and-yunohost-12x",children:"Check that you actually are on Debian Bookworm and YunoHost 12.x"}),"\n",(0,o.jsx)(n.p,{children:"Go to Diagnosis (category Base system) or look at the bottom-right of the webadmin to check YunoHost's version."}),"\n",(0,o.jsxs)(n.p,{children:["From the command line, you can use ",(0,o.jsx)(n.code,{children:"lsb_release -a"})," and ",(0,o.jsx)(n.code,{children:"yunohost --version"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"run-the-new-pending-migrations",children:"Run the new pending migrations"}),"\n",(0,o.jsx)(n.p,{children:"Some more migrations appeared after the upgrade:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Rebuilding the virtualenvs of your Python apps"}),"\n",(0,o.jsx)(n.li,{children:"Migrate from PostgreSQL 13 to 15"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"You should run those as soon as possible to ensure your apps work properly."}),"\n",(0,o.jsx)(n.h4,{id:"agreeing-to-the-new-terms-of-service-via-command-line",children:"Agreeing to the new Terms of Service via command line"}),"\n",(0,o.jsxs)(n.p,{children:["YunoHost 12.x now requires that you agree to the new ",(0,o.jsx)(n.a,{href:"https://doc.yunohost.org/terms_of_services/",children:"Terms of Service"}),". After reading and accepting them you can run:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"yunohost tools migrations run 0031_terms_of_services --accept-disclaimer\n"})}),"\n",(0,o.jsx)(n.h3,{id:"check-the-diagnosis",children:"Check the Diagnosis"}),"\n",(0,o.jsx)(n.p,{children:"In the webadmin Diagnosis section, make sure that no specific issue appeared after running the migration (for example a service that crashed for some reason)."}),"\n",(0,o.jsx)(n.h3,{id:"check-that-your-applications-are-working",children:"Check that your applications are working"}),"\n",(0,o.jsx)(n.p,{children:"Test that your applications are working. If they aren't, you should try to upgrade them (it is also a good idea to upgrade them even if they are working anyway)."}),"\n",(0,o.jsxs)(n.p,{children:["If your app is broken and you were already with the latest version, you can rerun the upgrade thanks to the ",(0,o.jsx)(n.code,{children:"-F|--force"})," option:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"yunohost app upgrade --force APP_NAME\n"})}),"\n",(0,o.jsx)(n.h2,{id:"current-known-issues-after-the-migration",children:"Current known issues after the migration"}),"\n",(0,o.jsxs)(n.p,{children:["Please check the ",(0,o.jsx)(n.a,{href:"/admin/upgrade/12.0-bookworm/issues_faq/",children:"issues FAQ"}),"."]})]})}function c(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},4429:function(e,n,i){i.d(n,{R:()=>a,x:()=>s});var t=i(6540);let o={},r=t.createContext(o);function a(e){let n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);