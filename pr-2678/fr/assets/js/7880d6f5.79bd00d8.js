"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([["1296"],{5621:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>s,toc:()=>l,default:()=>u,metadata:()=>r,assets:()=>c,contentTitle:()=>a});var r=JSON.parse('{"id":"admin/tutorials/torhiddenservice","title":"Utiliser YunoHost comme un service cach\xe9 Tor","description":"Ce tuto n\'est pas complet ! Des donn\xe9es peuvent \xeatre r\xe9cup\xe9r\xe9es avec cette installation comme le nom de domaine principal de votre YunoHost, donc ce n\'est pas un \\"service cach\xe9\\". Voir The official Tor hidden service documentation (anglais)","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/admin/45.tutorials/40.torhiddenservice.mdx","sourceDirName":"admin/45.tutorials","slug":"/admin/tutorials/torhiddenservice","permalink":"/doc/pr-2678/fr/admin/tutorials/torhiddenservice","draft":false,"unlisted":false,"editUrl":"https://github.com/YunoHost/doc/tree/main/i18n/fr/docusaurus-plugin-content-docs/current/admin/45.tutorials/40.torhiddenservice.mdx","tags":[],"version":"current","sidebarPosition":40,"frontMatter":{"sidebar_label":"Configure Tor Hidden Service","title":"Utiliser YunoHost comme un service cach\xe9 Tor"},"sidebar":"admin","previous":{"title":"Configurer un relais SMTP","permalink":"/doc/pr-2678/fr/admin/tutorials/email_configure_relay"},"next":{"title":"Certificats personnalis\xe9s","permalink":"/doc/pr-2678/fr/admin/tutorials/certificate_custom"}}'),o=i(4848),t=i(4429);let s={sidebar_label:"Configure Tor Hidden Service",title:"Utiliser YunoHost comme un service cach\xe9 Tor"},a,c={},l=[{value:"Installer Tor",id:"installer-tor",level:3},{value:"Configurer notre service cach\xe9",id:"configurer-notre-service-cach\xe9",level:3},{value:"Red\xe9marrer Tor",id:"red\xe9marrer-tor",level:3},{value:"Obtenir l\u2019adresse du service cach\xe9",id:"obtenir-ladresse-du-service-cach\xe9",level:3},{value:"Ajouter le domaine .onion \xe0 YunoHost",id:"ajouter-le-domaine-onion-\xe0-yunohost",level:3},{value:"\xc9viter la redirection vers le SSO (optionnel)",id:"\xe9viter-la-redirection-vers-le-sso-optionnel",level:3},{value:"V\xe9rifier que l&#39;on a pas fait d&#39;erreurs dans la configuration de NGINX",id:"v\xe9rifier-que-lon-a-pas-fait-derreurs-dans-la-configuration-de-nginx",level:3},{value:"Si tout est OK on applique les modifications de la configuration",id:"si-tout-est-ok-on-applique-les-modifications-de-la-configuration",level:3}];function d(e){let n={a:"a",admonition:"admonition",code:"code",em:"em",h3:"h3",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsxs)(n.p,{children:["Ce tuto n'est pas complet ! Des donn\xe9es peuvent \xeatre r\xe9cup\xe9r\xe9es avec cette installation comme le nom de domaine principal de votre YunoHost, donc ce n'est pas un \"service cach\xe9\". Voir ",(0,o.jsx)(n.a,{href:"https://www.torproject.org/docs/tor-hidden-service.html.en",children:"The official Tor hidden service documentation"})," (anglais)"]})}),"\n",(0,o.jsx)(n.h3,{id:"installer-tor",children:"Installer Tor"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"apt install tor \n"})}),"\n",(0,o.jsx)(n.h3,{id:"configurer-notre-service-cach\xe9",children:"\xa0Configurer notre service cach\xe9"}),"\n",(0,o.jsxs)(n.p,{children:["\xc9diter le fichier ",(0,o.jsx)(n.code,{children:"/etc/tor/torrc"}),", et ajouter ces lignes\xa0:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",children:"HiddenServiceDir  /var/lib/tor/hidden_service/\nHiddenServicePort 80 127.0.0.1:80\nHiddenServicePort 443 127.0.0.1:443\n"})}),"\n",(0,o.jsx)(n.h3,{id:"red\xe9marrer-tor",children:"Red\xe9marrer Tor"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"systemctl restart tor\n"})}),"\n",(0,o.jsx)(n.h3,{id:"obtenir-ladresse-du-service-cach\xe9",children:"Obtenir l\u2019adresse du service cach\xe9"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cat /var/lib/tor/hidden_service/hostname\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Le nom de domaine ressemble \xe0 ",(0,o.jsx)(n.em,{children:"random123456789.onion"})]}),"\n",(0,o.jsx)(n.h3,{id:"ajouter-le-domaine-onion-\xe0-yunohost",children:"Ajouter le domaine .onion \xe0 YunoHost"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"yunohost domain add random123456789.onion\n"})}),"\n",(0,o.jsx)(n.h3,{id:"\xe9viter-la-redirection-vers-le-sso-optionnel",children:"\xc9viter la redirection vers le SSO (optionnel)"}),"\n",(0,o.jsxs)(n.p,{children:["Si vous voulez \xe9viter d\u2019\xeatre redirig\xe9 vers le portail \xe0 la connexion pour des raisons de tra\xe7abilit\xe9, vous pouvez d\xe9sactiver SSOwat pour le domaine, en \xe9ditant le fichier ",(0,o.jsx)(n.code,{children:"/etc/nginx/conf.d/random123456789.onion.conf"})," et en commentant la ligne suivante (elle appara\xeet deux fois dans le fichier)\xa0:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",children:"#access_by_lua_file /usr/share/ssowat/access.lua;\n"})}),"\n",(0,o.jsx)(n.h3,{id:"v\xe9rifier-que-lon-a-pas-fait-derreurs-dans-la-configuration-de-nginx",children:"V\xe9rifier que l'on a pas fait d'erreurs dans la configuration de NGINX"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"nginx -t\n"})}),"\n",(0,o.jsx)(n.h3,{id:"si-tout-est-ok-on-applique-les-modifications-de-la-configuration",children:"Si tout est OK on applique les modifications de la configuration"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"systemctl reload nginx\n"})})]})}function u(e={}){let{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},4429:function(e,n,i){i.d(n,{R:()=>s,x:()=>a});var r=i(6540);let o={},t=r.createContext(o);function s(e){let n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);