"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([["6638"],{9785:function(e,o,r){r.r(o),r.d(o,{frontMatter:()=>t,toc:()=>c,default:()=>l,metadata:()=>n,assets:()=>d,contentTitle:()=>a});var n=JSON.parse('{"id":"admin/troubleshooting/noaccess","title":"Get access back into YunoHost","description":"There are several reasons that could lead to one administrator\'s access being partially or completely blocked off their YunoHost server. In numerous cases, one of the access methods is blocked, but others are not.","source":"@site/docs/admin/50.troubleshooting/15.noaccess.mdx","sourceDirName":"admin/50.troubleshooting","slug":"/admin/troubleshooting/noaccess","permalink":"/doc/pr-2678/ca/admin/troubleshooting/noaccess","draft":false,"unlisted":false,"editUrl":"https://github.com/YunoHost/doc/tree/main/docs/admin/50.troubleshooting/15.noaccess.mdx","tags":[],"version":"current","sidebarPosition":15,"frontMatter":{"title":"Get access back into YunoHost"},"sidebar":"admin","previous":{"title":"Changing the administration password","permalink":"/doc/pr-2678/ca/admin/troubleshooting/change_admin_password"},"next":{"title":"Setting up IPv6","permalink":"/doc/pr-2678/ca/admin/troubleshooting/ipv6"}}'),s=r(4848),i=r(4429);let t={title:"Get access back into YunoHost"},a,d={},c=[{value:"You have access to the server with its local IP address, but not its domain name",id:"you-have-access-to-the-server-with-its-local-ip-address-but-not-its-domain-name",level:2},{value:"If you are self-hosted at home: fix ports forwarding",id:"if-you-are-self-hosted-at-home-fix-ports-forwarding",level:3},{value:"Configure DNS records",id:"configure-dns-records",level:3},{value:"Other probable causes",id:"other-probable-causes",level:3},{value:"You are getting a certificate error that prevents you from reaching the webadmin",id:"you-are-getting-a-certificate-error-that-prevents-you-from-reaching-the-webadmin",level:2},{value:"You have access via SSH but not via the webadmin, or inversely",id:"you-have-access-via-ssh-but-not-via-the-webadmin-or-inversely",level:2},{value:"You are trying to log in with SSH as <code>root</code> instead of <code>admin</code> user",id:"you-are-trying-to-log-in-with-ssh-as-root-instead-of-admin-user",level:3},{value:"You have been temporarily banned",id:"you-have-been-temporarily-banned",level:3},{value:"NGINX web server is broken",id:"nginx-web-server-is-broken",level:3},{value:"Your server is reachable by IPv6, but not IPv4, or inversely",id:"your-server-is-reachable-by-ipv6-but-not-ipv4-or-inversely",level:3},{value:"Webadmin is working, but some web apps are returning 502 errors",id:"webadmin-is-working-but-some-web-apps-are-returning-502-errors",level:2},{value:"You have lost your admin password, or the password is seemingly wrong",id:"you-have-lost-your-admin-password-or-the-password-is-seemingly-wrong",level:2},{value:"Your VPN expired or does not connect any more",id:"your-vpn-expired-or-does-not-connect-any-more",level:2},{value:"Your server does not boot",id:"your-server-does-not-boot",level:2},{value:"VNC or screen access does not work",id:"vnc-or-screen-access-does-not-work",level:2}];function h(e){let o={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.p,{children:"There are several reasons that could lead to one administrator's access being partially or completely blocked off their YunoHost server. In numerous cases, one of the access methods is blocked, but others are not."}),"\n",(0,s.jsx)(o.p,{children:"This page will help you diagnose the issue, get back access, and if needed repair your system. Most common causes are listed first, so follow the tutorial from top to bottom."}),"\n",(0,s.jsx)(o.h2,{id:"you-have-access-to-the-server-with-its-local-ip-address-but-not-its-domain-name",children:"You have access to the server with its local IP address, but not its domain name"}),"\n",(0,s.jsx)(o.h3,{id:"if-you-are-self-hosted-at-home-fix-ports-forwarding",children:"If you are self-hosted at home: fix ports forwarding"}),"\n",(0,s.jsxs)(o.p,{children:["Check that you are getting access to the server by using its public IP (you can find at ",(0,s.jsx)(o.a,{href:"https://ip.yunohost.org",children:"https://ip.yunohost.org"}),". If this does not work:"]}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Make sure you have ",(0,s.jsx)(o.a,{href:"/admin/get_started/post_install/port_forwarding",children:"set up forwarding"})]}),"\n",(0,s.jsxs)(o.li,{children:["Some ISP routers do not support ",(0,s.jsx)(o.em,{children:"hairpinning"}),", which prevents you from reaching your server by its domain name from within your local network. If so, you can use a cellular connection, or tweak your ",(0,s.jsx)(o.code,{children:"hosts"})," file on your computer to make it bind your domain name to the local IP address instead of the public one."]}),"\n"]}),"\n",(0,s.jsx)(o.h3,{id:"configure-dns-records",children:"Configure DNS records"}),"\n",(0,s.jsx)(o.admonition,{type:"tip",children:(0,s.jsxs)(o.p,{children:["This is not a problem if you are using a domain from ",(0,s.jsx)(o.code,{children:"nohost.me"}),", ",(0,s.jsx)(o.code,{children:"noho.st"})," or ",(0,s.jsx)(o.code,{children:"ynh.fr"}),")"]})}),"\n",(0,s.jsxs)(o.p,{children:["You have to configure your ",(0,s.jsx)(o.a,{href:"/admin/get_started/post_install/dns_config",children:"DNS records"})," (at least ",(0,s.jsx)(o.code,{children:"A"})," records, and ",(0,s.jsx)(o.code,{children:"AAAA"})," if you have an IPv6 connection)."]}),"\n",(0,s.jsxs)(o.p,{children:["You can check that the DNS records are correct by comparing the results given by ",(0,s.jsx)(o.a,{href:"https://www.whatsmydns.net/",children:"this service"})," with the ",(0,s.jsx)(o.a,{href:"https://ip.yunohost.org",children:"IP given by our service"}),"."]}),"\n",(0,s.jsx)(o.h3,{id:"other-probable-causes",children:"Other probable causes"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["You domain ",(0,s.jsx)(o.code,{children:"noho.st"}),", ",(0,s.jsx)(o.code,{children:"nohost.me"}),", or ",(0,s.jsx)(o.code,{children:"ynh.fr"})," is unreachable following a failure on YunoHost's infrastructure. Check the ",(0,s.jsx)(o.a,{href:"https://forum.yunohost.org/",children:"forum"})," for announcements or people posting about the same issue."]}),"\n",(0,s.jsxs)(o.li,{children:["Your domain name may be expired. Check that on your registrar's client panel, or by using the command ",(0,s.jsx)(o.code,{children:"whois yourdomain.tld"}),"."]}),"\n",(0,s.jsxs)(o.li,{children:["You have a dynamic IP address. In that case, you need to set up a script or a client that takes care of regularly update it. Refer to the page on ",(0,s.jsx)(o.a,{href:"/admin/tutorials/domains/dns_dynamicip",children:"DNS with a dynamic IP"})," to see how. You can also use a domain ",(0,s.jsx)(o.code,{children:"nohost.me"}),", ",(0,s.jsx)(o.code,{children:"noho.st"})," or ",(0,s.jsx)(o.code,{children:"ynh.fr"})," that includes this features."]}),"\n"]}),"\n",(0,s.jsx)(o.h2,{id:"you-are-getting-a-certificate-error-that-prevents-you-from-reaching-the-webadmin",children:"You are getting a certificate error that prevents you from reaching the webadmin"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"A certificate error may be displayed if you have made a typo in the address bar of your browser."}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsxs)(o.p,{children:["If you have just installed your server, or just installed a new domain, it uses a self-signed certificate. In that case, it is possible and understandable to add a ",(0,s.jsx)(o.em,{children:"temporary"})," security exception so that you can ",(0,s.jsx)(o.a,{href:"/admin/domains/certificate",children:"install a Let's Encrypt certificate"}),", provided you have a secure Internet connection."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(o.h2,{id:"you-have-access-via-ssh-but-not-via-the-webadmin-or-inversely",children:"You have access via SSH but not via the webadmin, or inversely"}),"\n",(0,s.jsxs)(o.h3,{id:"you-are-trying-to-log-in-with-ssh-as-root-instead-of-admin-user",children:["You are trying to log in with SSH as ",(0,s.jsx)(o.code,{children:"root"})," instead of ",(0,s.jsx)(o.code,{children:"admin"})," user"]}),"\n",(0,s.jsxs)(o.p,{children:["By default, SSH connection has to be made as ",(0,s.jsx)(o.code,{children:"admin"}),". It possible to log into the server as ",(0,s.jsx)(o.code,{children:"root"})," ",(0,s.jsx)(o.em,{children:"only from the local network of the server"}),". If your server is a VPS, the web console or VNC provided by VPS providers may work."]}),"\n",(0,s.jsxs)(o.p,{children:["If you are running ",(0,s.jsx)(o.code,{children:"yunohost"})," commands in the CLI as ",(0,s.jsx)(o.code,{children:"admin"}),", you have to call them with ",(0,s.jsx)(o.code,{children:"sudo"})," before (for example ",(0,s.jsx)(o.code,{children:"sudo yunohost user list"}),"). You can also become ",(0,s.jsx)(o.code,{children:"root"})," by running ",(0,s.jsx)(o.code,{children:"sudo su"}),"."]}),"\n",(0,s.jsx)(o.h3,{id:"you-have-been-temporarily-banned",children:"You have been temporarily banned"}),"\n",(0,s.jsx)(o.p,{children:"Your YunoHost server includes a service, Fail2ban, which automatically bans IPs that fail several times in a row to log in. In some cases it can be software (e.g. Nextcloud client) that are confifured with an old password, or a user who has the same IP as you have."}),"\n",(0,s.jsx)(o.p,{children:"If you have been banned while trying to access a web page, and only web pages are unreachable, you may have access to your server via SSH. Similarly, if you have been banned from SSH, webadmin access may work."}),"\n",(0,s.jsx)(o.p,{children:"If you have been banned from both SSH and webadmin, you can try to reach your server through another IP address. For example through the cellular network of your phone, a VPN, Tor, or another proxy."}),"\n",(0,s.jsxs)(o.p,{children:["See also : ",(0,s.jsx)(o.a,{href:"/admin/troubleshooting/fail2ban",children:"unban an IP on Fail2Ban"})]}),"\n",(0,s.jsx)(o.admonition,{type:"note",children:(0,s.jsx)(o.p,{children:"Ban are usually 10 to 12-minute-long, and on IPv4 only."})}),"\n",(0,s.jsx)(o.h3,{id:"nginx-web-server-is-broken",children:"NGINX web server is broken"}),"\n",(0,s.jsxs)(o.p,{children:["Maybe the NGINX web server is out of order. You can check that ",(0,s.jsx)(o.a,{href:"/admin/command_line",children:"trough SSH"})," with the command ",(0,s.jsx)(o.code,{children:"yunohost service status nginx"}),". If it is failing, check that its configuration is correct by running ",(0,s.jsx)(o.code,{children:"nginx -t"}),". If it is indeed broken, it may be due to the installation or removal of a low-quality app... If you need support, ",(0,s.jsx)(o.a,{href:"/community/help",children:"ask for it"}),"."]}),"\n",(0,s.jsx)(o.p,{children:"The NGINX or SSH servers may have been killed due to a lack of storage space, RAM, or swap."}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Try restarting the service with ",(0,s.jsx)(o.code,{children:"systemctl restart nginx"}),"."]}),"\n",(0,s.jsxs)(o.li,{children:["You can check used storage with ",(0,s.jsx)(o.code,{children:"df -h"}),". If one of your partitions is full, you need to identify what fills it and make room. You can use ",(0,s.jsx)(o.code,{children:"ncdu"})," command (install it with ",(0,s.jsx)(o.code,{children:"apt install ncdu"}),") to browse from the root directory: ",(0,s.jsx)(o.code,{children:"ncdu /"})]}),"\n",(0,s.jsxs)(o.li,{children:["You can check RAM and swap usage with ",(0,s.jsx)(o.code,{children:"free -h"}),". Depending on the result, it may be necessary to optimize your server to use less RAM (removal of heavy or unused apps...), add more RAM or add a swap file."]}),"\n"]}),"\n",(0,s.jsx)(o.h3,{id:"your-server-is-reachable-by-ipv6-but-not-ipv4-or-inversely",children:"Your server is reachable by IPv6, but not IPv4, or inversely"}),"\n",(0,s.jsxs)(o.p,{children:["You can check that by ",(0,s.jsx)(o.code,{children:"ping"}),"ing it:"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-bash",children:"ping -4 yourdomain.tld # or its IPv4\nping -6 yourdomain.tld # or its IPv6\n"})}),"\n",(0,s.jsx)(o.p,{children:"If one of the two is working, use it to connect by SSH or the webadmin."}),"\n",(0,s.jsx)(o.p,{children:"If none are working, you need to resolv your connection issue. In some cases, an update of your router may have enabled IPv6 and DNS configuration may be disrupted."}),"\n",(0,s.jsx)(o.h2,{id:"webadmin-is-working-but-some-web-apps-are-returning-502-errors",children:"Webadmin is working, but some web apps are returning 502 errors"}),"\n",(0,s.jsxs)(o.p,{children:["It is highly probable that the underlying service for these apps is failing (e.g. PHP apps requiring ",(0,s.jsx)(o.code,{children:"php7.0-fpm"})," or ",(0,s.jsx)(o.code,{children:"php7.3-fpm"}),"). You can then try to restart the services, and/or ask for ",(0,s.jsx)(o.a,{href:"/community/help",children:"help"})]}),"\n",(0,s.jsx)(o.h2,{id:"you-have-lost-your-admin-password-or-the-password-is-seemingly-wrong",children:"You have lost your admin password, or the password is seemingly wrong"}),"\n",(0,s.jsxs)(o.p,{children:["If you can reach the webadmin login page (force reload with ",(0,s.jsx)(o.code,{children:"CTRL + F5"})," to be sure), and you cannot log in, your password is probably wrong."]}),"\n",(0,s.jsxs)(o.p,{children:["If yoy are sure of your passord, it may be due to the ",(0,s.jsx)(o.code,{children:"slapd"})," service failing. If that's the case, log into the server by SSH as ",(0,s.jsx)(o.code,{children:"root"}),"."]}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["If your server is at home, you most likely have access to the local network. From this network, you can follow the ",(0,s.jsx)(o.a,{href:"/admin/command_line",children:"SSH instructions"}),"`."]}),"\n",(0,s.jsx)(o.li,{children:"If your server is a VPS, your provider may offer a web console."}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:["Once logged in, you have to check the state of the service with ",(0,s.jsx)(o.code,{children:"yunohost service status slapd"})," and/or reset your admin password with ",(0,s.jsx)(o.code,{children:"yunohost tools adminpw"}),"."]}),"\n",(0,s.jsxs)(o.p,{children:["If this is still failing, on a VPS you may be able to reboot in rescue mode. Do not hesitate to ask for ",(0,s.jsx)(o.a,{href:"/community/help",children:"help"})]}),"\n",(0,s.jsx)(o.admonition,{type:"warning",children:(0,s.jsx)(o.p,{children:"To be completed"})}),"\n",(0,s.jsx)(o.h2,{id:"your-vpn-expired-or-does-not-connect-any-more",children:"Your VPN expired or does not connect any more"}),"\n",(0,s.jsx)(o.p,{children:"If you have a VPN with fixed IP, maybe it has expired, or the provider's infrastructure is failing."}),"\n",(0,s.jsx)(o.p,{children:"In that case, contact your VPN provider to renew it and update the parameters of the VPN Client app."}),"\n",(0,s.jsx)(o.p,{children:"Meanwhile, try reaching your server if it is at home, by:"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["its local IP, retrievable from your router configuration panel or ",(0,s.jsx)(o.code,{children:"sudo arp-scan --local"})]}),"\n",(0,s.jsxs)(o.li,{children:["reaching it at ",(0,s.jsx)(o.code,{children:"yunohost.local"}),", or ",(0,s.jsx)(o.code,{children:"yunohost-2.local"}),", etc. depending on how many YunoHost servers are on your network."]}),"\n"]}),"\n",(0,s.jsx)(o.admonition,{type:"warning",children:(0,s.jsx)(o.p,{children:"To be completed"})}),"\n",(0,s.jsx)(o.h2,{id:"your-server-does-not-boot",children:"Your server does not boot"}),"\n",(0,s.jsx)(o.p,{children:"In some cases your server may be stuck at boot. It may come from a new, buggy, kernel. Try changing to another kernel on the boot screen (via VNC for VPS)."}),"\n",(0,s.jsxs)(o.p,{children:['If you are in "rescue" mode with ',(0,s.jsx)(o.code,{children:"grub"}),", it may be due a misconfiguration of ",(0,s.jsx)(o.code,{children:"grub"}),", or a corrupted drive."]}),"\n",(0,s.jsxs)(o.p,{children:['In that case, access the storage drive from another system (your provider\'s "rescue" mode, live USB drive, read the SD or drive on another computer) and try to check partitions integrity with ',(0,s.jsx)(o.code,{children:"smartctl"}),", ",(0,s.jsx)(o.code,{children:"fsck"}),", and ",(0,s.jsx)(o.code,{children:"mount"}),"."]}),"\n",(0,s.jsxs)(o.p,{children:["If disks are corrupted or hard to mount, you have to save your data and maybe reformat, reinstall, and/or change the drive. If you succeed in mounting the drive, you can use ",(0,s.jsx)(o.code,{children:"systemd-nspawn"})," to access its database."]}),"\n",(0,s.jsxs)(o.p,{children:["Otherwise, run ",(0,s.jsx)(o.code,{children:"grub-update"}),", ",(0,s.jsx)(o.code,{children:"grub-install"})," again with ",(0,s.jsx)(o.code,{children:"chroot"})," or with ",(0,s.jsx)(o.code,{children:"systemd-nspawn"}),"."]}),"\n",(0,s.jsx)(o.h2,{id:"vnc-or-screen-access-does-not-work",children:"VNC or screen access does not work"}),"\n",(0,s.jsx)(o.p,{children:"It may be due hardware issue on your server, or with the hypervisor if it is on a VPS."}),"\n",(0,s.jsx)(o.p,{children:"If you are renting your server, contact the support of your provider. Otherwise, try fixing your machine by replacing failing components."})]})}function l(e={}){let{wrapper:o}={...(0,i.R)(),...e.components};return o?(0,s.jsx)(o,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},4429:function(e,o,r){r.d(o,{R:()=>t,x:()=>a});var n=r(6540);let s={},i=n.createContext(s);function t(e){let o=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function a(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),n.createElement(i.Provider,{value:o},e.children)}}}]);