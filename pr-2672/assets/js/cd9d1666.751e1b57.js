"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([["1193"],{7174:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>r,toc:()=>c,default:()=>h,metadata:()=>t,assets:()=>d,contentTitle:()=>l});var t=JSON.parse('{"id":"dev/core/devenv","title":"Development environment","description":"The recommended development tool is ynh-dev, and is based on Incus.","source":"@site/docs/dev/15.core/10.devenv.mdx","sourceDirName":"dev/15.core","slug":"/dev/core/devenv","permalink":"/doc/pr-2672/dev/core/devenv","draft":false,"unlisted":false,"editUrl":"https://github.com/YunoHost/doc/tree/main/docs/dev/15.core/10.devenv.mdx","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"title":"Development environment"},"sidebar":"devpackaging","previous":{"title":"YunoHost architecture","permalink":"/doc/pr-2672/dev/core/architecture"},"next":{"title":"The server and command line","permalink":"/doc/pr-2672/dev/core/ynh_core/"}}'),i=s(4848),o=s(4429);let r={title:"Development environment"},l,d={},c=[{value:"Incus",id:"incus",level:2},{value:"Install and configure Incus",id:"install-and-configure-incus",level:3},{value:"Install a custom YunoHost version",id:"install-a-custom-yunohost-version",level:2},{value:"<code>ynh-dev</code>",id:"ynh-dev",level:2}];function a(e){let n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The recommended development tool is ",(0,i.jsx)(n.code,{children:"ynh-dev"}),", and is based on Incus."]}),"\n",(0,i.jsx)(n.p,{children:"This page gives an introduction to both tools."}),"\n",(0,i.jsx)(n.h2,{id:"incus",children:"Incus"}),"\n",(0,i.jsxs)(n.p,{children:["The recommended testing and development environment is based on ",(0,i.jsx)(n.a,{href:"https://linuxcontainers.org/incus/",children:"Incus"}),",\na system container manager."]}),"\n",(0,i.jsxs)(n.p,{children:["Its usage is very similar to Docker and Podman, but its main difference is its ability to run full\noperating systems, with their own network interfaces and ",(0,i.jsx)(n.code,{children:"init"})," system. There is no virtualization here."]}),"\n",(0,i.jsxs)(n.p,{children:["The YunoHost project provides Incus images on ",(0,i.jsx)(n.a,{href:"https://repo.yunohost.org/incus/",children:"the Incus repository"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["For each Debian release and for each branch (",(0,i.jsx)(n.code,{children:"stable"}),", ",(0,i.jsx)(n.code,{children:"testing"}),", ",(0,i.jsx)(n.code,{children:"unstable"}),") are provided multiple images:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"before-install"}),": tools and dependencies are installed but ",(0,i.jsx)(n.em,{children:"not"})," Yunohost"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dev"}),": YunoHost is installed but the post-install step was not run"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"appci"}),": YunoHost is installed, post-install was run and you can install apps"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"core-tests"}),": YunoHost is installed and post-installed, and development and testing tools are installed."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"appci"})," and ",(0,i.jsx)(n.code,{children:"core-tests"})," images are used by the project's testing infrastructure."]}),"\n",(0,i.jsxs)(n.p,{children:["The Incus images are built by our ",(0,i.jsx)(n.a,{href:"https://github.com/YunoHost/incus_builder/",children:"incus_builder"})," tool, but ",(0,i.jsx)(n.strong,{children:"not automatically"}),", so please feel free to ask us to regenerate images."]}),"\n",(0,i.jsx)(n.h3,{id:"install-and-configure-incus",children:"Install and configure Incus"}),"\n",(0,i.jsx)(n.p,{children:"Incus can be installed on Debian with:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"apt install incus\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Then you need to add users to the ",(0,i.jsx)(n.code,{children:"incus-admin"})," group:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo usermod -a -G incus-admin $(whoami)\nnewgrp incus-admin\n"})}),"\n",(0,i.jsx)(n.p,{children:"and initialize Incus:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"incus admin init\n"})}),"\n",(0,i.jsx)(n.p,{children:"You will want to add the YunoHost repository (do NOT run this as root but as your user):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"incus remote add yunohost https://repo.yunohost.org/incus --protocol simplestreams --public\n"})}),"\n",(0,i.jsx)(n.p,{children:"and to download an image:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"incus image copy yunohost:yunohost/bookworm-stable/dev local: --copy-aliases --auto-update\n"})}),"\n",(0,i.jsx)(n.h2,{id:"install-a-custom-yunohost-version",children:"Install a custom YunoHost version"}),"\n",(0,i.jsxs)(n.p,{children:["When testing an unreleased YunoHost version, or installation script, you might want to\nrun the installation script from ",(0,i.jsx)(n.a,{href:"https://github.com/YunoHost/install_script",children:"its Git repository"})," on a freshly installed Debian."]}),"\n",(0,i.jsx)(n.p,{children:"For example to install the unreleased Debian 13 Trixie version:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"curl https://raw.githubusercontent.com/YunoHost/install_script/main/trixie | bash\n"})}),"\n",(0,i.jsx)(n.p,{children:"You might also want to pass arguments to the script:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"curl https://raw.githubusercontent.com/YunoHost/install_script/main/trixie | bash -s -- -d unstable\n"})}),"\n",(0,i.jsx)(n.h2,{id:"ynh-dev",children:(0,i.jsx)(n.code,{children:"ynh-dev"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://github.com/YunoHost/ynh-dev",children:(0,i.jsx)(n.code,{children:"ynh-dev"})})," is the ",(0,i.jsx)(n.em,{children:"recommended tool"})," that automates:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"downloading Incus images"}),"\n",(0,i.jsx)(n.li,{children:"download YunoHost's projects source code"}),"\n",(0,i.jsx)(n.li,{children:"Install and symlink YunoHost stuff inside the container"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"That way, you will be able to edit files, test your changes in real time, commit\nand push/pull your changes directly from your development environment."}),"\n",(0,i.jsxs)(n.p,{children:["Please see ",(0,i.jsxs)(n.a,{href:"https://github.com/YunoHost/ynh-dev/?tab=readme-ov-file",children:["the ",(0,i.jsx)(n.code,{children:"ynh-dev"})," README"]})," for installation and usage instructions."]})]})}function h(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},4429:function(e,n,s){s.d(n,{R:()=>r,x:()=>l});var t=s(6540);let i={},o=t.createContext(i);function r(e){let n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);