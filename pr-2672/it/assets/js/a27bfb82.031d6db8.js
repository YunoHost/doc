"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([["1360"],{2538:function(e,n,o){o.r(n),o.d(n,{frontMatter:()=>i,toc:()=>l,default:()=>u,metadata:()=>t,assets:()=>c,contentTitle:()=>r});var t=JSON.parse('{"id":"admin/backups/include_exclude_files","title":"Includere o escludere files","description":"Includere file","source":"@site/i18n/it/docusaurus-plugin-content-docs/current/admin/40.backups/25.include_exclude_files.mdx","sourceDirName":"admin/40.backups","slug":"/admin/backups/include_exclude_files","permalink":"/doc/pr-2672/it/admin/backups/include_exclude_files","draft":false,"unlisted":false,"editUrl":"https://github.com/YunoHost/doc/tree/main/i18n/it/docusaurus-plugin-content-docs/current/admin/40.backups/25.include_exclude_files.mdx","tags":[],"version":"current","sidebarPosition":25,"frontMatter":{"title":"Includere o escludere files"},"sidebar":"admin","previous":{"title":"Evitare i problemi hardware","permalink":"/doc/pr-2672/it/admin/backups/avoid_hardware_failure"},"next":{"title":"Metodi di backup personalizzati","permalink":"/doc/pr-2672/it/admin/backups/custom_backup_methods"}}'),a=o(4848),s=o(4429);let i={title:"Includere o escludere files"},r,c={},l=[{value:"Includere file",id:"includere-file",level:2},{value:"Escludere file",id:"escludere-file",level:2},{value:"Escludere alcune cartelle presenti in <code>/home</code>",id:"escludere-alcune-cartelle-presenti-in-home",level:3},{value:"Escludere grandi quantit\xe0 di dati",id:"escludere-grandi-quantit\xe0-di-dati",level:3}];function d(e){let n={br:"br",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"includere-file",children:"Includere file"}),"\n",(0,a.jsx)(n.p,{children:"Nella maggior parte dei casi YunoHost conosce quali file devono fare parte del backup. Tuttavia se avete effettuato delle modifiche, ad esempio installando un programma senza avvalervi della procedura ufficiale di YunoHost, dovrete includere altri file da salvare nel vostro schema di backup."}),"\n",(0,a.jsx)(n.p,{children:"YunoHost tiene traccia delle modifiche effettuate utilizzando gli strumenti di default. Al contrario un programma o un database aggiunti manualmente e/o delle modifiche a file di configurazione, non saranno inseriti nel backup."}),"\n",(0,a.jsx)(n.p,{children:"Potete creare un hook di backup e un hook di ripristino per aggiungere i file da salvare. Esempio:"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.code,{children:"/etc/yunohost/hooks.d/backup/99-conf_custom"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n\n# Source YNH helpers\nsource /usr/share/yunohost/helpers\n\nynh_backup_dest (){\n    YNH_CWD="${YNH_BACKUP_DIR%/}/$1"\n    mkdir -p $YNH_CWD\n    cd "$YNH_CWD"\n}\n\n# Exit hook on subcommand error or unset variable\nynh_abort_if_errors\n\n# Openvpn\nynh_backup_dest "conf/custom/openvpn"\nynh_backup "/etc/sysctl.d/openvpn.conf"\nynh_backup "/etc/openvpn"\nynh_backup "/etc/fail2ban/jail.d/openvpn.conf"\nynh_backup "/etc/fail2ban/filter.d/openvpn.conf"\n\n# Samba\nynh_backup_dest "conf/custom/samba"\nynh_backup "/etc/samba"\nynh_backup "/var/lib/samba"\nynh_backup "/etc/yunohost/hooks.d/post_user_create/99-samba"\nynh_backup "/etc/yunohost/hooks.d/post_user_delete/99-samba"\nynh_backup --src_path="/etc/yunohost/hooks.d/post_user_update/99-samba" --not_mandatory\nynh_backup "/etc/cron.daily/clean-trash"\n\n# MISC\nynh_backup_dest "conf/custom/misc"\nynh_backup "/etc/sysctl.d/noipv6.conf"\nynh_backup "/usr/local/bin/"\nynh_backup "/etc/yunohost/hooks.d/backup/99-conf_custom"\nynh_backup "/etc/yunohost/hooks.d/restore/99-conf_custom"\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.code,{children:"/etc/yunohost/hooks.d/restore/99-conf_custom"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n\n# Source YNH helpers\nsource /usr/share/yunohost/helpers\n\nynh_restore_dest (){\n    YNH_CWD="${YNH_BACKUP_DIR%/}/$1"\n    cd "$YNH_CWD"\n}\n\n# Exit hook on subcommand error or unset variable\nynh_abort_if_errors\n\n# Openvpn\napp="custom_openvpn" # Cette variable est importante pour le helper suivant\nynh_install_app_dependencies "openvpn openvpn-auth-ldap samba"\n\nynh_restore_dest "conf/custom/openvpn"\nynh_restore_file "/etc/sysctl.d/openvpn.conf"\nynh_restore_file "/etc/openvpn"\nynh_restore_file "/etc/fail2ban/jail.d/openvpn.conf"\nynh_restore_file "/etc/fail2ban/filter.d/openvpn.conf"\n\n# Samba\napp="custom_samba" # Cette variable est importante pour le helper suivant\nynh_install_app_dependencies "samba"\n\nynh_restore_dest "conf/custom/samba"\nynh_restore_file "/etc/samba"\nynh_restore_file "/var/lib/samba"\nynh_restore_file "/etc/yunohost/hooks.d/post_user_create/99-samba"\nynh_restore_file "/etc/yunohost/hooks.d/post_user_delete/99-samba"\nynh_restore_file --src_path="/etc/yunohost/hooks.d/post_user_update/99-samba" --not_mandatory\nynh_restore_file "/etc/cron.daily/clean-trash"\nchown -R openvpn:openvpn /etc/openvpn\n\n# MISC\nynh_restore_dest "conf/custom/misc"\nynh_restore_file "/etc/sysctl.d/noipv6.conf"\nynh_restore_file "/usr/local/bin/"\nynh_restore_file "/etc/yunohost/hooks.d/backup/99-conf_custom"\nynh_restore_file "/etc/yunohost/hooks.d/restore/99-conf_custom"\n'})}),"\n",(0,a.jsx)(n.h2,{id:"escludere-file",children:"Escludere file"}),"\n",(0,a.jsx)(n.p,{children:"Esistono solo due metodi per escludere file dal backup di YunoHost:"}),"\n",(0,a.jsxs)(n.h3,{id:"escludere-alcune-cartelle-presenti-in-home",children:["Escludere alcune cartelle presenti in ",(0,a.jsx)(n.code,{children:"/home"})]}),"\n",(0,a.jsxs)(n.p,{children:["Se necessario potete specificare quali cartelle nella ",(0,a.jsx)(n.code,{children:"home"})," di un utente non siano da includere nel comando ",(0,a.jsx)(n.code,{children:"yunohost backup"}),", creando al loro interno un file vuoto con l'estensione ",(0,a.jsx)(n.code,{children:".nobackup"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Attenzione: questo metodo funziona solo con la ",(0,a.jsxs)(n.strong,{children:["prima sottodirectory di ",(0,a.jsx)(n.code,{children:"/home"})]})," ad esempio ",(0,a.jsx)(n.code,{children:"/home/user1"})," o ",(0,a.jsx)(n.code,{children:"/home/yunohost.multimedia"}),". Al contrario non funzioner\xe0 per altre sottodirectory come ",(0,a.jsx)(n.code,{children:"/home/user1/miacartella"}),"."]}),"\n",(0,a.jsx)(n.h3,{id:"escludere-grandi-quantit\xe0-di-dati",children:"Escludere grandi quantit\xe0 di dati"}),"\n",(0,a.jsxs)(n.p,{children:['Alcuni programmi come Nextcloud sono potenzialmente accompagnati da grandi quantit\xe0 di dati. In questi casi viene fatto il backup solo del programma stesso (il "core").',(0,a.jsx)(n.br,{}),"\n","Generalmente negli aggiornamenti dei programmi che contengono grandi quantit\xe0 di dati, questi vengono esclusi dal backup."]}),"\n",(0,a.jsxs)(n.p,{children:["Per disattivare temporaneamente, nei programmi che supportano tale procedura, il backup di file di grandi dimensioni potete definire la variabile ",(0,a.jsx)(n.code,{children:"BACKUP_CORE_ONLY"}),". La variabile deve essere definita prima di eseguire il comando di backup:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"BACKUP_CORE_ONLY=1 yunohost backup create --apps nextcloud\n"})}),"\n",(0,a.jsx)(n.p,{children:"Attenzione: dovrete procedere fare  backup dei dati degli utenti Nextcloud separatamente."}),"\n",(0,a.jsx)(n.p,{children:"Se volete rendere permanente l'impostazione:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"yunohost app setting nextcloud do_not_backup_data -v 1\n"})})]})}function u(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},4429:function(e,n,o){o.d(n,{R:()=>i,x:()=>r});var t=o(6540);let a={},s=t.createContext(a);function i(e){let n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);