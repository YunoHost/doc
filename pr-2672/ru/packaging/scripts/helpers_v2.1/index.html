<!doctype html><html lang=ru dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-packaging/scripts/helpers_v2.1" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.0"><title data-rh=true>App helpers (v2.1) | Yunohost</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:image content=https://yunohost.org/assets/img/portal_simple_dark.jpg /><meta data-rh=true name=twitter:image content=https://yunohost.org/assets/img/portal_simple_dark.jpg /><meta data-rh=true property=og:url content=https://doc.next.yunohost.org/doc/pr-2672/ru/packaging/scripts/helpers_v2.1 /><meta data-rh=true property=og:locale content=ru /><meta data-rh=true property=og:locale:alternate content=ar /><meta data-rh=true property=og:locale:alternate content=ca /><meta data-rh=true property=og:locale:alternate content=de /><meta data-rh=true property=og:locale:alternate content=en /><meta data-rh=true property=og:locale:alternate content=es /><meta data-rh=true property=og:locale:alternate content=fr /><meta data-rh=true property=og:locale:alternate content=it /><meta data-rh=true property=og:locale:alternate content=oc /><meta data-rh=true property=og:locale:alternate content=en_GB /><meta data-rh=true name=docusaurus_locale content=ru /><meta data-rh=true name=docsearch:language content=ru /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content="App helpers (v2.1) | Yunohost"/><meta data-rh=true name=description content="Doc auto-generated by this script on 18/09/2025 (YunoHost version 12.1.25)"/><meta data-rh=true property=og:description content="Doc auto-generated by this script on 18/09/2025 (YunoHost version 12.1.25)"/><link data-rh=true rel=icon href=/doc/pr-2672/ru/img/favicon.png /><link data-rh=true rel=canonical href=https://doc.next.yunohost.org/doc/pr-2672/ru/packaging/scripts/helpers_v2.1 /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2672/ar/packaging/scripts/helpers_v2.1 hreflang=ar /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2672/ca/packaging/scripts/helpers_v2.1 hreflang=ca /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2672/de/packaging/scripts/helpers_v2.1 hreflang=de /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2672/en/packaging/scripts/helpers_v2.1 hreflang=en /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2672/es/packaging/scripts/helpers_v2.1 hreflang=es /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2672/fr/packaging/scripts/helpers_v2.1 hreflang=fr /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2672/it/packaging/scripts/helpers_v2.1 hreflang=it /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2672/oc/packaging/scripts/helpers_v2.1 hreflang=oc /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2672/ru/packaging/scripts/helpers_v2.1 hreflang=ru /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2672/packaging/scripts/helpers_v2.1 hreflang=en-GB /><link data-rh=true rel=alternate href=https://doc.next.yunohost.org/doc/pr-2672/packaging/scripts/helpers_v2.1 hreflang=x-default /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://doc.next.yunohost.org/doc/pr-2672/ru/packaging/","name":"Packaging applications","position":1},{"@type":"ListItem","item":"https://doc.next.yunohost.org/doc/pr-2672/ru/packaging/scripts/","name":"The scripts","position":2},{"@type":"ListItem","item":"https://doc.next.yunohost.org/doc/pr-2672/ru/packaging/scripts/helpers_v2.1","name":"App helpers (v2.1)","position":3}]}</script><script src=/js/language-detect.js async data-language-redirect='{"ar":"/ar/","ca":"/ca/","de":"/de/","en":"/en/","es":"/es/","fr":"/fr/","it":"/it/","oc":"/oc/","ru":"/ru/"}'></script><link rel=stylesheet href=/doc/pr-2672/ru/assets/css/styles.d1dd00e9.css /><script src=/doc/pr-2672/ru/assets/js/runtime~main.15e0558b.js defer></script><script src=/doc/pr-2672/ru/assets/js/main.8392cd21.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/doc/pr-2672/ru/img/icons/logo-ynh_horizontal.png /><link rel=preload as=image href=/doc/pr-2672/ru/img/icons/ynh_logo_roundcorner.png /><div role=region aria-label="Перейти к основному содержимому"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Перейти к основному содержимому</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Переключить навигационную панель" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/doc/pr-2672/ru/><div class=navbar__logo><img src=/doc/pr-2672/ru/img/icons/logo-ynh_horizontal.png alt="Yunohost Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/doc/pr-2672/ru/img/icons/logo-ynh_horizontal.png alt="Yunohost Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div><b class="navbar__title text--truncate">Docs</b></a><a class="navbar__item navbar__link" href=/doc/pr-2672/ru/admin/>Administration</a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/doc/pr-2672/ru/dev/>Development and packaging</a><a class="navbar__item navbar__link" href=/doc/pr-2672/ru/community/>Community</a><a href=https://apps.yunohost.org/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">Apps catalog<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class=navbarSearchContainer_Bca1><div class=navbar__search><span aria-label="expand searchbar" role=button class=search-icon tabindex=0></span><input id=search_input_react type=search placeholder=Loading... aria-label=Search class="navbar__search-input search-bar" disabled/></div></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>Русский</a><ul class=dropdown__menu><li><a href="/doc/pr-2672/ar/packaging/scripts/helpers_v2.1?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=ar>العربية</a><li><a href="/doc/pr-2672/ca/packaging/scripts/helpers_v2.1?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=ca>Català</a><li><a href="/doc/pr-2672/de/packaging/scripts/helpers_v2.1?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=de>Deutsch</a><li><a href="/doc/pr-2672/en/packaging/scripts/helpers_v2.1?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href="/doc/pr-2672/es/packaging/scripts/helpers_v2.1?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=es>Español</a><li><a href="/doc/pr-2672/fr/packaging/scripts/helpers_v2.1?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=fr>Français</a><li><a href="/doc/pr-2672/it/packaging/scripts/helpers_v2.1?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=it>Italiano</a><li><a href="/doc/pr-2672/oc/packaging/scripts/helpers_v2.1?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=oc>Occitan</a><li><a href="/doc/pr-2672/ru/packaging/scripts/helpers_v2.1?persistLocale=true" target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=ru>Русский</a><li><a href="/doc/pr-2672/packaging/scripts/helpers_v2.1?persistLocale=true" target=_self rel="noopener noreferrer" class=dropdown__link lang=en-GB>British English</a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Переключение между темным и светлым режимом (сейчас используется system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Прокрутка к началу" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/doc/pr-2672/ru/><img src=/doc/pr-2672/ru/img/icons/logo-ynh_horizontal.png alt="Yunohost Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/doc/pr-2672/ru/img/icons/logo-ynh_horizontal.png alt="Yunohost Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/><b>Docs</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/doc/pr-2672/ru/dev/><span title="Developer documentation" class=linkLabel_WmDU>Developer documentation</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/doc/pr-2672/ru/dev/doc/><span title="Write documentation" class=categoryLinkLabel_W154>Write documentation</span></a><button aria-label="Expand sidebar category 'Write documentation'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/doc/pr-2672/ru/dev/core/><span title="Core development" class=categoryLinkLabel_W154>Core development</span></a><button aria-label="Expand sidebar category 'Core development'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href=/doc/pr-2672/ru/packaging/><span title="Packaging applications" class=categoryLinkLabel_W154>Packaging applications</span></a><button aria-label="Collapse sidebar category 'Packaging applications'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2672/ru/packaging/><span title="Packaging applications" class=linkLabel_WmDU>Packaging applications</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2672/ru/packaging/structure><span title="App structure" class=linkLabel_WmDU>App structure</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/doc/pr-2672/ru/packaging/manifest/><span title="The manifest" class=categoryLinkLabel_W154>The manifest</span></a><button aria-label="Collapse sidebar category 'The manifest'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2672/ru/packaging/manifest/resources><span title="App resources" class=linkLabel_WmDU>App resources</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex=0 href=/doc/pr-2672/ru/packaging/scripts/><span title="The scripts" class=categoryLinkLabel_W154>The scripts</span></a><button aria-label="Collapse sidebar category 'The scripts'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2672/ru/packaging/scripts/shell_variables_scope><span title="General scope of variables" class=linkLabel_WmDU>General scope of variables</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2672/ru/packaging/scripts/helpers_v2.0><span title="App helpers (v2)" class=linkLabel_WmDU>App helpers (v2)</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/doc/pr-2672/ru/packaging/scripts/helpers_v2.1><span title="App helpers (v2.1)" class=linkLabel_WmDU>App helpers (v2.1)</span></a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2672/ru/packaging/doc><span title=Documentation class=linkLabel_WmDU>Documentation</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2672/ru/packaging/test><span title="Testing your app" class=linkLabel_WmDU>Testing your app</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2672/ru/packaging/publish><span title="Publishing your app on the catalog" class=linkLabel_WmDU>Publishing your app on the catalog</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/doc/pr-2672/ru/packaging/advanced><span title=Advanced class=categoryLinkLabel_W154>Advanced</span></a><button aria-label="Expand sidebar category 'Advanced'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/doc/pr-2672/ru/category/misc-resources><span title="Misc resources" class=categoryLinkLabel_W154>Misc resources</span></a><button aria-label="Expand sidebar category 'Misc resources'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/doc/pr-2672/ru/packaging/policy><span title="Apps catalog policy" class=linkLabel_WmDU>Apps catalog policy</span></a></ul></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Навигационная цепочка текущей страницы"><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Главная страница" class=breadcrumbs__link href=/doc/pr-2672/ru/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/doc/pr-2672/ru/packaging/><span>Packaging applications</span></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/doc/pr-2672/ru/packaging/scripts/><span>The scripts</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>App helpers (v2.1)</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">Содержание этой страницы</button></div><div class="theme-doc-markdown markdown"><header><h1>App helpers (v2.1)</h1></header><p>Doc auto-generated by <a href=https://github.com/YunoHost/doc/blob/e1ce8661ec6f1f6597eeb5adc82e2ca367aafcad/scripts/helpers_doc_generate.py target=_blank rel="noopener noreferrer">this script</a> on 18/09/2025 (YunoHost version 12.1.25)</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=sources>Sources<a href=#sources class=hash-link aria-label="Прямая ссылка на Sources" title="Прямая ссылка на Sources" translate=no>​</a></h2>
<p>This is coupled to the 'sources' resource in the manifest.toml</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=sources-1>Sources<a href=#sources-1 class=hash-link aria-label="Прямая ссылка на Sources" title="Прямая ссылка на Sources" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_setup_source</code><br/><i>Download, check integrity, uncompress and patch upstream sources</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_setup_source --dest_dir=dest_dir [--source_id=source_id] [--keep="file1 file2"] [--full_replace]</code><p><strong>Arguments</strong>:<ul>
<li><code>--dest_dir=</code>: Directory where to setup sources</li>
<li><code>--source_id=</code>: Name of the source, defaults to <code>main</code> (when the sources resource exists in manifest.toml) or (legacy) <code>app</code> otherwise</li>
<li><code>--keep=</code>: Space-separated list of files/folders that will be backup/restored in $dest_dir, such as a config file you don't want to overwrite. For example 'conf.json secrets.json logs' (no trailing <code>/</code> for folders)</li>
<li><code>--full_replace=</code>: Remove previous sources before installing new sources (can be 1 or 0, default to 0)</li>
</ul><p><strong>Details</strong>:
This helper will read infos from the 'sources' resources in the <code>manifest.toml</code> of the app
and expect a structure like:<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token punctuation" style=color:#393A34>[</span><span class="token table class-name">resources.sources</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token table class-name">resources.sources.main</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>url</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"https://some.address.to/download/the/app/archive"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>sha256</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"0123456789abcdef"</span><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># The sha256 sum of the asset obtained from the URL</span><br/></span></code></pre></div></div><p>(See also the resources documentation which may be more complete?)<h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=optional-flags-in-the-sources-resource>Optional flags in the 'sources' resource<a href=#optional-flags-in-the-sources-resource class=hash-link aria-label="Прямая ссылка на Optional flags in the 'sources' resource" title="Прямая ссылка на Optional flags in the 'sources' resource" translate=no>​</a></h5><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">format    = "tar.gz"/xz/bz2/tar # automatically guessed from the extension of the URL, but can be set explicitly. Will use `tar` to extract</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            "zip"               # automatically guessed from the extension of the URL, but can be set explicitly. Will use `unzip` to extract</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            "docker"            # useful to extract files from an already-built docker image (instead of rebuilding them locally). Will use `docker-image-extract` to extract</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            "whatever"          # an arbitrary value, not really meaningful except to imply that the file won't be extracted</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">in_subdir = true    # default, there's an intermediate subdir in the archive before accessing the actual files</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            false   # sources are directly in the archive root</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            n       # (special cases) an integer representing a number of subdirs levels to get rid of</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">extract   = true    # default if file is indeed an archive such as .zip, .tar.gz, .tar.bz2, ...</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">          = false   # default if file 'format' is not set and the file is not to be extracted because it is not an archive but a script or binary or whatever asset.</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                    #    in which case the file will only be `mv`ed to the location possibly renamed using the `rename` value</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">rename    = "whatever_your_want"   # to be used for convenience when `extract` is false and the default name of the file is not practical</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">platform  = "linux/amd64"          # (defaults to "linux/$YNH_ARCH") to be used in conjonction with `format = "docker"` to specify which architecture to extract for</span><br/></span></code></pre></div></div><p>You may also define assets url and checksum per-architectures such as:<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token punctuation" style=color:#393A34>[</span><span class="token table class-name">resources.sources</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token table class-name">resources.sources.main</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>amd64.url</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"https://some.address.to/download/the/app/archive/when/amd64"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>amd64.sha256</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"0123456789abcdef"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>armhf.url</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"https://some.address.to/download/the/app/archive/when/armhf"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>armhf.sha256</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"fedcba9876543210"</span><br/></span></code></pre></div></div><p>In which case <code>ynh_setup_source --dest_dir="$install_dir"</code> will automatically pick the appropriate source depending on the arch<p>The helper will:<ul>
<li>Download the specific URL if there is no local archive</li>
<li>Check the integrity with the specific sha256 sum</li>
<li>Uncompress the archive to <code>$dest_dir</code>.<!-- -->
<ul>
<li>If <code>in_subdir</code> is true, the first level directory of the archive will be removed.</li>
<li>If <code>in_subdir</code> is a numeric value, the N first level directories will be removed.</li>
</ul>
</li>
<li>Patches named <code>patches/${src_id}/*.patch</code> will be applied to <code>$dest_dir</code></li>
<li>Apply sane default permissions (see _ynh_apply_default_permissions)</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/sources#L83 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=app-technologies>App Technologies<a href=#app-technologies class=hash-link aria-label="Прямая ссылка на App Technologies" title="Прямая ссылка на App Technologies" translate=no>​</a></h2>
<p>These allow to install specific version of the technology required to run some apps</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=nodejs>Nodejs<a href=#nodejs class=hash-link aria-label="Прямая ссылка на Nodejs" title="Прямая ссылка на Nodejs" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_nodejs_install</code><br/><i>Install a specific version of nodejs, using 'n'</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_nodejs_install</code><p><strong>Details</strong>:
The installed version is defined by <code>$nodejs_version</code> which should be defined as global prior to calling this helper<p><code>n</code> (Node version management) uses the <code>PATH</code> variable to store the path of the version of node it is going to use.
That's how it changes the version<p>The helper adds the appropriate, specific version of nodejs to the <code>$PATH</code> variable (which
is preserved when calling ynh_exec_as_app). Also defines:<ul>
<li><code>$path_with_nodejs</code> to be used in the systemd config (<code>Environment="PATH=__PATH_WITH_NODEJS__"</code>)</li>
<li><code>$nodejs_dir</code>, the directory containing the specific version of nodejs, which may be used in the systemd config too (e.g. <code>ExecStart=__NODEJS_DIR__/node foo bar</code>)</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/nodejs#L72 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_nodejs_remove</code><br/><i>Remove the version of node used by the app.</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_nodejs_remove</code><p><strong>Details</strong>:
This helper will check if another app uses the same version of node.<ul>
<li>If not, this version of node will be removed.</li>
<li>If no other app uses node, n will be also removed.</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/nodejs#L106 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ruby>Ruby<a href=#ruby class=hash-link aria-label="Прямая ссылка на Ruby" title="Прямая ссылка на Ruby" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_ruby_install</code><br/><i>Install a specific version of Ruby using rbenv</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_ruby_install</code><p><strong>Details</strong>:
The installed version is defined by <code>$ruby_version</code> which should be defined as global prior to calling this helper<p>The helper adds the appropriate, specific version of ruby to the <code>$PATH</code> variable (which
is preserved when calling ynh_exec_as_app). Also defines:<ul>
<li><code>$path_with_ruby</code> to be used in the systemd config (<code>Environment="PATH=__PATH_WITH_RUBY__"</code>)</li>
<li><code>$ruby_dir</code>, the directory containing the specific version of ruby, which may be used in the systemd config too (e.g. <code>ExecStart=__RUBY_DIR__/ruby foo bar</code>)</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/ruby#L68 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_ruby_remove</code><br/><i>Remove the version of Ruby used by the app.</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_ruby_remove</code><p><strong>Details</strong>:
This helper will also cleanup unused Ruby versions<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/ruby#L110 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=go>Go<a href=#go class=hash-link aria-label="Прямая ссылка на Go" title="Прямая ссылка на Go" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_go_install</code><br/><i>Install a specific version of Go using goenv</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_go_install</code><p><strong>Details</strong>:
The installed version is defined by <code>$go_version</code> which should be defined as global prior to calling this helper<p>The helper adds the appropriate, specific version of go to the <code>$PATH</code> variable (which
is preserved when calling <code>ynh_exec_as_app</code>). Also defines:<ul>
<li><code>$path_with_go</code> (the value of the modified <code>$PATH</code>, but you dont really need it?)</li>
<li><code>$go_dir</code> (the directory containing the specific go version)</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/go#L68 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_go_remove</code><br/><i>Remove the version of Go used by the app.</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_go_remove</code><p><strong>Details</strong>:
This helper will also cleanup Go versions<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/go#L99 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=composer>Composer<a href=#composer class=hash-link aria-label="Прямая ссылка на Composer" title="Прямая ссылка на Composer" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_composer_install</code><br/><i>Install and initialize Composer in the given directory</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_composer_install</code><p><strong>Details</strong>:
The installed version is defined by <code>$composer_version</code> which should be defined
as global prior to calling this helper.<p>Will use <code>$install_dir</code> as workdir unless <code>$composer_workdir</code> exists (but that shouldnt be necessary)<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/composer#L29 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_composer_exec</code><br/><i>Execute a command with Composer</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_composer_exec commands</code><p><strong>Details</strong>:
Will use <code>$install_dir</code> as workdir unless <code>$composer_workdir</code> exists (but that shouldnt be necessary)<p>You may also define <code>composer_user=root</code> prior to call this helper if you
absolutely need composer to run as root, but this is discouraged...<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/composer#L55 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=databases>Databases<a href=#databases class=hash-link aria-label="Прямая ссылка на Databases" title="Прямая ссылка на Databases" translate=no>​</a></h2>
<p>This is coupled to the 'database' resource in the manifest.toml - at least for mysql/postgresql. Mongodb/redis may have better integration in the future.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=mysql>Mysql<a href=#mysql class=hash-link aria-label="Прямая ссылка на Mysql" title="Прямая ссылка на Mysql" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_mysql_db_shell</code><br/><i>Run SQL instructions in a database ($db_name by default)</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_mysql_db_shell [database] &lt;&lt;&lt; "instructions"</code><p><strong>Arguments</strong>:<ul>
<li><code>database=</code>: the database to connect to (by default, $db_name)</li>
</ul><p><strong>Examples</strong>:<ul>
<li><code>ynh_mysql_db_shell $db_name &lt;&lt;&lt; "UPDATE ...;"</code></li>
<li><code>ynh_mysql_db_shell &lt; /path/to/file.sql</code></li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mysql#L30 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_mysql_dump_db</code><br/><i>Dump a database</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_mysql_dump_db database</code><p><strong>Arguments</strong>:<ul>
<li><code>database</code>: the database name to dump (by default, $db_name)</li>
</ul><p><strong>Returns</strong>: The mysqldump output<p><strong>Example</strong>: <code>ynh_mysql_dump_db "roundcube" > ./dump.sql</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mysql#L92 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=postgresql>Postgresql<a href=#postgresql class=hash-link aria-label="Прямая ссылка на Postgresql" title="Прямая ссылка на Postgresql" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_psql_db_shell</code><br/><i>Run SQL instructions in a database ($db_name by default)</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_psql_db_shell database &lt;&lt;&lt; "instructions"</code><p><strong>Arguments</strong>:<ul>
<li><code>database</code>: the database to connect to (by default, $db_name)</li>
</ul><p><strong>Examples</strong>:<ul>
<li><code>ynh_psql_db_shell $db_name &lt;&lt;&lt; "UPDATE ...;"</code></li>
<li><code>ynh_psql_db_shell &lt; /path/to/file.sql</code></li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/postgresql#L34 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_psql_dump_db</code><br/><i>Dump a database</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_psql_dump_db database</code><p><strong>Arguments</strong>:<ul>
<li><code>database</code>: the database name to dump (by default, $db_name)</li>
</ul><p><strong>Returns</strong>: the psqldump output<p><strong>Example</strong>: <code>ynh_psql_dump_db 'roundcube' > ./dump.sql</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/postgresql#L89 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=mongodb>Mongodb<a href=#mongodb class=hash-link aria-label="Прямая ссылка на Mongodb" title="Прямая ссылка на Mongodb" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_mongo_exec</code><br/><i>Execute a mongo command</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_mongo_exec [--database=database] --command="command"</code><p><strong>Arguments</strong>:<ul>
<li><code>--database=</code>: The database to connect to</li>
<li><code>--command=</code>: The command to evaluate</li>
</ul><p><strong>Example</strong>: <code>ynh_mongo_exec --command='db.getMongo().getDBNames().indexOf("wekan")' example: ynh_mongo_exec --command="db.getMongo().getDBNames().indexOf(\"wekan\")"</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L31 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_mongo_dump_db</code><br/><i>Dump a database</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_mongo_dump_db --database=database</code><p><strong>Arguments</strong>:<ul>
<li><code>--database=</code>: The database name to dump</li>
</ul><p><strong>Returns</strong>: the mongodump output<p><strong>Example</strong>: <code>ynh_mongo_dump_db --database=wekan > ./dump.bson</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L81 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_mongo_database_exists</code><br/><i>Check if a mongo database exists</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_mongo_database_exists --database=database | exit: Return 1 if the database doesn't exist, 0 otherwise</code><p><strong>Arguments</strong>:<ul>
<li><code>--database=</code>: The database for which to check existence</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L124 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_mongo_restore_db</code><br/><i>Restore a database</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_mongo_restore_db --database=database</code><p><strong>Arguments</strong>:<ul>
<li><code>--database=</code>: The database name to restore</li>
</ul><p><strong>Example</strong>: <code>ynh_mongo_restore_db --database=wekan &lt; ./dump.bson</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L146 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_mongo_setup_db</code><br/><i>Create a database, an user and its password. Then store the password in the app's config</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_mongo_setup_db --db_user=user --db_name=name [--db_pwd=pwd]</code><p><strong>Arguments</strong>:<ul>
<li><code>--db_user=</code>: Owner of the database</li>
<li><code>--db_name=</code>: Name of the database</li>
<li><code>--db_pwd=</code>: Password of the database. If not provided, a password will be generated</li>
</ul><p><strong>Details</strong>:
After executing this helper, the password of the created database will be available in $db_pwd
It will also be stored as "mongopwd" into the app settings.<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L187 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_mongo_remove_db</code><br/><i>Remove a database if it exists, and the associated user</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_mongo_remove_db --db_user=user --db_name=name</code><p><strong>Arguments</strong>:<ul>
<li><code>--db_user=</code>: Owner of the database</li>
<li><code>--db_name=</code>: Name of the database</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L214 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_install_mongo</code><br/><i>Install MongoDB and integrate MongoDB service in YunoHost</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_install_mongo</code><p><strong>Details</strong>:
The installed version is defined by $mongo_version which should be defined as global prior to calling this helper<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L238 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_remove_mongo</code><br/><i>Remove MongoDB
Only remove the MongoDB service integration in YunoHost for now
if MongoDB package as been removed</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_remove_mongo</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L279 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=redis>Redis<a href=#redis class=hash-link aria-label="Прямая ссылка на Redis" title="Прямая ссылка на Redis" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_redis_get_free_db</code><br/><i>get the first available redis database</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_redis_get_free_db</code><p><strong>Returns</strong>: the database number to use<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/redis#L25 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_redis_remove_db</code><br/><i>Erase a redis database so it can be reused by other apps.</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_redis_remove_db database</code><p><strong>Arguments</strong>:<ul>
<li><code>database</code>: the database to erase</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/redis#L51 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=configurations--templating>Configurations / Templating<a href=#configurations--templating class=hash-link aria-label="Прямая ссылка на Configurations / Templating" title="Прямая ссылка на Configurations / Templating" translate=no>​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=templating>Templating<a href=#templating class=hash-link aria-label="Прямая ссылка на Templating" title="Прямая ссылка на Templating" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_config_add</code><br/><i>Create a dedicated config file from a template</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_config_add --template="template" --destination="destination"</code><p><strong>Arguments</strong>:<ul>
<li><code>--template=</code>: Template config file to use</li>
<li><code>--destination=</code>: Destination of the config file</li>
<li><code>--jinja</code>: Use jinja template instead of the simple <code>__MY_VAR__</code> templating format</li>
</ul><p><strong>Examples</strong>:<ul>
<li><code>ynh_config_add --template=".env" --destination="$install_dir/.env"   # (use the template file "conf/.env" from the app's package)</code></li>
<li><code>ynh_config_add --jinja --template="config.j2" --destination="$install_dir/config"    # (use the template file "conf/config.j2" from the app's package)</code></li>
</ul><p><strong>Details</strong>:
The template can be 1) the name of a file in the <code>conf</code> directory of
the app, 2) a relative path or 3) an absolute path.<p>This applies a simple templating format which covers a good 95% of cases,
where patterns like <code>__FOO__</code> are replaced by the bash variable <code>$foo</code>, for example:
<code>__DOMAIN__</code>   by <code>$domain</code>
<code>__PATH__</code>     by <code>$path</code>
<code>__APP__</code>      by <code>$app</code>
<code>__VAR_1__</code>    by <code>$var_1</code>
<code>__VAR_2__</code>    by <code>$var_2</code><p>Special case for <code>__PATH__/</code> which is replaced by <code>/</code> instead of <code>//</code> if <code>$path</code> is <code>/</code><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=when---jinja-is-enabled>When --jinja is enabled<a href=#when---jinja-is-enabled class=hash-link aria-label="Прямая ссылка на When --jinja is enabled" title="Прямая ссылка на When --jinja is enabled" translate=no>​</a></h5><p>This option is meant for advanced use-cases where the "simple" templating
mode ain't enough because you need conditional blocks or loops.<p>For a full documentation of jinja's syntax you can refer to <a href=https://jinja.palletsprojects.com/en/3.1.x/templates/ target=_blank rel="noopener noreferrer">the official Jinja documentation</a>.<p>Note that in YunoHost context, all variables are from shell variables and therefore are strings
To help handling complex data Jinja engine are executed with theses additional filters:<ul>
<li>from_json: load a string as Json and return an object</li>
<li>from_yaml: load a string as Yaml and return an object</li>
<li>from_toml: load a string as Toml and return an object</li>
<li>to_json: serialize to string an object to Json</li>
<li>to_yaml: serialize to string an object to Yaml</li>
<li>to_toml: serialize to string an object to Toml</li>
</ul><p>So by example, if you want to convert a json string <code>$my_json</code> to Toml, you can to this way:
<code>{{ my_json | from_json | to_toml }}</code>
Or you can iterate on a Json list <code>my_list='["a", "b", "c"]'</code> this way:<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">{% for i in my_list | from_json %}</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"> value {{ i }}</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">{% endfor }}</span><br/></span></code></pre></div></div><p>which will result:<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">value a</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">value b</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">value c</span><br/></span></code></pre></div></div><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=keeping-track-of-manual-changes-by-the-admin>Keeping track of manual changes by the admin<a href=#keeping-track-of-manual-changes-by-the-admin class=hash-link aria-label="Прямая ссылка на Keeping track of manual changes by the admin" title="Прямая ссылка на Keeping track of manual changes by the admin" translate=no>​</a></h5><p>The helper will verify the checksum and backup the destination file
if it's different before applying the new template.<p>And it will calculate and store the destination file checksum
into the app settings when configuration is done.<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/templating#L84 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_read_var_in_file</code><br/><i>Get a value from heterogeneous file (yaml, json, php, python...)</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_read_var_in_file --file=PATH --key=KEY</code><p><strong>Arguments</strong>:<ul>
<li><code>--file=</code>: the path to the file</li>
<li><code>--key=</code>: the key to get</li>
<li><code>--after=</code>: the line just before the key (in case of multiple lines with the name of the key in the file)</li>
</ul><p><strong>Details</strong>:
This helpers match several var affectation use case in several languages
We don't use jq or equivalent to keep comments and blank space in files
This helpers work line by line, it is not able to work correctly
if you have several identical keys in your files<p>Example of line this helpers can managed correctly<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">.yml</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    title: YunoHost documentation</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    email: 'yunohost@yunohost.org'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">.json</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    "theme": "colib'ris",</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    "port": 8102</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    "some_boolean":     false,</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    "user": null</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">.ini</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    some_boolean = On</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    action = "Clear"</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    port = 20</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">.php</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    $user=</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    user => 20</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">.py</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    USER = 8102</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    user = 'https://donate.local'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    CUSTOM['user'] = 'YunoHost'</span><br/></span></code></pre></div></div><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/templating#L219 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_write_var_in_file</code><br/><i>Set a value into heterogeneous file (yaml, json, php, python...)</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_write_var_in_file --file=PATH --key=KEY --value=VALUE</code><p><strong>Arguments</strong>:<ul>
<li><code>--file=</code>: the path to the file</li>
<li><code>--key=</code>: the key to set</li>
<li><code>--value=</code>: the value to set</li>
<li><code>--after=</code>: the line just before the key (in case of multiple lines with the name of the key in the file)</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/templating#L294 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=nginx>Nginx<a href=#nginx class=hash-link aria-label="Прямая ссылка на Nginx" title="Прямая ссылка на Nginx" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_config_add_nginx</code><br/><i>Create a dedicated nginx config</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_config_add_nginx</code><p><strong>Details</strong>:
This will use a template in <code>../conf/nginx.conf</code>
See the documentation of <code>ynh_config_add</code> for a description of the template
format and how placeholders are replaced with actual variables.<p>Additionally, ynh_config_add_nginx will replace:<ul>
<li><code>#sub_path_only</code>      by empty string if <code>path</code> is not <code>'/'</code></li>
<li><code>#root_path_only</code>     by empty string if <code>path</code>  <em>is</em>  <code>'/'</code></li>
</ul><p>This allows to enable/disable specific behaviors dependenging on the install
location<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/nginx#L36 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_config_remove_nginx</code><br/><i>Remove the dedicated nginx config</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_config_remove_nginx</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/nginx#L61 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_config_change_url_nginx</code><br/><i>Regen the nginx config in a change url context</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_config_change_url_nginx</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/nginx#L69 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=php>Php<a href=#php class=hash-link aria-label="Прямая ссылка на Php" title="Прямая ссылка на Php" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_config_add_phpfpm</code><br/><i>Create a dedicated PHP-FPM config</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_config_add_phpfpm</code><p><strong>Details</strong>:
This will automatically generate an appropriate PHP-FPM configuration for this app.<p>The resulting configuration will be deployed to the appropriate place:
<code>/etc/php/$php_version/fpm/pool.d/$app.conf</code><p>If the app provides a <code>conf/extra_php-fpm.conf</code> template, it will be appended
to the generated configuration. (In the vast majority of cases, this shouldnt
be necessary)<p>$php_version should be defined prior to calling this helper, but there should
be no reason to manually set it, as it is automatically set by the apt
helpers/resources when installing phpX.Y dependencies (PHP apps should at
least install phpX.Y-fpm using the <code>apt</code> helper/resource)<p><code>$php_group</code> can be defined as a global (from <code>_common.sh</code>) if the worker
processes should run with a different group than <code>$app</code><p>Additional "pm" and "php_admin_value" settings which are meant to be possibly
configurable by admins from a future standard config panel at some point,
related to performance and availability of the app, for which tweaking may be
required if the app is used by "plenty" of users and other memory/CPU load
considerations....<p>If you have good reasons to be willing to use different
defaults than the one set by this helper (while still allowing admin to
override it) you should use <code>ynh_app_setting_set_default</code><ul>
<li><code>$php_upload_max_filezise</code>: corresponds upload_max_filesize and post_max_size. Defaults to 50M</li>
<li><code>$php_process_management</code>: corresponds to "pm" (ondemand, dynamic, static). Defaults to ondemand</li>
<li><code>$php_max_children</code>: by default, computed from "total RAM" divided by 40, cf <code>_default_php_max_children</code></li>
<li><code>$php_memory_limit</code>: by default, 128M (from global php.ini)</li>
</ul><p>Note that if $php_process_management is set to "dynamic", then these
variables MUST be defined prior to calling the helper (no default value) ...
Check PHP-FPM's manual for more info on what these are (: ...<ul>
<li><code>$php_start_servers</code></li>
<li><code>$php_min_spare_servers</code></li>
<li><code>$php_max_spare_servers</code></li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/php#L68 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_config_remove_phpfpm</code><br/><i>Remove the dedicated PHP-FPM config</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_config_remove_phpfpm</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/php#L144 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=systemd>Systemd<a href=#systemd class=hash-link aria-label="Прямая ссылка на Systemd" title="Прямая ссылка на Systemd" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_config_add_systemd</code><br/><i>Create a dedicated systemd config</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_config_add_systemd [--service=service] [--template=template]</code><p><strong>Arguments</strong>:<ul>
<li><code>--service=</code>: Service name (optionnal, <code>$app</code> by default)</li>
<li><code>--template=</code>: Name of template file (optionnal, this is 'systemd' by default, meaning <code>../conf/systemd.service</code> will be used as template)</li>
</ul><p><strong>Details</strong>:
This will use the template <code>../conf/&lt;templatename>.service</code>.<p>See the documentation of <code>ynh_config_add</code> for a description of the template
format and how placeholders are replaced with actual variables.<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemd#L31 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_config_remove_systemd</code><br/><i>Remove the dedicated systemd config</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_config_remove_systemd service</code><p><strong>Arguments</strong>:<ul>
<li><code>service</code>: Service name (optionnal, $app by default)</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemd#L51 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_systemctl</code><br/><i>Start (or other actions) a service,  print a log in case of failure and optionnaly wait until the service is completely started</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_systemctl [--service=service] [--action=action] [ [--wait_until="line to match"] [--log_path=log_path] [--timeout=300] [--length=20] ]</code><p><strong>Arguments</strong>:<ul>
<li><code>--service=</code>: Name of the service to start. Default : <code>$app</code></li>
<li><code>--action=</code>: Action to perform with systemctl. Default: start</li>
<li><code>--wait_until=</code>: The pattern to find in the log to attest the service is effectively fully started.</li>
<li><code>--log_path=</code>: Log file - Path to the log file. Default : <code>/var/log/$app/$app.log</code>; <code>systemd</code> to listen on <code>journalctl --unit=$service</code></li>
<li><code>--timeout=</code>: Timeout - The maximum time to wait before ending the watching. Default : 60 seconds.</li>
<li><code>--length=</code>: Length of the error log displayed for debugging : Default : 20</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemd#L70 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=fail2ban>Fail2ban<a href=#fail2ban class=hash-link aria-label="Прямая ссылка на Fail2ban" title="Прямая ссылка на Fail2ban" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_config_add_fail2ban</code><br/><i>Create a dedicated fail2ban config (jail and filter conf files)</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_config_add_fail2ban --logpath=log_file --failregex=filter</code><p><strong>Arguments</strong>:<ul>
<li><code>--logpath=</code>: Log file to be checked by fail2ban</li>
<li><code>--failregex=</code>: Failregex to be looked for by fail2ban</li>
</ul><p><strong>Details</strong>:
If --logpath / --failregex are provided, the helper will generate the appropriate conf using these.<p>Otherwise, it will assume that the app provided templates, namely
<code>../conf/f2b_jail.conf</code> and <code>../conf/f2b_filter.conf</code><p>They will typically look like (for example here for synapse):<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">f2b_jail</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">conf:</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token table class-name">__APP__</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>enabled</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>true</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>port</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> http</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">https</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>filter</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> __APP__</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>logpath</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> /var/log/__APP__/logfile</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">log</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>maxretry</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>5</span><br/></span></code></pre></div></div><div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">f2b_filter</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">conf:</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token table class-name">INCLUDES</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>before</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> common</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">conf</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token table class-name">Definition</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Part of regex definition (just used to make more easy to make the global regex)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key property" style=color:#36acaa>__synapse_start_line</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">? \- synapse\</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">+ \-</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Regex definition.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">   </span><span class="token key property" style=color:#36acaa>failregex</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> ^%(__synapse_start_line)s INFO \- POST\-(\d+)\- &lt;HOST> \- \d+ \- Received request\: POST /_matrix/client/r0/login\??&lt;SKIPLINES>%(__synapse_start_line)s INFO \- POST\-\</span><span class="token number" style=color:#36acaa>1</span><span class="token plain">\- Got login request with identifier: \</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain">u</span><span class="token string" style=color:#e3116c>'type'</span><span class="token plain">: u</span><span class="token string" style=color:#e3116c>'m.id.user'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> u</span><span class="token string" style=color:#e3116c>'user'</span><span class="token plain">\: u</span><span class="token string" style=color:#e3116c>'(.+?)'</span><span class="token plain">\</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> medium\: None</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> address: None</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> user\: u</span><span class="token string" style=color:#e3116c>'\5'</span><span class="token plain">&lt;SKIPLINES>%(__synapse_start_line)s WARNING \- \- (Attempted to login as @\</span><span class="token number" style=color:#36acaa>5</span><span class="token plain">\:</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">+ but they do not exist|Failed password login for user @\</span><span class="token number" style=color:#36acaa>5</span><span class="token plain">\:</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">+)$</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token key property" style=color:#36acaa>ignoreregex</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><br/></span></code></pre></div></div><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=regarding-the-the-failregex-option>Regarding the the <code>failregex</code> option<a href=#regarding-the-the-failregex-option class=hash-link aria-label="Прямая ссылка на regarding-the-the-failregex-option" title="Прямая ссылка на regarding-the-the-failregex-option" translate=no>​</a></h5><p>regex to match the password failure messages in the logfile. The host must be
matched by a group named "<code>host</code>". The tag "<code>&lt;HOST></code>" can be used for standard
IP/hostname matching and is only an alias for <code>(?:::f{4,6}:)?(?P&lt;host>[\w\-.^_]+)</code><p>You can find some more explainations about how to make a regex on <a href=https://www.fail2ban.org/wiki/index.php/MANUAL_0_8#Filters target=_blank rel="noopener noreferrer">the official fail2ban documentation</a>.<p>To validate your regex you can test with this command:<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">fail2ban-regex /var/log/YOUR_LOG_FILE_PATH /etc/fail2ban/filter.d/YOUR_APP.conf</span><br/></span></code></pre></div></div><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/fail2ban#L72 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_config_remove_fail2ban</code><br/><i>Remove the dedicated fail2ban config (jail and filter conf files)</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_config_remove_fail2ban</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/fail2ban#L134 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=logrotate>Logrotate<a href=#logrotate class=hash-link aria-label="Прямая ссылка на Logrotate" title="Прямая ссылка на Logrotate" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_config_add_logrotate</code><br/><i>Add a logrotate configuration to manage log files / log directory</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_config_add_logrotate [/path/to/log/file/or/folder]</code><p><strong>Details</strong>:
If not argument is provided, <code>/var/log/$app/*.log</code> is used as default.<p>The configuration is autogenerated by YunoHost
(ie it doesnt come from a specific app template like nginx or systemd conf)<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logrotate#L31 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_config_remove_logrotate</code><br/><i>Remove the app's logrotate config.</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: ``<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logrotate#L87 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=misc-tools>Misc Tools<a href=#misc-tools class=hash-link aria-label="Прямая ссылка на Misc Tools" title="Прямая ссылка на Misc Tools" translate=no>​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=utils>Utils<a href=#utils class=hash-link aria-label="Прямая ссылка на Utils" title="Прямая ссылка на Utils" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_exec_as_app</code><br/><i>Execute a command after sudoing as $app</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_exec_as_app COMMAND [ARG ...]</code><p><strong>Details</strong>:
Note that the $PATH variable is preserved (using env PATH=$PATH)<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L76 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_local_curl</code><br/><i>Curl abstraction to help with POST requests to local pages (such as installation forms)</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_local_curl "page_uri" "key1=value1" "key2=value2" ...</code><p><strong>Arguments</strong>:<ul>
<li><code>page_uri</code>: Path (relative to <code>$path</code>) of the page where POST data will be sent</li>
<li><code>key1=value1</code>: (Optionnal) POST key and corresponding value</li>
<li><code>key2=value2</code>: (Optionnal) Another POST key and corresponding value</li>
<li><code>...</code>: (Optionnal) More POST keys and values</li>
</ul><p><strong>Example</strong>: <code>ynh_local_curl "/install.php?installButton" "foo=$var1" "bar=$var2"</code><p><strong>Details</strong>:
For multiple calls, cookies are persisted between each call for the same app<p><code>$domain</code> and <code>$path</code> should be defined externally (and correspond to the domain.tld and the /path (of the app?))<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L93 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_safe_rm</code><br/><i>Remove a file or a directory, checking beforehand that it's not a disastrous location to rm such as entire /var or /home</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_safe_rm path_to_remove</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L162 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_read_manifest</code><br/><i>Read the value of a key in the app's manifest</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_read_manifest "key"</code><p><strong>Arguments</strong>:<ul>
<li><code>key</code>: Name of the key to find</li>
</ul><p><strong>Returns</strong>: the value associate to that key<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L188 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_app_upstream_version</code><br/><i>Return the app upstream version, deduced from <code>$YNH_APP_MANIFEST_VERSION</code> and strippig the <code>~ynhX</code> part</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_app_upstream_version</code><p><strong>Returns</strong>: the version number of the upstream app<p><strong>Details</strong>:
For example, if the manifest contains <code>4.3-2~ynh3</code> the function will return <code>4.3-2</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L198 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_app_upstream_version_changed</code><br/><i>Return 0 if the "upstream" part of the version changed, or 1 otherwise (ie only the ~ynh suffix changed)</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>if ynh_app_upstream_version_changed; then ...</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L205 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_app_upgrading_from_version_before</code><br/><i>Compare the current package version is strictly lower than another version given as an argument</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: ``<p><strong>Example</strong>: <code>if ynh_app_upgrading_from_version_before 2.3.2~ynh1; then ...</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L213 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_app_upgrading_from_version_before_or_equal_to</code><br/><i>Compare the current package version is lower or equal to another version given as an argument</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: ``<p><strong>Example</strong>: <code>if ynh_app_upgrading_from_version_before_or_equal_to 2.3.2~ynh1; then ...</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L223 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_validate_ip</code><br/><i>Validate an IP address</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_validate_ip --family=family --ip_address=ip_address</code><p><strong>Returns</strong>: 0 for valid ip addresses, 1 otherwise<p><strong>Example</strong>: <code>ynh_validate_ip 4 111.222.333.444</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L303 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_in_ci_tests</code><br/><i>Check if the scripts are being run by the package_check in CI</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_in_ci_tests</code><p><strong>Details</strong>:
Return 0 if in CI, 1 otherwise<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L367 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_user_get_info</code><br/><i>Retrieve a YunoHost user information</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_user_get_info --username=username --key=key</code><p><strong>Arguments</strong>:<ul>
<li><code>--username=</code>: the username to retrieve info from</li>
<li><code>--key=</code>: the key to retrieve</li>
</ul><p><strong>Returns</strong>: the value associate to that key<p><strong>Example</strong>: <code>mail=$(ynh_user_get_info --username="toto" --key=mail)</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L379 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_user_list</code><br/><i>Get the list of YunoHost users</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_user_list</code><p><strong>Returns</strong>: one username per line as strings<p><strong>Example</strong>: <code>for u in $(ynh_user_list); do ... ; done</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L396 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_spawn_app_shell</code><br/><i>Spawn a Bash shell with the app environment loaded</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_spawn_app_shell</code><p><strong>Examples</strong>:<ul>
<li><code>ynh_spawn_app_shell &lt;&lt;&lt; 'echo "$USER"'</code></li>
<li><code>ynh_spawn_app_shell &lt; /tmp/some_script.bash</code></li>
</ul><p><strong>Details</strong>:
The spawned shell will have environment variables loaded and environment files sourced
from the app's service configuration file (defaults to $app.service, overridable by the packager with <code>service</code> setting).
If the app relies on a specific PHP version, then <code>php</code> will be aliased that version. The PHP command will also be appended with the <code>phpflags</code> settings.<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L411 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_add_swap</code><br/><i>Add swap</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_add_swap --size=SWAP in Mb</code><p><strong>Arguments</strong>:<ul>
<li><code>-s</code>, <code>--size=</code>: Amount of SWAP to add in Mb.</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L479 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_smart_mktemp</code><br/><i>Check available space before creating a temp directory.</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_smart_mktemp --min_size="Min size"</code><p><strong>Arguments</strong>:<ul>
<li><code>-s</code>, <code>--min_size=</code>: Minimal size needed for the temporary directory, in Mb</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L579 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=setting>Setting<a href=#setting class=hash-link aria-label="Прямая ссылка на Setting" title="Прямая ссылка на Setting" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_app_setting_get</code><br/><i>Get an application setting</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_app_setting_get --key=key</code><p><strong>Arguments</strong>:<ul>
<li><code>--app=</code>: the application id (global $app by default)</li>
<li><code>--key=</code>: the setting to get</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/setting#L26 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_app_setting_set</code><br/><i>Set an application setting</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_app_setting_set --key=key --value=value</code><p><strong>Arguments</strong>:<ul>
<li><code>--app=</code>: the application id (global $app by default)</li>
<li><code>--key=</code>: the setting name to set</li>
<li><code>--value=</code>: the setting value to set</li>
</ul><p><strong>Details</strong>:
When choosing the setting key's name, note that including the following keywords will make the associated setting's value appear masked in the debug logs (cf. <a href=https://github.com/YunoHost/yunohost/blob/216210d5e97070b85c96ebb4548c6abf36987771/src/log.py#L571 target=_blank rel="noopener noreferrer">related code</a>): <code>pwd</code>, <code>pass</code>, <code>passwd</code>, <code>password</code>, <code>passphrase</code>, <code>secret\w*</code> (regex),  <code>\w+key</code> (regex), <code>token</code>, <code>PASSPHRASE</code>
This is meant to allow sharing the logs while preserving confidential data, but having this in mind is useful would you expect to see those values while debugging your scripts.<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/setting#L48 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_app_setting_set_default</code><br/><i>Set an application setting but only if the "$key" variable ain't set yet</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_app_setting_set_default --key=key --value=value</code><p><strong>Arguments</strong>:<ul>
<li><code>--app=</code>: the application id (global $app by default)</li>
<li><code>--key=</code>: the setting name to set</li>
<li><code>--value=</code>: the default setting value to set</li>
</ul><p><strong>Details</strong>:
Note that it doesn't just define the setting but ALSO define the $foobar variable<p>Hence it's meant as a replacement for this legacy overly complex syntax:<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-z</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"</span><span class="token string variable" style=color:#36acaa>${foo</span><span class="token string variable operator" style=color:#393A34>:-</span><span class="token string variable" style=color:#36acaa>}</span><span class="token string" style=color:#e3116c>"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>then</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token assign-left variable" style=color:#36acaa>foo</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"bar"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    ynh_app_setting_set </span><span class="token parameter variable" style=color:#36acaa>--key</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"foo"</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--value</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"</span><span class="token string variable" style=color:#36acaa>$foo</span><span class="token string" style=color:#e3116c>"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>fi</span><br/></span></code></pre></div></div><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/setting#L80 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_app_setting_delete</code><br/><i>Delete an application setting</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_app_setting_delete --key=key</code><p><strong>Arguments</strong>:<ul>
<li><code>--app=</code>: the application id (global $app by default)</li>
<li><code>--key=</code>: the setting to delete</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/setting#L102 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=string>String<a href=#string class=hash-link aria-label="Прямая ссылка на String" title="Прямая ссылка на String" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_string_random</code><br/><i>Generate a random string</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_string_random [--length=string_length]</code><p><strong>Arguments</strong>:<ul>
<li><code>--length=</code>: the string length to generate (default: 24)</li>
<li><code>--filter=</code>: the kind of characters accepted in the output (default: 'A-Za-z0-9')</li>
</ul><p><strong>Returns</strong>: the generated string<p><strong>Example</strong>: <code>pwd=$(ynh_string_random --length=8)</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/string#L29 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_replace</code><br/><i>Substitute/replace a string (or expression) by another in a file</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_replace --match=match --replace=replace --file=file</code><p><strong>Arguments</strong>:<ul>
<li><code>--match=</code>: String to be searched and replaced in the file</li>
<li><code>--replace=</code>: String that will replace matches</li>
<li><code>--file=</code>: File in which the string will be replaced.</li>
</ul><p><strong>Details</strong>:
As this helper is based on sed command, regular expressions and references to
sub-expressions can be used (see sed manual page for more information)<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/string#L51 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_replace_regex</code><br/><i>Substitute/replace a regex in a file</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_replace_regex --match=match --replace=replace --file=file</code><p><strong>Arguments</strong>:<ul>
<li><code>--match=</code>: String to be searched and replaced in the file</li>
<li><code>--replace=</code>: String that will replace matches</li>
<li><code>--file=</code>: File in which the string will be replaced.</li>
</ul><p><strong>Details</strong>:
This helper will use ynh_replace, but as you can use special
characters, you can't use some regular expressions and sub-expressions.<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/string#L79 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_normalize_url_path</code><br/><i>Normalize the url path syntax</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_normalize_url_path path_to_normalize</code><p><strong>Examples</strong>:<ul>
<li><code>url_path=$(ynh_normalize_url_path $url_path)</code></li>
<li><code>ynh_normalize_url_path example    # -> /example</code></li>
<li><code>ynh_normalize_url_path /example   # -> /example</code></li>
<li><code>ynh_normalize_url_path /example/  # -> /example</code></li>
<li><code>ynh_normalize_url_path /          # -> /</code></li>
</ul><p><strong>Details</strong>:
Handle the slash at the beginning of path and its absence at ending
Return a normalized url path<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/string#L134 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=backup>Backup<a href=#backup class=hash-link aria-label="Прямая ссылка на Backup" title="Прямая ссылка на Backup" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_backup</code><br/><i>Add a file or a directory to the list of paths to backup</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_backup /path/to/stuff</code><p><strong>Details</strong>:
NB : note that this helper does <em>NOT</em> perform any copy in itself, it only
declares stuff to be backuped via a CSV which is later picked up by the core<p>NB 2 : there is a specific behavior for $data_dir (or childs of $data_dir) and
/var/log/$app which are <em>NOT</em> backedup during safety-backup-before-upgrade,
OR if the setting "do_not_backup_data" is equals 1 for that app<p>The rationale is that these directories are usually too heavy to be integrated in every backup
(think for example about Nextcloud with quite a lot of data, or an app with a lot of media files...)<p>This is coupled to the fact that $data_dir and the log dir won't be (and
should NOT) be deleted during remove, unless --purge is used. Hence, if the
upgrade fails and the script is removed prior to restoring the backup, the
data/logs are not destroyed.<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/backup#L42 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_restore</code><br/><i>Restore a file or a directory from the backup archive</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_restore /path/to/stuff</code><p><strong>Examples</strong>:<ul>
<li><code>ynh_restore "/etc/nginx/conf.d/$domain.d/$app.conf"</code></li>
</ul><p><strong>Details</strong>:
If the file or dir to be restored already exists on the system and is lighter
than 500 Mo, it is backed up in <code>/var/cache/yunohost/appconfbackup/</code>.
Otherwise, the existing file or dir is removed.<p>if <code>apps/$app/etc/nginx/conf.d/$domain.d/$app.conf</code> exists, restore it into
<code>/etc/nginx/conf.d/$domain.d/$app.conf</code>
otheriwse, search for a match in the csv (eg: conf/nginx.conf) and restore it into
<code>/etc/nginx/conf.d/$domain.d/$app.conf</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/backup#L147 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_restore_everything</code><br/><i>Restore all files that were previously backuped in an app backup script</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_restore_everything</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/backup#L204 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_store_file_checksum</code><br/><i>Calculate and store a file checksum into the app settings</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_store_file_checksum /path/to/file</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/backup#L226 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_backup_if_checksum_is_different</code><br/><i>Verify the checksum and backup the file if it's different</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_backup_if_checksum_is_different /path/to/file</code><p><strong>Details</strong>:
This helper is primarily meant to allow to easily backup personalised/manually
modified config files.<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/backup#L257 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_delete_file_checksum</code><br/><i>Delete a file checksum from the app settings</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_delete_file_checksum /path/to/file</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/backup#L287 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=logging>Logging<a href=#logging class=hash-link aria-label="Прямая ссылка на Logging" title="Прямая ссылка на Logging" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_die</code><br/><i>Print a message to stderr and terminate the current script</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_die "Some message"</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L24 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_print_info</code><br/><i>Print an "INFO" message</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_print_info "Some message"</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L38 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_print_warn</code><br/><i>Print a warning on stderr</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_print_warn "Some message"</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L45 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_hide_warnings</code><br/><i>Execute a command and redirect stderr to stdout</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_hide_warnings your command and args</code><p><strong>Arguments</strong>:<ul>
<li><code>command</code>: command to execute</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L54 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_exec_and_print_stderr_only_if_error</code><br/><i>Execute a command and redirect stderr in /dev/null. Print stderr on error.</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_exec_and_print_stderr_only_if_error your command and args</code><p><strong>Arguments</strong>:<ul>
<li><code>command</code>: command to execute</li>
</ul><p><strong>Details</strong>:
Note that you should NOT quote the command but only prefix it with ynh_exec_and_print_stderr_only_if_error<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L65 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_return</code><br/><i>Return data to the YunoHost core for later processing (to be used by special hooks like app config panel and core diagnosis)</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_return somedata</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L80 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_script_progression</code><br/><i>Print a progress bar showing the progression of an app script</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_script_progression "Some message"</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L98 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=multimedia>Multimedia<a href=#multimedia class=hash-link aria-label="Прямая ссылка на Multimedia" title="Прямая ссылка на Multimedia" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_multimedia_build_main_dir</code><br/><i>Initialize the multimedia directory system</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_multimedia_build_main_dir</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/multimedia#L27 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_multimedia_addfolder</code><br/><i>Add a directory in <code>yunohost.multimedia</code></i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_multimedia_addfolder --source_dir="source_dir" --dest_dir="dest_dir"</code><p><strong>Arguments</strong>:<ul>
<li><code>--source_dir=</code>: Source directory - The real directory which contains your medias.</li>
<li><code>--dest_dir=</code>: Destination directory - The name and the place of the symbolic link, relative to <code>/home/yunohost.multimedia</code></li>
</ul><p><strong>Details</strong>:
This "directory" will be a symbolic link to a existing directory.<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/multimedia#L86 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_multimedia_addaccess</code><br/><i>Add an user to the multimedia group, in turn having write permission in multimedia directories</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_multimedia_addaccess user_name</code><p><strong>Arguments</strong>:<ul>
<li><code>user_name</code>: The name of the user which gain this access.</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/multimedia#L112 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=deprecated-or-handled-by-the-core--app-resources-since-v2>Deprecated Or Handled By The Core / App Resources Since V2<a href=#deprecated-or-handled-by-the-core--app-resources-since-v2 class=hash-link aria-label="Прямая ссылка на Deprecated Or Handled By The Core / App Resources Since V2" title="Прямая ссылка на Deprecated Or Handled By The Core / App Resources Since V2" translate=no>​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=permission>Permission<a href=#permission class=hash-link aria-label="Прямая ссылка на Permission" title="Прямая ссылка на Permission" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_permission_delete</code><br/><i>Remove a permission for the app (note that when the app is removed all permission is automatically removed)</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_permission_delete --permission="permission"</code><p><strong>Arguments</strong>:<ul>
<li><code>--permission=</code>: the name for the permission (by default a permission named "main" is removed automatically when the app is removed)</li>
</ul><p><strong>Example</strong>: <code>ynh_permission_delete --permission=editors</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/permission#L158 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_permission_exists</code><br/><i>Check if a permission exists</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_permission_exists --permission=permission | exit: Return 1 if the permission doesn't exist, 0 otherwise</code><p><strong>Arguments</strong>:<ul>
<li><code>--permission=</code>: the permission to check</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/permission#L173 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_permission_url</code><br/><i>Redefine the url associated to a permission</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_permission_url --permission "permission" [--url="url"] [--add_url="new-url" [ "other-new-url" ]] [--remove_url="old-url" [ "other-old-url" ]]                                                     [--auth_header=true|false] [--clear_urls]</code><p><strong>Arguments</strong>:<ul>
<li><code>--permission=</code>: the name for the permission (by default a permission named "main" is removed automatically when the app is removed)</li>
<li><code>--url=</code>: (optional) URL for which access will be allowed/forbidden. Note that if you want to remove url you can pass an empty sting as arguments ("").</li>
<li><code>--add_url=</code>: (optional) List of additional url to add for which access will be allowed/forbidden.</li>
<li><code>--remove_url=</code>: (optional) List of additional url to remove for which access will be allowed/forbidden</li>
<li><code>--auth_header=</code>: (optional) Define for the URL of this permission, if SSOwat pass the authentication header to the application</li>
<li><code>--clear_urls</code>: (optional) Clean all urls (url and additional_urls)</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/permission#L194 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_permission_update</code><br/><i>Update a permission for the app</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_permission_update --permission "permission" [--add="group" ["group" ...]] [--remove="group" ["group" ...]]</code><p><strong>Arguments</strong>:<ul>
<li><code>--permission=</code>: the name for the permission (by default a permission named "main" already exist)</li>
<li><code>--add=</code>: the list of group or users to enable add to the permission</li>
<li><code>--remove=</code>: the list of group or users to remove from the permission</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/permission#L257 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_permission_has_user</code><br/><i>Check if a permission has an user</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_permission_has_user --permission=permission --user=user | exit: Return 1 if the permission doesn't have that user or doesn't exist, 0 otherwise</code><p><strong>Arguments</strong>:<ul>
<li><code>--permission=</code>: the permission to check</li>
<li><code>--user=</code>: the user seek in the permission</li>
</ul><p><strong>Example</strong>: <code>ynh_permission_has_user --permission=main --user=visitors</code><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/permission#L298 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=apt>Apt<a href=#apt class=hash-link aria-label="Прямая ссылка на Apt" title="Прямая ссылка на Apt" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_apt_install_dependencies</code><br/><i>Define and install dependencies with a equivs control file</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_apt_install_dependencies dep [dep [...]]</code><p><strong>Arguments</strong>:<ul>
<li><code>dep</code>: the package name to install in dependence.</li>
<li><code>"dep1|dep2|…"</code>: You can specify alternatives. It will require to install (dep1 or dep2, etc).</li>
</ul><p><strong>Details</strong>:
example : ynh_apt_install_dependencies dep1 dep2 "dep3|dep4|dep5"<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/apt#L31 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_apt_remove_dependencies</code><br/><i>Remove fake package and its dependencies</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_apt_remove_dependencies</code><p><strong>Details</strong>:
Dependencies will removed only if no other package need them.<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/apt#L175 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_apt_install_dependencies_from_extra_repository</code><br/><i>Install packages from an extra repository properly.</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_apt_install_dependencies_from_extra_repository --repo="repo" --package="dep1 dep2" --key=key_url</code><p><strong>Arguments</strong>:<ul>
<li><code>--repo=</code>: Complete url of the extra repository.</li>
<li><code>--package=</code>: The packages to install from this extra repository</li>
<li><code>--key=</code>: url to get the public key.</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/apt#L205 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=systemuser>Systemuser<a href=#systemuser class=hash-link aria-label="Прямая ссылка на Systemuser" title="Прямая ссылка на Systemuser" translate=no>​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_system_user_exists</code><br/><i>Check if a user exists on the system</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_system_user_exists --username=username</code><p><strong>Arguments</strong>:<ul>
<li><code>--username=</code>: the username to check</li>
</ul><p><strong>Returns</strong>: 0 if the user exists, 1 otherwise.<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemuser#L26 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_system_group_exists</code><br/><i>Check if a group exists on the system</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_system_group_exists --group=group</code><p><strong>Arguments</strong>:<ul>
<li><code>--group=</code>: the group to check</li>
</ul><p><strong>Returns</strong>: 0 if the group exists, 1 otherwise.<p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemuser#L41 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_system_user_create</code><br/><i>Create a system user</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_system_user_create --username=user_name [--home_dir=home_dir] [--use_shell] [--groups="group1 group2"]</code><p><strong>Arguments</strong>:<ul>
<li><code>--username=</code>: Name of the system user that will be create</li>
<li><code>--home_dir=</code>: Path of the home dir for the user. Usually the final path of the app. If this argument is omitted, the user will be created without home</li>
<li><code>--use_shell</code>: Create a user using the default login shell if present. If this argument is omitted, the user will be created with /usr/sbin/nologin shell</li>
<li><code>--groups</code>: Add the user to system groups. Typically meant to add the user to the ssh.app / sftp.app group (e.g. for borgserver, my_webapp)</li>
</ul><p><strong>Details</strong>:
Create a nextcloud user with no home directory and /usr/sbin/nologin login shell (hence no login capability) :<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">ynh_system_user_create </span><span class="token parameter variable" style=color:#36acaa>--username</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">nextcloud</span><br/></span></code></pre></div></div><p>Create a discourse user using /var/www/discourse as home directory and the default login shell :<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">ynh_system_user_create </span><span class="token parameter variable" style=color:#36acaa>--username</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">discourse </span><span class="token parameter variable" style=color:#36acaa>--home_dir</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">/var/www/discourse </span><span class="token parameter variable" style=color:#36acaa>--use_shell</span><br/></span></code></pre></div></div><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemuser#L70 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary><code>ynh_system_user_delete</code><br/><i>Delete a system user</i></summary><div><div class=collapsibleContent_i85q><p><strong>Usage</strong>: <code>ynh_system_user_delete --username=user_name</code><p><strong>Arguments</strong>:<ul>
<li><code>--username=</code>: Name of the system user that will be create</li>
</ul><p><a href=https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemuser#L108 target=_blank rel="noopener noreferrer">Dude, show me the code!</a></div></div></details>
<hr/></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/YunoHost/doc/tree/main/docs/packaging/20.scripts/20.helpers_v2.1.mdx target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Отредактировать эту страницу</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Страница документа"><a class="pagination-nav__link pagination-nav__link--prev" href=/doc/pr-2672/ru/packaging/scripts/helpers_v2.0><div class=pagination-nav__sublabel>Предыдущая страница</div><div class=pagination-nav__label>App helpers (v2)</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/doc/pr-2672/ru/packaging/doc><div class=pagination-nav__sublabel>Следующая страница</div><div class=pagination-nav__label>Documentation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#sources class="table-of-contents__link toc-highlight">Sources</a><ul><li><a href=#sources-1 class="table-of-contents__link toc-highlight">Sources</a></ul><li><a href=#app-technologies class="table-of-contents__link toc-highlight">App Technologies</a><ul><li><a href=#nodejs class="table-of-contents__link toc-highlight">Nodejs</a><li><a href=#ruby class="table-of-contents__link toc-highlight">Ruby</a><li><a href=#go class="table-of-contents__link toc-highlight">Go</a><li><a href=#composer class="table-of-contents__link toc-highlight">Composer</a></ul><li><a href=#databases class="table-of-contents__link toc-highlight">Databases</a><ul><li><a href=#mysql class="table-of-contents__link toc-highlight">Mysql</a><li><a href=#postgresql class="table-of-contents__link toc-highlight">Postgresql</a><li><a href=#mongodb class="table-of-contents__link toc-highlight">Mongodb</a><li><a href=#redis class="table-of-contents__link toc-highlight">Redis</a></ul><li><a href=#configurations--templating class="table-of-contents__link toc-highlight">Configurations / Templating</a><ul><li><a href=#templating class="table-of-contents__link toc-highlight">Templating</a><li><a href=#nginx class="table-of-contents__link toc-highlight">Nginx</a><li><a href=#php class="table-of-contents__link toc-highlight">Php</a><li><a href=#systemd class="table-of-contents__link toc-highlight">Systemd</a><li><a href=#fail2ban class="table-of-contents__link toc-highlight">Fail2ban</a><li><a href=#logrotate class="table-of-contents__link toc-highlight">Logrotate</a></ul><li><a href=#misc-tools class="table-of-contents__link toc-highlight">Misc Tools</a><ul><li><a href=#utils class="table-of-contents__link toc-highlight">Utils</a><li><a href=#setting class="table-of-contents__link toc-highlight">Setting</a><li><a href=#string class="table-of-contents__link toc-highlight">String</a><li><a href=#backup class="table-of-contents__link toc-highlight">Backup</a><li><a href=#logging class="table-of-contents__link toc-highlight">Logging</a><li><a href=#multimedia class="table-of-contents__link toc-highlight">Multimedia</a></ul><li><a href=#deprecated-or-handled-by-the-core--app-resources-since-v2 class="table-of-contents__link toc-highlight">Deprecated Or Handled By The Core / App Resources Since V2</a><ul><li><a href=#permission class="table-of-contents__link toc-highlight">Permission</a><li><a href=#apt class="table-of-contents__link toc-highlight">Apt</a><li><a href=#systemuser class="table-of-contents__link toc-highlight">Systemuser</a></ul></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Legal</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/YunoHost/yunohost/blob/dev/LICENSE target=_blank rel="noopener noreferrer" class=footer__link-item>License<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a class=footer__link-item href=/doc/pr-2672/ru/community/terms_of_services>CGUs</a><li class=footer__item><a href=https://github.com/YunoHost/project-organization target=_blank rel="noopener noreferrer" class=footer__link-item>Organization<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Follow us</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://forum.yunohost.org/c/announcement/8/none target=_blank rel="noopener noreferrer" class=footer__link-item>Blog<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://toot.aquilenet.fr/@yunohost target=_blank rel="noopener noreferrer" class=footer__link-item>Mastodon<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href="https://videos.globenet.org/a/yunohost/videos?s=1" target=_blank rel="noopener noreferrer" class=footer__link-item>Peertube<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Use</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/doc/pr-2672/ru/>Documentation</a><li class=footer__item><a href=https://apps.yunohost.org/ target=_blank rel="noopener noreferrer" class=footer__link-item>Apps catalog<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://forum.yunohost.org/ target=_blank rel="noopener noreferrer" class=footer__link-item>Forum<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a class=footer__link-item href=/doc/pr-2672/ru/community/help>Ask for help</a><li class=footer__item><a href=https://status.yunohost.org/ target=_blank rel="noopener noreferrer" class=footer__link-item>Service status<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://github.com/YunoHost/yunohost/blob/dev/debian/changelog target=_blank rel="noopener noreferrer" class=footer__link-item>Changelog<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Contribute</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://donate.yunohost.org/ target=_blank rel="noopener noreferrer" class=footer__link-item>Donate<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://github.com/YunoHost/issues/issues target=_blank rel="noopener noreferrer" class=footer__link-item>Issues<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://github.com/YunoHost target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub (core)<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://github.com/YunoHost-Apps target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub (apps)<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://translate.yunohost.org/ target=_blank rel="noopener noreferrer" class=footer__link-item>Translate<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=margin-bottom--sm><img src=/doc/pr-2672/ru/img/icons/ynh_logo_roundcorner.png alt="Yunohost Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/doc/pr-2672/ru/img/icons/ynh_logo_roundcorner.png alt="Yunohost Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"/></div><div class=footer__copyright>Build with Docusaurus for YunoHost</div></div></div></footer></div></body>