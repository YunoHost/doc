"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([["1587"],{7942:function(e,s,n){n.r(s),n.d(s,{frontMatter:()=>d,toc:()=>o,default:()=>a,metadata:()=>r,assets:()=>c,contentTitle:()=>h});var r=JSON.parse('{"id":"packaging/scripts/helpers_v2.1","title":"App helpers (v2.1)","description":"Doc auto-generated by this script on 18/09/2025 (YunoHost version 12.1.25)","source":"@site/docs/packaging/20.scripts/20.helpers_v2.1.mdx","sourceDirName":"packaging/20.scripts","slug":"/packaging/scripts/helpers_v2.1","permalink":"/pr-2672/es/packaging/scripts/helpers_v2.1","draft":false,"unlisted":false,"editUrl":"https://github.com/YunoHost/doc/tree/main/docs/packaging/20.scripts/20.helpers_v2.1.mdx","tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"title":"App helpers (v2.1)","toc_max_heading_level":4},"sidebar":"devpackaging","previous":{"title":"App helpers (v2)","permalink":"/pr-2672/es/packaging/scripts/helpers_v2.0"},"next":{"title":"Documentation","permalink":"/pr-2672/es/packaging/doc"}}'),i=n(4848),l=n(4429);let d={title:"App helpers (v2.1)",toc_max_heading_level:4},h,c={},o=[{value:"Sources",id:"sources",level:2},{value:"Sources",id:"sources-1",level:3},{value:"Optional flags in the &#39;sources&#39; resource",id:"optional-flags-in-the-sources-resource",level:5},{value:"App Technologies",id:"app-technologies",level:2},{value:"Nodejs",id:"nodejs",level:3},{value:"Ruby",id:"ruby",level:3},{value:"Go",id:"go",level:3},{value:"Composer",id:"composer",level:3},{value:"Databases",id:"databases",level:2},{value:"Mysql",id:"mysql",level:3},{value:"Postgresql",id:"postgresql",level:3},{value:"Mongodb",id:"mongodb",level:3},{value:"Redis",id:"redis",level:3},{value:"Configurations / Templating",id:"configurations--templating",level:2},{value:"Templating",id:"templating",level:3},{value:"When --jinja is enabled",id:"when---jinja-is-enabled",level:5},{value:"Keeping track of manual changes by the admin",id:"keeping-track-of-manual-changes-by-the-admin",level:5},{value:"Nginx",id:"nginx",level:3},{value:"Php",id:"php",level:3},{value:"Systemd",id:"systemd",level:3},{value:"Fail2ban",id:"fail2ban",level:3},{value:"Regarding the the <code>failregex</code> option",id:"regarding-the-the-failregex-option",level:5},{value:"Logrotate",id:"logrotate",level:3},{value:"Misc Tools",id:"misc-tools",level:2},{value:"Utils",id:"utils",level:3},{value:"Setting",id:"setting",level:3},{value:"String",id:"string",level:3},{value:"Backup",id:"backup",level:3},{value:"Logging",id:"logging",level:3},{value:"Multimedia",id:"multimedia",level:3},{value:"Deprecated Or Handled By The Core / App Resources Since V2",id:"deprecated-or-handled-by-the-core--app-resources-since-v2",level:2},{value:"Permission",id:"permission",level:3},{value:"Apt",id:"apt",level:3},{value:"Systemuser",id:"systemuser",level:3}];function t(e){let s={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",h5:"h5",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components},{Details:n}=s;return n||function(e,s){throw Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.p,{children:["Doc auto-generated by ",(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/doc/blob/e1ce8661ec6f1f6597eeb5adc82e2ca367aafcad/scripts/helpers_doc_generate.py",children:"this script"})," on 18/09/2025 (YunoHost version 12.1.25)"]}),"\n",(0,i.jsx)(s.h2,{id:"sources",children:"Sources"}),"\n",(0,i.jsx)("p",{children:"This is coupled to the 'sources' resource in the manifest.toml"}),"\n",(0,i.jsx)(s.h3,{id:"sources-1",children:"Sources"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_setup_source"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Download, check integrity, uncompress and patch upstream sources"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_setup_source --dest_dir=dest_dir [--source_id=source_id] [--keep="file1 file2"] [--full_replace]'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--dest_dir="}),": Directory where to setup sources"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--source_id="}),": Name of the source, defaults to ",(0,i.jsx)(s.code,{children:"main"})," (when the sources resource exists in manifest.toml) or (legacy) ",(0,i.jsx)(s.code,{children:"app"})," otherwise"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--keep="}),": Space-separated list of files/folders that will be backup/restored in $dest_dir, such as a config file you don't want to overwrite. For example 'conf.json secrets.json logs' (no trailing ",(0,i.jsx)(s.code,{children:"/"})," for folders)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--full_replace="}),": Remove previous sources before installing new sources (can be 1 or 0, default to 0)"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThis helper will read infos from the 'sources' resources in the ",(0,i.jsx)(s.code,{children:"manifest.toml"})," of the app\nand expect a structure like:"]}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-toml",children:'[resources.sources]\n    [resources.sources.main]\n    url = "https://some.address.to/download/the/app/archive"\n    sha256 = "0123456789abcdef"    # The sha256 sum of the asset obtained from the URL\n'})}),(0,i.jsx)(s.p,{children:"(See also the resources documentation which may be more complete?)"}),(0,i.jsx)(s.h5,{id:"optional-flags-in-the-sources-resource",children:"Optional flags in the 'sources' resource"}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-text",children:'format    = "tar.gz"/xz/bz2/tar # automatically guessed from the extension of the URL, but can be set explicitly. Will use `tar` to extract\n            "zip"               # automatically guessed from the extension of the URL, but can be set explicitly. Will use `unzip` to extract\n            "docker"            # useful to extract files from an already-built docker image (instead of rebuilding them locally). Will use `docker-image-extract` to extract\n            "whatever"          # an arbitrary value, not really meaningful except to imply that the file won\'t be extracted\n\nin_subdir = true    # default, there\'s an intermediate subdir in the archive before accessing the actual files\n            false   # sources are directly in the archive root\n            n       # (special cases) an integer representing a number of subdirs levels to get rid of\n\nextract   = true    # default if file is indeed an archive such as .zip, .tar.gz, .tar.bz2, ...\n          = false   # default if file \'format\' is not set and the file is not to be extracted because it is not an archive but a script or binary or whatever asset.\n                    #    in which case the file will only be `mv`ed to the location possibly renamed using the `rename` value\n\nrename    = "whatever_your_want"   # to be used for convenience when `extract` is false and the default name of the file is not practical\nplatform  = "linux/amd64"          # (defaults to "linux/$YNH_ARCH") to be used in conjonction with `format = "docker"` to specify which architecture to extract for\n'})}),(0,i.jsx)(s.p,{children:"You may also define assets url and checksum per-architectures such as:"}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-toml",children:'[resources.sources]\n    [resources.sources.main]\n    amd64.url = "https://some.address.to/download/the/app/archive/when/amd64"\n    amd64.sha256 = "0123456789abcdef"\n    armhf.url = "https://some.address.to/download/the/app/archive/when/armhf"\n    armhf.sha256 = "fedcba9876543210"\n'})}),(0,i.jsxs)(s.p,{children:["In which case ",(0,i.jsx)(s.code,{children:'ynh_setup_source --dest_dir="$install_dir"'})," will automatically pick the appropriate source depending on the arch"]}),(0,i.jsx)(s.p,{children:"The helper will:"}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Download the specific URL if there is no local archive"}),"\n",(0,i.jsx)(s.li,{children:"Check the integrity with the specific sha256 sum"}),"\n",(0,i.jsxs)(s.li,{children:["Uncompress the archive to ",(0,i.jsx)(s.code,{children:"$dest_dir"}),".","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["If ",(0,i.jsx)(s.code,{children:"in_subdir"})," is true, the first level directory of the archive will be removed."]}),"\n",(0,i.jsxs)(s.li,{children:["If ",(0,i.jsx)(s.code,{children:"in_subdir"})," is a numeric value, the N first level directories will be removed."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["Patches named ",(0,i.jsx)(s.code,{children:"patches/${src_id}/*.patch"})," will be applied to ",(0,i.jsx)(s.code,{children:"$dest_dir"})]}),"\n",(0,i.jsx)(s.li,{children:"Apply sane default permissions (see _ynh_apply_default_permissions)"}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/sources#L83",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"app-technologies",children:"App Technologies"}),"\n",(0,i.jsx)("p",{children:"These allow to install specific version of the technology required to run some apps"}),"\n",(0,i.jsx)(s.h3,{id:"nodejs",children:"Nodejs"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_nodejs_install"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Install a specific version of nodejs, using 'n'"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_nodejs_install"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThe installed version is defined by ",(0,i.jsx)(s.code,{children:"$nodejs_version"})," which should be defined as global prior to calling this helper"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"n"})," (Node version management) uses the ",(0,i.jsx)(s.code,{children:"PATH"})," variable to store the path of the version of node it is going to use.\nThat's how it changes the version"]}),(0,i.jsxs)(s.p,{children:["The helper adds the appropriate, specific version of nodejs to the ",(0,i.jsx)(s.code,{children:"$PATH"})," variable (which\nis preserved when calling ynh_exec_as_app). Also defines:"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"$path_with_nodejs"})," to be used in the systemd config (",(0,i.jsx)(s.code,{children:'Environment="PATH=__PATH_WITH_NODEJS__"'}),")"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"$nodejs_dir"}),", the directory containing the specific version of nodejs, which may be used in the systemd config too (e.g. ",(0,i.jsx)(s.code,{children:"ExecStart=__NODEJS_DIR__/node foo bar"}),")"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/nodejs#L72",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_nodejs_remove"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove the version of node used by the app."})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_nodejs_remove"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThis helper will check if another app uses the same version of node."]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"If not, this version of node will be removed."}),"\n",(0,i.jsx)(s.li,{children:"If no other app uses node, n will be also removed."}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/nodejs#L106",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"ruby",children:"Ruby"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_ruby_install"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Install a specific version of Ruby using rbenv"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_ruby_install"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThe installed version is defined by ",(0,i.jsx)(s.code,{children:"$ruby_version"})," which should be defined as global prior to calling this helper"]}),(0,i.jsxs)(s.p,{children:["The helper adds the appropriate, specific version of ruby to the ",(0,i.jsx)(s.code,{children:"$PATH"})," variable (which\nis preserved when calling ynh_exec_as_app). Also defines:"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"$path_with_ruby"})," to be used in the systemd config (",(0,i.jsx)(s.code,{children:'Environment="PATH=__PATH_WITH_RUBY__"'}),")"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"$ruby_dir"}),", the directory containing the specific version of ruby, which may be used in the systemd config too (e.g. ",(0,i.jsx)(s.code,{children:"ExecStart=__RUBY_DIR__/ruby foo bar"}),")"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/ruby#L68",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_ruby_remove"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove the version of Ruby used by the app."})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_ruby_remove"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThis helper will also cleanup unused Ruby versions"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/ruby#L110",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"go",children:"Go"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_go_install"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Install a specific version of Go using goenv"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_go_install"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThe installed version is defined by ",(0,i.jsx)(s.code,{children:"$go_version"})," which should be defined as global prior to calling this helper"]}),(0,i.jsxs)(s.p,{children:["The helper adds the appropriate, specific version of go to the ",(0,i.jsx)(s.code,{children:"$PATH"})," variable (which\nis preserved when calling ",(0,i.jsx)(s.code,{children:"ynh_exec_as_app"}),"). Also defines:"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"$path_with_go"})," (the value of the modified ",(0,i.jsx)(s.code,{children:"$PATH"}),", but you dont really need it?)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"$go_dir"})," (the directory containing the specific go version)"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/go#L68",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_go_remove"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove the version of Go used by the app."})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_go_remove"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThis helper will also cleanup Go versions"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/go#L99",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"composer",children:"Composer"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_composer_install"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Install and initialize Composer in the given directory"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_composer_install"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThe installed version is defined by ",(0,i.jsx)(s.code,{children:"$composer_version"})," which should be defined\nas global prior to calling this helper."]}),(0,i.jsxs)(s.p,{children:["Will use ",(0,i.jsx)(s.code,{children:"$install_dir"})," as workdir unless ",(0,i.jsx)(s.code,{children:"$composer_workdir"})," exists (but that shouldnt be necessary)"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/composer#L29",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_composer_exec"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Execute a command with Composer"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_composer_exec commands"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nWill use ",(0,i.jsx)(s.code,{children:"$install_dir"})," as workdir unless ",(0,i.jsx)(s.code,{children:"$composer_workdir"})," exists (but that shouldnt be necessary)"]}),(0,i.jsxs)(s.p,{children:["You may also define ",(0,i.jsx)(s.code,{children:"composer_user=root"})," prior to call this helper if you\nabsolutely need composer to run as root, but this is discouraged..."]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/composer#L55",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"databases",children:"Databases"}),"\n",(0,i.jsx)("p",{children:"This is coupled to the 'database' resource in the manifest.toml - at least for mysql/postgresql. Mongodb/redis may have better integration in the future."}),"\n",(0,i.jsx)(s.h3,{id:"mysql",children:"Mysql"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_mysql_db_shell"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Run SQL instructions in a database ($db_name by default)"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_mysql_db_shell [database] <<< "instructions"'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"database="}),": the database to connect to (by default, $db_name)"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Examples"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:'ynh_mysql_db_shell $db_name <<< "UPDATE ...;"'})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"ynh_mysql_db_shell < /path/to/file.sql"})}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mysql#L30",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_mysql_dump_db"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Dump a database"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_mysql_dump_db database"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"database"}),": the database name to dump (by default, $db_name)"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns"}),": The mysqldump output"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:'ynh_mysql_dump_db "roundcube" > ./dump.sql'})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mysql#L92",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"postgresql",children:"Postgresql"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_psql_db_shell"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Run SQL instructions in a database ($db_name by default)"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_psql_db_shell database <<< "instructions"'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"database"}),": the database to connect to (by default, $db_name)"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Examples"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:'ynh_psql_db_shell $db_name <<< "UPDATE ...;"'})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"ynh_psql_db_shell < /path/to/file.sql"})}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/postgresql#L34",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_psql_dump_db"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Dump a database"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_psql_dump_db database"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"database"}),": the database name to dump (by default, $db_name)"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns"}),": the psqldump output"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:"ynh_psql_dump_db 'roundcube' > ./dump.sql"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/postgresql#L89",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"mongodb",children:"Mongodb"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_mongo_exec"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Execute a mongo command"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_mongo_exec [--database=database] --command="command"'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--database="}),": The database to connect to"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--command="}),": The command to evaluate"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:'ynh_mongo_exec --command=\'db.getMongo().getDBNames().indexOf("wekan")\' example: ynh_mongo_exec --command="db.getMongo().getDBNames().indexOf(\\"wekan\\")"'})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L31",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_mongo_dump_db"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Dump a database"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_mongo_dump_db --database=database"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--database="}),": The database name to dump"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns"}),": the mongodump output"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:"ynh_mongo_dump_db --database=wekan > ./dump.bson"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L81",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_mongo_database_exists"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Check if a mongo database exists"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_mongo_database_exists --database=database | exit: Return 1 if the database doesn't exist, 0 otherwise"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--database="}),": The database for which to check existence"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L124",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_mongo_restore_db"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Restore a database"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_mongo_restore_db --database=database"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--database="}),": The database name to restore"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:"ynh_mongo_restore_db --database=wekan < ./dump.bson"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L146",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_mongo_setup_db"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Create a database, an user and its password. Then store the password in the app's config"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_mongo_setup_db --db_user=user --db_name=name [--db_pwd=pwd]"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--db_user="}),": Owner of the database"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--db_name="}),": Name of the database"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--db_pwd="}),": Password of the database. If not provided, a password will be generated"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),':\nAfter executing this helper, the password of the created database will be available in $db_pwd\nIt will also be stored as "mongopwd" into the app settings.']}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L187",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_mongo_remove_db"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove a database if it exists, and the associated user"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_mongo_remove_db --db_user=user --db_name=name"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--db_user="}),": Owner of the database"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--db_name="}),": Name of the database"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L214",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_install_mongo"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Install MongoDB and integrate MongoDB service in YunoHost"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_install_mongo"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThe installed version is defined by $mongo_version which should be defined as global prior to calling this helper"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L238",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_remove_mongo"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove MongoDB\nOnly remove the MongoDB service integration in YunoHost for now\nif MongoDB package as been removed"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_remove_mongo"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/mongodb#L279",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"redis",children:"Redis"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_redis_get_free_db"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"get the first available redis database"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_redis_get_free_db"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns"}),": the database number to use"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/redis#L25",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_redis_remove_db"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Erase a redis database so it can be reused by other apps."})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_redis_remove_db database"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"database"}),": the database to erase"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/redis#L51",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"configurations--templating",children:"Configurations / Templating"}),"\n",(0,i.jsx)(s.h3,{id:"templating",children:"Templating"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_config_add"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Create a dedicated config file from a template"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_config_add --template="template" --destination="destination"'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--template="}),": Template config file to use"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--destination="}),": Destination of the config file"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--jinja"}),": Use jinja template instead of the simple ",(0,i.jsx)(s.code,{children:"__MY_VAR__"})," templating format"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Examples"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:'ynh_config_add --template=".env" --destination="$install_dir/.env"   # (use the template file "conf/.env" from the app\'s package)'})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:'ynh_config_add --jinja --template="config.j2" --destination="$install_dir/config"    # (use the template file "conf/config.j2" from the app\'s package)'})}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThe template can be 1) the name of a file in the ",(0,i.jsx)(s.code,{children:"conf"})," directory of\nthe app, 2) a relative path or 3) an absolute path."]}),(0,i.jsxs)(s.p,{children:["This applies a simple templating format which covers a good 95% of cases,\nwhere patterns like ",(0,i.jsx)(s.code,{children:"__FOO__"})," are replaced by the bash variable ",(0,i.jsx)(s.code,{children:"$foo"}),", for example:\n",(0,i.jsx)(s.code,{children:"__DOMAIN__"}),"   by ",(0,i.jsx)(s.code,{children:"$domain"}),"\n",(0,i.jsx)(s.code,{children:"__PATH__"}),"     by ",(0,i.jsx)(s.code,{children:"$path"}),"\n",(0,i.jsx)(s.code,{children:"__APP__"}),"      by ",(0,i.jsx)(s.code,{children:"$app"}),"\n",(0,i.jsx)(s.code,{children:"__VAR_1__"}),"    by ",(0,i.jsx)(s.code,{children:"$var_1"}),"\n",(0,i.jsx)(s.code,{children:"__VAR_2__"}),"    by ",(0,i.jsx)(s.code,{children:"$var_2"})]}),(0,i.jsxs)(s.p,{children:["Special case for ",(0,i.jsx)(s.code,{children:"__PATH__/"})," which is replaced by ",(0,i.jsx)(s.code,{children:"/"})," instead of ",(0,i.jsx)(s.code,{children:"//"})," if ",(0,i.jsx)(s.code,{children:"$path"})," is ",(0,i.jsx)(s.code,{children:"/"})]}),(0,i.jsx)(s.h5,{id:"when---jinja-is-enabled",children:"When --jinja is enabled"}),(0,i.jsx)(s.p,{children:'This option is meant for advanced use-cases where the "simple" templating\nmode ain\'t enough because you need conditional blocks or loops.'}),(0,i.jsxs)(s.p,{children:["For a full documentation of jinja's syntax you can refer to ",(0,i.jsx)(s.a,{href:"https://jinja.palletsprojects.com/en/3.1.x/templates/",children:"the official Jinja documentation"}),"."]}),(0,i.jsx)(s.p,{children:"Note that in YunoHost context, all variables are from shell variables and therefore are strings\nTo help handling complex data Jinja engine are executed with theses additional filters:"}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"from_json: load a string as Json and return an object"}),"\n",(0,i.jsx)(s.li,{children:"from_yaml: load a string as Yaml and return an object"}),"\n",(0,i.jsx)(s.li,{children:"from_toml: load a string as Toml and return an object"}),"\n",(0,i.jsx)(s.li,{children:"to_json: serialize to string an object to Json"}),"\n",(0,i.jsx)(s.li,{children:"to_yaml: serialize to string an object to Yaml"}),"\n",(0,i.jsx)(s.li,{children:"to_toml: serialize to string an object to Toml"}),"\n"]}),(0,i.jsxs)(s.p,{children:["So by example, if you want to convert a json string ",(0,i.jsx)(s.code,{children:"$my_json"})," to Toml, you can to this way:\n",(0,i.jsx)(s.code,{children:"{{ my_json | from_json | to_toml }}"}),"\nOr you can iterate on a Json list ",(0,i.jsx)(s.code,{children:'my_list=\'["a", "b", "c"]\''})," this way:"]}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"{% for i in my_list | from_json %}\n value {{ i }}\n{% endfor }}\n"})}),(0,i.jsx)(s.p,{children:"which will result:"}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"value a\nvalue b\nvalue c\n"})}),(0,i.jsx)(s.h5,{id:"keeping-track-of-manual-changes-by-the-admin",children:"Keeping track of manual changes by the admin"}),(0,i.jsx)(s.p,{children:"The helper will verify the checksum and backup the destination file\nif it's different before applying the new template."}),(0,i.jsx)(s.p,{children:"And it will calculate and store the destination file checksum\ninto the app settings when configuration is done."}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/templating#L84",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_read_var_in_file"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Get a value from heterogeneous file (yaml, json, php, python...)"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_read_var_in_file --file=PATH --key=KEY"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--file="}),": the path to the file"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--key="}),": the key to get"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--after="}),": the line just before the key (in case of multiple lines with the name of the key in the file)"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThis helpers match several var affectation use case in several languages\nWe don't use jq or equivalent to keep comments and blank space in files\nThis helpers work line by line, it is not able to work correctly\nif you have several identical keys in your files"]}),(0,i.jsx)(s.p,{children:"Example of line this helpers can managed correctly"}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-text",children:'.yml\n    title: YunoHost documentation\n    email: \'yunohost@yunohost.org\'\n.json\n    "theme": "colib\'ris",\n    "port": 8102\n    "some_boolean":     false,\n    "user": null\n.ini\n    some_boolean = On\n    action = "Clear"\n    port = 20\n.php\n    $user=\n    user => 20\n.py\n    USER = 8102\n    user = \'https://donate.local\'\n    CUSTOM[\'user\'] = \'YunoHost\'\n'})}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/templating#L219",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_write_var_in_file"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Set a value into heterogeneous file (yaml, json, php, python...)"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_write_var_in_file --file=PATH --key=KEY --value=VALUE"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--file="}),": the path to the file"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--key="}),": the key to set"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--value="}),": the value to set"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--after="}),": the line just before the key (in case of multiple lines with the name of the key in the file)"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/templating#L294",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"nginx",children:"Nginx"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_config_add_nginx"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Create a dedicated nginx config"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_config_add_nginx"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThis will use a template in ",(0,i.jsx)(s.code,{children:"../conf/nginx.conf"}),"\nSee the documentation of ",(0,i.jsx)(s.code,{children:"ynh_config_add"})," for a description of the template\nformat and how placeholders are replaced with actual variables."]}),(0,i.jsx)(s.p,{children:"Additionally, ynh_config_add_nginx will replace:"}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"#sub_path_only"}),"      by empty string if ",(0,i.jsx)(s.code,{children:"path"})," is not ",(0,i.jsx)(s.code,{children:"'/'"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"#root_path_only"}),"     by empty string if ",(0,i.jsx)(s.code,{children:"path"}),"  ",(0,i.jsx)(s.em,{children:"is"}),"  ",(0,i.jsx)(s.code,{children:"'/'"})]}),"\n"]}),(0,i.jsx)(s.p,{children:"This allows to enable/disable specific behaviors dependenging on the install\nlocation"}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/nginx#L36",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_config_remove_nginx"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove the dedicated nginx config"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_config_remove_nginx"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/nginx#L61",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_config_change_url_nginx"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Regen the nginx config in a change url context"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_config_change_url_nginx"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/nginx#L69",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"php",children:"Php"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_config_add_phpfpm"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Create a dedicated PHP-FPM config"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_config_add_phpfpm"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThis will automatically generate an appropriate PHP-FPM configuration for this app."]}),(0,i.jsxs)(s.p,{children:["The resulting configuration will be deployed to the appropriate place:\n",(0,i.jsx)(s.code,{children:"/etc/php/$php_version/fpm/pool.d/$app.conf"})]}),(0,i.jsxs)(s.p,{children:["If the app provides a ",(0,i.jsx)(s.code,{children:"conf/extra_php-fpm.conf"})," template, it will be appended\nto the generated configuration. (In the vast majority of cases, this shouldnt\nbe necessary)"]}),(0,i.jsxs)(s.p,{children:["$php_version should be defined prior to calling this helper, but there should\nbe no reason to manually set it, as it is automatically set by the apt\nhelpers/resources when installing phpX.Y dependencies (PHP apps should at\nleast install phpX.Y-fpm using the ",(0,i.jsx)(s.code,{children:"apt"})," helper/resource)"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"$php_group"})," can be defined as a global (from ",(0,i.jsx)(s.code,{children:"_common.sh"}),") if the worker\nprocesses should run with a different group than ",(0,i.jsx)(s.code,{children:"$app"})]}),(0,i.jsx)(s.p,{children:'Additional "pm" and "php_admin_value" settings which are meant to be possibly\nconfigurable by admins from a future standard config panel at some point,\nrelated to performance and availability of the app, for which tweaking may be\nrequired if the app is used by "plenty" of users and other memory/CPU load\nconsiderations....'}),(0,i.jsxs)(s.p,{children:["If you have good reasons to be willing to use different\ndefaults than the one set by this helper (while still allowing admin to\noverride it) you should use ",(0,i.jsx)(s.code,{children:"ynh_app_setting_set_default"})]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"$php_upload_max_filezise"}),": corresponds upload_max_filesize and post_max_size. Defaults to 50M"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"$php_process_management"}),': corresponds to "pm" (ondemand, dynamic, static). Defaults to ondemand']}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"$php_max_children"}),': by default, computed from "total RAM" divided by 40, cf ',(0,i.jsx)(s.code,{children:"_default_php_max_children"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"$php_memory_limit"}),": by default, 128M (from global php.ini)"]}),"\n"]}),(0,i.jsx)(s.p,{children:'Note that if $php_process_management is set to "dynamic", then these\nvariables MUST be defined prior to calling the helper (no default value) ...\nCheck PHP-FPM\'s manual for more info on what these are (: ...'}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"$php_start_servers"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"$php_min_spare_servers"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"$php_max_spare_servers"})}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/php#L68",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_config_remove_phpfpm"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove the dedicated PHP-FPM config"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_config_remove_phpfpm"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/php#L144",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"systemd",children:"Systemd"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_config_add_systemd"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Create a dedicated systemd config"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_config_add_systemd [--service=service] [--template=template]"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--service="}),": Service name (optionnal, ",(0,i.jsx)(s.code,{children:"$app"})," by default)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--template="}),": Name of template file (optionnal, this is 'systemd' by default, meaning ",(0,i.jsx)(s.code,{children:"../conf/systemd.service"})," will be used as template)"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThis will use the template ",(0,i.jsx)(s.code,{children:"../conf/<templatename>.service"}),"."]}),(0,i.jsxs)(s.p,{children:["See the documentation of ",(0,i.jsx)(s.code,{children:"ynh_config_add"})," for a description of the template\nformat and how placeholders are replaced with actual variables."]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemd#L31",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_config_remove_systemd"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove the dedicated systemd config"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_config_remove_systemd service"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"service"}),": Service name (optionnal, $app by default)"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemd#L51",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_systemctl"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Start (or other actions) a service,  print a log in case of failure and optionnaly wait until the service is completely started"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_systemctl [--service=service] [--action=action] [ [--wait_until="line to match"] [--log_path=log_path] [--timeout=300] [--length=20] ]'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--service="}),": Name of the service to start. Default : ",(0,i.jsx)(s.code,{children:"$app"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--action="}),": Action to perform with systemctl. Default: start"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--wait_until="}),": The pattern to find in the log to attest the service is effectively fully started."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--log_path="}),": Log file - Path to the log file. Default : ",(0,i.jsx)(s.code,{children:"/var/log/$app/$app.log"}),"; ",(0,i.jsx)(s.code,{children:"systemd"})," to listen on ",(0,i.jsx)(s.code,{children:"journalctl --unit=$service"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--timeout="}),": Timeout - The maximum time to wait before ending the watching. Default : 60 seconds."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--length="}),": Length of the error log displayed for debugging : Default : 20"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemd#L70",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"fail2ban",children:"Fail2ban"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_config_add_fail2ban"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Create a dedicated fail2ban config (jail and filter conf files)"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_config_add_fail2ban --logpath=log_file --failregex=filter"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--logpath="}),": Log file to be checked by fail2ban"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--failregex="}),": Failregex to be looked for by fail2ban"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nIf --logpath / --failregex are provided, the helper will generate the appropriate conf using these."]}),(0,i.jsxs)(s.p,{children:["Otherwise, it will assume that the app provided templates, namely\n",(0,i.jsx)(s.code,{children:"../conf/f2b_jail.conf"})," and ",(0,i.jsx)(s.code,{children:"../conf/f2b_filter.conf"})]}),(0,i.jsx)(s.p,{children:"They will typically look like (for example here for synapse):"}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-toml",children:"f2b_jail.conf:\n    [__APP__]\n    enabled = true\n    port = http,https\n    filter = __APP__\n    logpath = /var/log/__APP__/logfile.log\n    maxretry = 5\n"})}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-toml",children:"f2b_filter.conf:\n    [INCLUDES]\n    before = common.conf\n    [Definition]\n\n# Part of regex definition (just used to make more easy to make the global regex)\n    __synapse_start_line = .? \\- synapse\\..+ \\-\n\n# Regex definition.\n   failregex = ^%(__synapse_start_line)s INFO \\- POST\\-(\\d+)\\- <HOST> \\- \\d+ \\- Received request\\: POST /_matrix/client/r0/login\\??<SKIPLINES>%(__synapse_start_line)s INFO \\- POST\\-\\1\\- Got login request with identifier: \\{u'type': u'm.id.user', u'user'\\: u'(.+?)'\\}, medium\\: None, address: None, user\\: u'\\5'<SKIPLINES>%(__synapse_start_line)s WARNING \\- \\- (Attempted to login as @\\5\\:.+ but they do not exist|Failed password login for user @\\5\\:.+)$\n\nignoreregex =\n"})}),(0,i.jsxs)(s.h5,{id:"regarding-the-the-failregex-option",children:["Regarding the the ",(0,i.jsx)(s.code,{children:"failregex"})," option"]}),(0,i.jsxs)(s.p,{children:['regex to match the password failure messages in the logfile. The host must be\nmatched by a group named "',(0,i.jsx)(s.code,{children:"host"}),'". The tag "',(0,i.jsx)(s.code,{children:"<HOST>"}),'" can be used for standard\nIP/hostname matching and is only an alias for ',(0,i.jsx)(s.code,{children:"(?:::f{4,6}:)?(?P<host>[\\w\\-.^_]+)"})]}),(0,i.jsxs)(s.p,{children:["You can find some more explainations about how to make a regex on ",(0,i.jsx)(s.a,{href:"https://www.fail2ban.org/wiki/index.php/MANUAL_0_8#Filters",children:"the official fail2ban documentation"}),"."]}),(0,i.jsx)(s.p,{children:"To validate your regex you can test with this command:"}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"fail2ban-regex /var/log/YOUR_LOG_FILE_PATH /etc/fail2ban/filter.d/YOUR_APP.conf\n"})}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/fail2ban#L72",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_config_remove_fail2ban"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove the dedicated fail2ban config (jail and filter conf files)"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_config_remove_fail2ban"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/fail2ban#L134",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"logrotate",children:"Logrotate"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_config_add_logrotate"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Add a logrotate configuration to manage log files / log directory"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_config_add_logrotate [/path/to/log/file/or/folder]"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nIf not argument is provided, ",(0,i.jsx)(s.code,{children:"/var/log/$app/*.log"})," is used as default."]}),(0,i.jsx)(s.p,{children:"The configuration is autogenerated by YunoHost\n(ie it doesnt come from a specific app template like nginx or systemd conf)"}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logrotate#L31",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_config_remove_logrotate"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove the app's logrotate config."})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ``"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logrotate#L87",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"misc-tools",children:"Misc Tools"}),"\n",(0,i.jsx)(s.h3,{id:"utils",children:"Utils"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_exec_as_app"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Execute a command after sudoing as $app"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_exec_as_app COMMAND [ARG ...]"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nNote that the $PATH variable is preserved (using env PATH=$PATH)"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L76",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_local_curl"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Curl abstraction to help with POST requests to local pages (such as installation forms)"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_local_curl "page_uri" "key1=value1" "key2=value2" ...'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"page_uri"}),": Path (relative to ",(0,i.jsx)(s.code,{children:"$path"}),") of the page where POST data will be sent"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"key1=value1"}),": (Optionnal) POST key and corresponding value"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"key2=value2"}),": (Optionnal) Another POST key and corresponding value"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"..."}),": (Optionnal) More POST keys and values"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:'ynh_local_curl "/install.php?installButton" "foo=$var1" "bar=$var2"'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nFor multiple calls, cookies are persisted between each call for the same app"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"$domain"})," and ",(0,i.jsx)(s.code,{children:"$path"})," should be defined externally (and correspond to the domain.tld and the /path (of the app?))"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L93",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_safe_rm"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove a file or a directory, checking beforehand that it's not a disastrous location to rm such as entire /var or /home"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_safe_rm path_to_remove"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L162",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_read_manifest"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Read the value of a key in the app's manifest"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_read_manifest "key"'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"key"}),": Name of the key to find"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns"}),": the value associate to that key"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L188",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_app_upstream_version"}),(0,i.jsx)("br",{}),(0,i.jsxs)("i",{children:["Return the app upstream version, deduced from ",(0,i.jsx)(s.code,{children:"$YNH_APP_MANIFEST_VERSION"})," and strippig the ",(0,i.jsx)(s.code,{children:"~ynhX"})," part"]})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_app_upstream_version"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns"}),": the version number of the upstream app"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nFor example, if the manifest contains ",(0,i.jsx)(s.code,{children:"4.3-2~ynh3"})," the function will return ",(0,i.jsx)(s.code,{children:"4.3-2"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L198",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_app_upstream_version_changed"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:'Return 0 if the "upstream" part of the version changed, or 1 otherwise (ie only the ~ynh suffix changed)'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"if ynh_app_upstream_version_changed; then ..."})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L205",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_app_upgrading_from_version_before"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Compare the current package version is strictly lower than another version given as an argument"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ``"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:"if ynh_app_upgrading_from_version_before 2.3.2~ynh1; then ..."})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L213",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_app_upgrading_from_version_before_or_equal_to"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Compare the current package version is lower or equal to another version given as an argument"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ``"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:"if ynh_app_upgrading_from_version_before_or_equal_to 2.3.2~ynh1; then ..."})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L223",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_validate_ip"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Validate an IP address"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_validate_ip --family=family --ip_address=ip_address"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns"}),": 0 for valid ip addresses, 1 otherwise"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:"ynh_validate_ip 4 111.222.333.444"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L303",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_in_ci_tests"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Check if the scripts are being run by the package_check in CI"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_in_ci_tests"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nReturn 0 if in CI, 1 otherwise"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L367",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_user_get_info"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Retrieve a YunoHost user information"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_user_get_info --username=username --key=key"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--username="}),": the username to retrieve info from"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--key="}),": the key to retrieve"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns"}),": the value associate to that key"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:'mail=$(ynh_user_get_info --username="toto" --key=mail)'})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L379",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_user_list"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Get the list of YunoHost users"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_user_list"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns"}),": one username per line as strings"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:"for u in $(ynh_user_list); do ... ; done"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L396",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_spawn_app_shell"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Spawn a Bash shell with the app environment loaded"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_spawn_app_shell"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Examples"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"ynh_spawn_app_shell <<< 'echo \"$USER\"'"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"ynh_spawn_app_shell < /tmp/some_script.bash"})}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThe spawned shell will have environment variables loaded and environment files sourced\nfrom the app's service configuration file (defaults to $app.service, overridable by the packager with ",(0,i.jsx)(s.code,{children:"service"})," setting).\nIf the app relies on a specific PHP version, then ",(0,i.jsx)(s.code,{children:"php"})," will be aliased that version. The PHP command will also be appended with the ",(0,i.jsx)(s.code,{children:"phpflags"})," settings."]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L411",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_add_swap"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Add swap"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_add_swap --size=SWAP in Mb"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"-s"}),", ",(0,i.jsx)(s.code,{children:"--size="}),": Amount of SWAP to add in Mb."]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L479",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_smart_mktemp"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Check available space before creating a temp directory."})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_smart_mktemp --min_size="Min size"'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"-s"}),", ",(0,i.jsx)(s.code,{children:"--min_size="}),": Minimal size needed for the temporary directory, in Mb"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/0-utils#L579",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"setting",children:"Setting"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_app_setting_get"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Get an application setting"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_app_setting_get --key=key"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--app="}),": the application id (global $app by default)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--key="}),": the setting to get"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/setting#L26",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_app_setting_set"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Set an application setting"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_app_setting_set --key=key --value=value"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--app="}),": the application id (global $app by default)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--key="}),": the setting name to set"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--value="}),": the setting value to set"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nWhen choosing the setting key's name, note that including the following keywords will make the associated setting's value appear masked in the debug logs (cf. ",(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/216210d5e97070b85c96ebb4548c6abf36987771/src/log.py#L571",children:"related code"}),"): ",(0,i.jsx)(s.code,{children:"pwd"}),", ",(0,i.jsx)(s.code,{children:"pass"}),", ",(0,i.jsx)(s.code,{children:"passwd"}),", ",(0,i.jsx)(s.code,{children:"password"}),", ",(0,i.jsx)(s.code,{children:"passphrase"}),", ",(0,i.jsx)(s.code,{children:"secret\\w*"})," (regex),  ",(0,i.jsx)(s.code,{children:"\\w+key"})," (regex), ",(0,i.jsx)(s.code,{children:"token"}),", ",(0,i.jsx)(s.code,{children:"PASSPHRASE"}),"\nThis is meant to allow sharing the logs while preserving confidential data, but having this in mind is useful would you expect to see those values while debugging your scripts."]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/setting#L48",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_app_setting_set_default"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:'Set an application setting but only if the "$key" variable ain\'t set yet'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_app_setting_set_default --key=key --value=value"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--app="}),": the application id (global $app by default)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--key="}),": the setting name to set"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--value="}),": the default setting value to set"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nNote that it doesn't just define the setting but ALSO define the $foobar variable"]}),(0,i.jsx)(s.p,{children:"Hence it's meant as a replacement for this legacy overly complex syntax:"}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'if [ -z "${foo:-}" ]\nthen\n    foo="bar"\n    ynh_app_setting_set --key="foo" --value="$foo"\nfi\n'})}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/setting#L80",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_app_setting_delete"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Delete an application setting"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_app_setting_delete --key=key"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--app="}),": the application id (global $app by default)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--key="}),": the setting to delete"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/setting#L102",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"string",children:"String"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_string_random"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Generate a random string"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_string_random [--length=string_length]"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--length="}),": the string length to generate (default: 24)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--filter="}),": the kind of characters accepted in the output (default: 'A-Za-z0-9')"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns"}),": the generated string"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:"pwd=$(ynh_string_random --length=8)"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/string#L29",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_replace"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Substitute/replace a string (or expression) by another in a file"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_replace --match=match --replace=replace --file=file"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--match="}),": String to be searched and replaced in the file"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--replace="}),": String that will replace matches"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--file="}),": File in which the string will be replaced."]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nAs this helper is based on sed command, regular expressions and references to\nsub-expressions can be used (see sed manual page for more information)"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/string#L51",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_replace_regex"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Substitute/replace a regex in a file"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_replace_regex --match=match --replace=replace --file=file"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--match="}),": String to be searched and replaced in the file"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--replace="}),": String that will replace matches"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--file="}),": File in which the string will be replaced."]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThis helper will use ynh_replace, but as you can use special\ncharacters, you can't use some regular expressions and sub-expressions."]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/string#L79",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_normalize_url_path"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Normalize the url path syntax"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_normalize_url_path path_to_normalize"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Examples"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"url_path=$(ynh_normalize_url_path $url_path)"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"ynh_normalize_url_path example    # -> /example"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"ynh_normalize_url_path /example   # -> /example"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"ynh_normalize_url_path /example/  # -> /example"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"ynh_normalize_url_path /          # -> /"})}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nHandle the slash at the beginning of path and its absence at ending\nReturn a normalized url path"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/string#L134",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"backup",children:"Backup"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_backup"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Add a file or a directory to the list of paths to backup"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_backup /path/to/stuff"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nNB : note that this helper does ",(0,i.jsx)(s.em,{children:"NOT"})," perform any copy in itself, it only\ndeclares stuff to be backuped via a CSV which is later picked up by the core"]}),(0,i.jsxs)(s.p,{children:["NB 2 : there is a specific behavior for $data_dir (or childs of $data_dir) and\n/var/log/$app which are ",(0,i.jsx)(s.em,{children:"NOT"}),' backedup during safety-backup-before-upgrade,\nOR if the setting "do_not_backup_data" is equals 1 for that app']}),(0,i.jsx)(s.p,{children:"The rationale is that these directories are usually too heavy to be integrated in every backup\n(think for example about Nextcloud with quite a lot of data, or an app with a lot of media files...)"}),(0,i.jsx)(s.p,{children:"This is coupled to the fact that $data_dir and the log dir won't be (and\nshould NOT) be deleted during remove, unless --purge is used. Hence, if the\nupgrade fails and the script is removed prior to restoring the backup, the\ndata/logs are not destroyed."}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/backup#L42",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_restore"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Restore a file or a directory from the backup archive"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_restore /path/to/stuff"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Examples"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:'ynh_restore "/etc/nginx/conf.d/$domain.d/$app.conf"'})}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nIf the file or dir to be restored already exists on the system and is lighter\nthan 500 Mo, it is backed up in ",(0,i.jsx)(s.code,{children:"/var/cache/yunohost/appconfbackup/"}),".\nOtherwise, the existing file or dir is removed."]}),(0,i.jsxs)(s.p,{children:["if ",(0,i.jsx)(s.code,{children:"apps/$app/etc/nginx/conf.d/$domain.d/$app.conf"})," exists, restore it into\n",(0,i.jsx)(s.code,{children:"/etc/nginx/conf.d/$domain.d/$app.conf"}),"\notheriwse, search for a match in the csv (eg: conf/nginx.conf) and restore it into\n",(0,i.jsx)(s.code,{children:"/etc/nginx/conf.d/$domain.d/$app.conf"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/backup#L147",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_restore_everything"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Restore all files that were previously backuped in an app backup script"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_restore_everything"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/backup#L204",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_store_file_checksum"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Calculate and store a file checksum into the app settings"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_store_file_checksum /path/to/file"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/backup#L226",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_backup_if_checksum_is_different"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Verify the checksum and backup the file if it's different"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_backup_if_checksum_is_different /path/to/file"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nThis helper is primarily meant to allow to easily backup personalised/manually\nmodified config files."]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/backup#L257",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_delete_file_checksum"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Delete a file checksum from the app settings"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_delete_file_checksum /path/to/file"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/backup#L287",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"logging",children:"Logging"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_die"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Print a message to stderr and terminate the current script"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_die "Some message"'})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L24",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_print_info"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:'Print an "INFO" message'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_print_info "Some message"'})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L38",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_print_warn"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Print a warning on stderr"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_print_warn "Some message"'})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L45",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_hide_warnings"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Execute a command and redirect stderr to stdout"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_hide_warnings your command and args"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"command"}),": command to execute"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L54",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_exec_and_print_stderr_only_if_error"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Execute a command and redirect stderr in /dev/null. Print stderr on error."})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_exec_and_print_stderr_only_if_error your command and args"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"command"}),": command to execute"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nNote that you should NOT quote the command but only prefix it with ynh_exec_and_print_stderr_only_if_error"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L65",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_return"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Return data to the YunoHost core for later processing (to be used by special hooks like app config panel and core diagnosis)"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_return somedata"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L80",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_script_progression"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Print a progress bar showing the progression of an app script"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_script_progression "Some message"'})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/logging#L98",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"multimedia",children:"Multimedia"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_multimedia_build_main_dir"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Initialize the multimedia directory system"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_multimedia_build_main_dir"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/multimedia#L27",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_multimedia_addfolder"}),(0,i.jsx)("br",{}),(0,i.jsxs)("i",{children:["Add a directory in ",(0,i.jsx)(s.code,{children:"yunohost.multimedia"})]})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_multimedia_addfolder --source_dir="source_dir" --dest_dir="dest_dir"'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--source_dir="}),": Source directory - The real directory which contains your medias."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--dest_dir="}),": Destination directory - The name and the place of the symbolic link, relative to ",(0,i.jsx)(s.code,{children:"/home/yunohost.multimedia"})]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),':\nThis "directory" will be a symbolic link to a existing directory.']}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/multimedia#L86",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_multimedia_addaccess"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Add an user to the multimedia group, in turn having write permission in multimedia directories"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_multimedia_addaccess user_name"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"user_name"}),": The name of the user which gain this access."]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/multimedia#L112",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"deprecated-or-handled-by-the-core--app-resources-since-v2",children:"Deprecated Or Handled By The Core / App Resources Since V2"}),"\n",(0,i.jsx)(s.h3,{id:"permission",children:"Permission"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_permission_delete"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove a permission for the app (note that when the app is removed all permission is automatically removed)"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_permission_delete --permission="permission"'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--permission="}),': the name for the permission (by default a permission named "main" is removed automatically when the app is removed)']}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:"ynh_permission_delete --permission=editors"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/permission#L158",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_permission_exists"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Check if a permission exists"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_permission_exists --permission=permission | exit: Return 1 if the permission doesn't exist, 0 otherwise"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--permission="}),": the permission to check"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/permission#L173",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_permission_url"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Redefine the url associated to a permission"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_permission_url --permission "permission" [--url="url"] [--add_url="new-url" [ "other-new-url" ]] [--remove_url="old-url" [ "other-old-url" ]]                                                     [--auth_header=true|false] [--clear_urls]'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--permission="}),': the name for the permission (by default a permission named "main" is removed automatically when the app is removed)']}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--url="}),': (optional) URL for which access will be allowed/forbidden. Note that if you want to remove url you can pass an empty sting as arguments ("").']}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--add_url="}),": (optional) List of additional url to add for which access will be allowed/forbidden."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--remove_url="}),": (optional) List of additional url to remove for which access will be allowed/forbidden"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--auth_header="}),": (optional) Define for the URL of this permission, if SSOwat pass the authentication header to the application"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--clear_urls"}),": (optional) Clean all urls (url and additional_urls)"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/permission#L194",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_permission_update"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Update a permission for the app"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_permission_update --permission "permission" [--add="group" ["group" ...]] [--remove="group" ["group" ...]]'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--permission="}),': the name for the permission (by default a permission named "main" already exist)']}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--add="}),": the list of group or users to enable add to the permission"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--remove="}),": the list of group or users to remove from the permission"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/permission#L257",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_permission_has_user"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Check if a permission has an user"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_permission_has_user --permission=permission --user=user | exit: Return 1 if the permission doesn't have that user or doesn't exist, 0 otherwise"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--permission="}),": the permission to check"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--user="}),": the user seek in the permission"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example"}),": ",(0,i.jsx)(s.code,{children:"ynh_permission_has_user --permission=main --user=visitors"})]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/permission#L298",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"apt",children:"Apt"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_apt_install_dependencies"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Define and install dependencies with a equivs control file"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_apt_install_dependencies dep [dep [...]]"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"dep"}),": the package name to install in dependence."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:'"dep1|dep2|\u2026"'}),": You can specify alternatives. It will require to install (dep1 or dep2, etc)."]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),':\nexample : ynh_apt_install_dependencies dep1 dep2 "dep3|dep4|dep5"']}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/apt#L31",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_apt_remove_dependencies"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Remove fake package and its dependencies"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_apt_remove_dependencies"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nDependencies will removed only if no other package need them."]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/apt#L175",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_apt_install_dependencies_from_extra_repository"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Install packages from an extra repository properly."})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_apt_install_dependencies_from_extra_repository --repo="repo" --package="dep1 dep2" --key=key_url'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--repo="}),": Complete url of the extra repository."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--package="}),": The packages to install from this extra repository"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--key="}),": url to get the public key."]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/apt#L205",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"systemuser",children:"Systemuser"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_system_user_exists"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Check if a user exists on the system"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_system_user_exists --username=username"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--username="}),": the username to check"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns"}),": 0 if the user exists, 1 otherwise."]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemuser#L26",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_system_group_exists"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Check if a group exists on the system"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_system_group_exists --group=group"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--group="}),": the group to check"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns"}),": 0 if the group exists, 1 otherwise."]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemuser#L41",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_system_user_create"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Create a system user"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:'ynh_system_user_create --username=user_name [--home_dir=home_dir] [--use_shell] [--groups="group1 group2"]'})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--username="}),": Name of the system user that will be create"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--home_dir="}),": Path of the home dir for the user. Usually the final path of the app. If this argument is omitted, the user will be created without home"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--use_shell"}),": Create a user using the default login shell if present. If this argument is omitted, the user will be created with /usr/sbin/nologin shell"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--groups"}),": Add the user to system groups. Typically meant to add the user to the ssh.app / sftp.app group (e.g. for borgserver, my_webapp)"]}),"\n"]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Details"}),":\nCreate a nextcloud user with no home directory and /usr/sbin/nologin login shell (hence no login capability) :"]}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ynh_system_user_create --username=nextcloud\n"})}),(0,i.jsx)(s.p,{children:"Create a discourse user using /var/www/discourse as home directory and the default login shell :"}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ynh_system_user_create --username=discourse --home_dir=/var/www/discourse --use_shell\n"})}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemuser#L70",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)(s.code,{children:"ynh_system_user_delete"}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"Delete a system user"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Usage"}),": ",(0,i.jsx)(s.code,{children:"ynh_system_user_delete --username=user_name"})]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Arguments"}),":"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--username="}),": Name of the system user that will be create"]}),"\n"]}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/YunoHost/yunohost/blob/b91ab52deb47b942572790cc4b4b36b4b15ec365/helpers/helpers.v2.1.d/systemuser#L108",children:"Dude, show me the code!"})})]}),"\n",(0,i.jsx)(s.hr,{})]})}function a(e={}){let{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},4429:function(e,s,n){n.d(s,{R:()=>d,x:()=>h});var r=n(6540);let i={},l=r.createContext(i);function d(e){let s=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function h(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(l.Provider,{value:s},e.children)}}}]);