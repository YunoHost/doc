"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([["7556"],{205:function(n,i,e){e.r(i),e.d(i,{frontMatter:()=>r,toc:()=>d,default:()=>u,metadata:()=>o,assets:()=>s,contentTitle:()=>t});var o=JSON.parse('{"id":"admin/troubleshooting/fail2ban","title":"Sbannare un indirizzo IP","description":"Fail2Ban \xe8 un programma di prevenzione delle intrusioni che protegge i server contro gli attacchi di forza bruta (brute-force), controllando alcuni log e bannando (cio\xe8 impedendo ulteriori connessioni) gli indirizzi IP che mostrano questo tipo di comportamento.","source":"@site/i18n/it/docusaurus-plugin-content-docs/current/admin/50.troubleshooting/05.fail2ban.mdx","sourceDirName":"admin/50.troubleshooting","slug":"/admin/troubleshooting/fail2ban","permalink":"/pr-2672/it/admin/troubleshooting/fail2ban","draft":false,"unlisted":false,"editUrl":"https://github.com/YunoHost/doc/tree/main/i18n/it/docusaurus-plugin-content-docs/current/admin/50.troubleshooting/05.fail2ban.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Sbannare un indirizzo IP"},"sidebar":"admin","previous":{"title":"Cleanup","permalink":"/pr-2672/it/admin/troubleshooting/cleanup"},"next":{"title":"Cambiare la password dell\'amministratore","permalink":"/pr-2672/it/admin/troubleshooting/change_admin_password"}}'),a=e(4848),l=e(4429);let r={title:"Sbannare un indirizzo IP"},t,s={},d=[{value:"Togliere il ban ad un indirizzo",id:"togliere-il-ban-ad-un-indirizzo",level:2},{value:"Aggiungere un indirizzo IP alla whitelist",id:"aggiungere-un-indirizzo-ip-alla-whitelist",level:2}];function c(n){let i={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.p,{children:[(0,a.jsx)(i.strong,{children:"Fail2Ban"})," \xe8 un programma di prevenzione delle intrusioni che protegge i server contro gli attacchi di forza bruta (brute-force), controllando alcuni log e bannando (cio\xe8 impedendo ulteriori connessioni) gli indirizzi IP che mostrano questo tipo di comportamento."]}),"\n",(0,a.jsxs)(i.p,{children:["In particolare, ",(0,a.jsx)(i.strong,{children:"Fail2Ban"})," controlla tentativi di connessione su ",(0,a.jsx)(i.code,{children:"SSH"}),". Dopo cinque tentativi di connessione falliti, Fail2Ban banna l'indirizzo IP impedendogli la connessione SSH per 10 minuti. Se la cosa si ripete altre volte viene bannato per una settimana."]}),"\n",(0,a.jsx)(i.h2,{id:"togliere-il-ban-ad-un-indirizzo",children:"Togliere il ban ad un indirizzo"}),"\n",(0,a.jsx)(i.p,{children:"Per sbloccare un indirizzo \xe8 necessario innanzitutto accedere al server con qualche mezzo (ad esempio da un altro indirizzo IP o da un'altra connessione diversa da quella bannata)."}),"\n",(0,a.jsxs)(i.p,{children:["Dopo di che controlla il ",(0,a.jsx)(i.strong,{children:"log di Fail2Ban"})," per trovare in quale ",(0,a.jsx)(i.code,{children:"jail"})," \xe8 stato bannato l'indirizzo IP:"]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"sudo tail /var/log/fail2ban.log\n2019-01-07 16:24:47 fail2ban.filter  [1837]: INFO    [sshd] Found 11.22.33.44\n2019-01-07 16:24:49 fail2ban.filter  [1837]: INFO    [sshd] Found 11.22.33.44\n2019-01-07 16:24:51 fail2ban.filter  [1837]: INFO    [sshd] Found 11.22.33.44\n2019-01-07 16:24:54 fail2ban.filter  [1837]: INFO    [sshd] Found 11.22.33.44\n2019-01-07 16:24:57 fail2ban.filter  [1837]: INFO    [sshd] Found 11.22.33.44\n2019-01-07 16:24:57 fail2ban.actions [1837]: NOTICE  [sshd] Ban 11.22.33.44\n2019-01-07 16:24:57 fail2ban.filter  [1837]: NOTICE  [recidive] Ban 11.22.33.44\n"})}),"\n",(0,a.jsxs)(i.p,{children:["In questo esempio l'indirizzo ",(0,a.jsx)(i.code,{children:"11.22.33.44"})," \xe8 stato bannato nel ",(0,a.jsx)(i.code,{children:"jail"})," ",(0,a.jsx)(i.code,{children:"sshd"})," e ",(0,a.jsx)(i.code,{children:"recidive"}),"."]}),"\n",(0,a.jsx)(i.p,{children:"Quindi togli il ban con il seguente comando:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"sudo fail2ban-client set sshd unbanip 11.22.33.44\nsudo fail2ban-client set recidive unbanip 11.22.33.44\n"})}),"\n",(0,a.jsx)(i.h2,{id:"aggiungere-un-indirizzo-ip-alla-whitelist",children:"Aggiungere un indirizzo IP alla whitelist"}),"\n",(0,a.jsxs)(i.p,{children:['Se vuoi impedire che un indirizzo IP "legittimo" venga bloccato da ',(0,a.jsx)(i.strong,{children:"YunoHost"})," ancora devi compilare la whitelist del file di configurazione della ",(0,a.jsx)(i.code,{children:"jail"}),"."]}),"\n",(0,a.jsxs)(i.p,{children:["Aggiornando ",(0,a.jsx)(i.strong,{children:"Fail2Ban"})," il file ",(0,a.jsx)(i.code,{children:"/etc/fail2ban/jail.conf"})," originale verr\xe0 sovrascritto quindi dovremo scrivere questi cambiamenti su un nuovo file che verr\xe0 mantenuto."]}),"\n",(0,a.jsxs)(i.ol,{children:["\n",(0,a.jsxs)(i.li,{children:["\n",(0,a.jsxs)(i.p,{children:["Comincia creando un nuovo file di configurazione della jail che verr\xe0 chiamato ",(0,a.jsx)(i.code,{children:"yunohost-whitelist.conf"}),":"]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"sudo touch /etc/fail2ban/jail.d/yunohost-whitelist.conf\n"})}),"\n"]}),"\n",(0,a.jsxs)(i.li,{children:["\n",(0,a.jsxs)(i.p,{children:["Modifica questo nuovo file con il tuo editor preferito (in questo esempio viene usato ",(0,a.jsx)(i.code,{children:"nano"}),"):"]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"sudo nano /etc/fail2ban/jail.d/yunohost-whitelist.conf\n"})}),"\n"]}),"\n",(0,a.jsxs)(i.li,{children:["\n",(0,a.jsxs)(i.p,{children:["Incolla il seguente testo nel file cambiando l'indirizzo IP ",(0,a.jsx)(i.code,{children:"XXX.XXX.XXX.XXX"}),":"]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"[DEFAULT]\n\nignoreip = 127.0.0.1/8 XXX.XXX.XXX.XXX #<= the IP address (you can put more than one, separated by a space) that you want to whitelist\n"})}),"\n"]}),"\n",(0,a.jsxs)(i.li,{children:["\n",(0,a.jsx)(i.p,{children:"Salva il file e ricarica la configurazione di Fail2Ban:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-bash",children:"sudo fail2ban-client reload\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(i.p,{children:"Congratulazioni, non corrererai pi\xf9 il rischio di essere bannato dal tuo server YunoHost!"})]})}function u(n={}){let{wrapper:i}={...(0,l.R)(),...n.components};return i?(0,a.jsx)(i,{...n,children:(0,a.jsx)(c,{...n})}):c(n)}},4429:function(n,i,e){e.d(i,{R:()=>r,x:()=>t});var o=e(6540);let a={},l=o.createContext(a);function r(n){let i=o.useContext(l);return o.useMemo(function(){return"function"==typeof n?n(i):{...i,...n}},[i,n])}function t(n){let i;return i=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:r(n.components),o.createElement(l.Provider,{value:i},n.children)}}}]);