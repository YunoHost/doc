"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([["984"],{616:function(e,o,r){r.r(o),r.d(o,{frontMatter:()=>l,toc:()=>d,default:()=>m,metadata:()=>i,assets:()=>u,contentTitle:()=>c});var i=JSON.parse('{"id":"admin/tutorials/email_configure_relay","title":"Configurare un relay SMTP","description":"Se il vostro internet provider blocca la porta 25, o nel caso riscontriate dei problemi nell\'uso del server SMTP nativo di YunoHost, potere configurare il vostro server YunoHost affinch\xe9 utilizzi un relay SMTP.","source":"@site/i18n/it/docusaurus-plugin-content-docs/current/admin/45.tutorials/35.email_configure_relay.mdx","sourceDirName":"admin/45.tutorials","slug":"/admin/tutorials/email_configure_relay","permalink":"/pr-2672/it/admin/tutorials/email_configure_relay","draft":false,"unlisted":false,"editUrl":"https://github.com/YunoHost/doc/tree/main/i18n/it/docusaurus-plugin-content-docs/current/admin/45.tutorials/35.email_configure_relay.mdx","tags":[],"version":"current","sidebarPosition":35,"frontMatter":{"title":"Configurare un relay SMTP"},"sidebar":"admin","previous":{"title":"Add external storage","permalink":"/pr-2672/it/admin/tutorials/external_storage"},"next":{"title":"Configure Tor Hidden Service","permalink":"/pr-2672/it/admin/tutorials/torhiddenservice"}}'),n=r(4848),a=r(4429),t=r(4109),s=r(3703);let l={title:"Configurare un relay SMTP"},c,u={},d=[{value:"Cos&#39;\xe8 un relay SMTP",id:"cos\xe8-un-relay-smtp",level:2},{value:"<FAIcon></FAIcon>  Svantaggi del server relay",id:"--svantaggi-del-server-relay",level:2},{value:"Come utilizzare un relay SMTP con YunoHost?",id:"come-utilizzare-un-relay-smtp-con-yunohost",level:2},{value:"Primo punto: creare un account presso un relay SMTP",id:"primo-punto-creare-un-account-presso-un-relay-smtp",level:3},{value:"Secondo punto: Configurare correttamente i DNS",id:"secondo-punto-configurare-correttamente-i-dns",level:3},{value:"Terzo punto: configurare YunoHost",id:"terzo-punto-configurare-yunohost",level:3},{value:"Relay all emails, even those from domains managed by YunoHost",id:"relay-all-emails-even-those-from-domains-managed-by-yunohost",level:4},{value:"Step 4: Check your setup",id:"step-4-check-your-setup",level:3}];function p(e){let o={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components},{FAIcon:i}=o;return i||function(e,o){throw Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("FAIcon",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.p,{children:"Se il vostro internet provider blocca la porta 25, o nel caso riscontriate dei problemi nell'uso del server SMTP nativo di YunoHost, potere configurare il vostro server YunoHost affinch\xe9 utilizzi un relay SMTP."}),"\n",(0,n.jsx)(o.h2,{id:"cos\xe8-un-relay-smtp",children:"Cos'\xe8 un relay SMTP"}),"\n",(0,n.jsx)(o.p,{children:"Si tratta di un server SMTP che si occupa dell'invio della posta elettronica in luogo del server SMTP locale (il servizio postfix di YunoHost).\nUna volta configurato correttamente l'utilizzo \xe8 trasparente per gli utenti e i vostri corrispondenti visualizzeranno i messaggi di posta, come se arrivassero dal vostro server YunoHost. In realt\xe0 sar\xe0 il server relay SMTP che si occuper\xe0 dell'invio."}),"\n",(0,n.jsxs)(o.h2,{id:"--svantaggi-del-server-relay",children:[(0,n.jsx)(i,{icon:"fa-exclamation-triangle"}),"  Svantaggi del server relay"]}),"\n",(0,n.jsx)(o.p,{children:"\xc8 importante sottolineare che in un sistema di selfhosting, utilizzare un relay SMTP rappresenta un importante compromesso. In effetti non solo il RELAY SMTP sar\xe0 in grado di inviare le email per conto vostro, ma avr\xe0 accesso al contenuto e potrebbe anche modificarlo. (Ad esempio MailJet di default analizza i link HTML presenti nei messaggi per profilare l'attivit\xe0 degli utilizzatori del servizio.) Inoltre questa configurazione riguarder\xe0 tutto il server YunoHost: non sar\xe0 quindi possibile scegliere quale utente o quale indirizzo debba utilizzare il relay e quale no."}),"\n",(0,n.jsxs)(o.p,{children:["Oltre alle considerazioni sulla privacy discusse sopra, un relay SMTP pu\xf2 imporre dei limiti tecnici che non avremmo se la nostra porta 25 fosse aperta. Ad esempio, per la maggior parte dei server relay, se un utente del vostro server YunoHost imposta ",(0,n.jsx)(o.strong,{children:'un indirizzo di "reindirizzamento automatico"'})," delle mail ricevute, ",(0,n.jsx)(o.strong,{children:"questo non funzioner\xe0"})," per i messaggi proveniente dall'esterno senza comunicare niente all'utente. Questo perch\xe9 i relay richiedono, generalmente, che i messaggi che reinviano abbiano l'indirizzo di invio del vostro dominio (al fine di combattere lo spam e mantenere la reputazione del loro servizio), situazione che non si presenta in caso di \"reindirizzamento automatico\", dove l'indirizzo originale di spedizione viene conservato: il messaggio viene quindi bloccato dal relay (che normalmente, avvisa l'amministratore del server YunoHost)."]}),"\n",(0,n.jsx)(o.h2,{id:"come-utilizzare-un-relay-smtp-con-yunohost",children:"Come utilizzare un relay SMTP con YunoHost?"}),"\n",(0,n.jsx)(o.p,{children:"YunoHost supporta dalla versione 4.1 la configurazione di un relay SMTP. Al momento la configurazione non \xe8 disponibile dall'interfaccia di amministrazione ma solo da linea di comando."}),"\n",(0,n.jsx)(o.h3,{id:"primo-punto-creare-un-account-presso-un-relay-smtp",children:"Primo punto: creare un account presso un relay SMTP"}),"\n",(0,n.jsx)(o.p,{children:"Esistono molti fornitori di relay SMTP. Alcuni sono gratuiti e altri propongono il servizio a pagamento in diverse opzioni. Come detto sopra, dovete essere sicuri di potervi fidare del provider, considerazione che spetta solo a voi."}),"\n",(0,n.jsx)(o.h3,{id:"secondo-punto-configurare-correttamente-i-dns",children:"Secondo punto: Configurare correttamente i DNS"}),"\n",(0,n.jsx)(o.p,{children:"Dopo aver creato l'account, le impostazioni del relay SMTP prevedono la modifica del DNS.\nLa procedura normale, prevede l'aggiunta di una chiave DKIM e SPF al record DNS.\nI parametri da inserire e le modalit\xe0 di modifica variano in base al fornitore dei servizi di DNS e relay SMTP che avete scelto."}),"\n",(0,n.jsx)(o.p,{children:'Normalmente i provider di relay SMTP forniscono le guide per modificare questi record insieme a programmi di controllo automatico della correttezza delle impostazioni del DNS. Questo passo \xe8 obbligatorio per assicurare "al mondo" che voi, gestori del vostro nome di dominio, autorizzate esplicitamente il vostro provider di relay SMTP ad inviare le email al vostro posto.'}),"\n",(0,n.jsx)(o.p,{children:"Notate che la modifica dei record DNS pu\xf2 avere effetto anche dopo 24 ore per cui siate pazienti!"}),"\n",(0,n.jsx)(o.admonition,{type:"warning",children:(0,n.jsxs)(o.p,{children:[(0,n.jsx)(i,{icon:"fa-exclamation-triangle"}),"  Attenzione! dopo aver registrato la zona DNS, il relay SMTP pu\xf2 inviare mail a nome vostro, senza avvisarvi."]})}),"\n",(0,n.jsx)(o.h3,{id:"terzo-punto-configurare-yunohost",children:"Terzo punto: configurare YunoHost"}),"\n",(0,n.jsx)(o.p,{children:"La configurazione pu\xf2 avvenire sia attraverso l'interfaccia web di amministrazione che da linea di comando."}),"\n",(0,n.jsxs)(t.A,{groupId:"admin-commands",children:[(0,n.jsxs)(s.A,{value:"web",label:"From the web interface",children:[(0,n.jsxs)(o.p,{children:["Dalla pagina web di amministrazione scegliere ",(0,n.jsx)(o.code,{children:"Strumenti"})," > ",(0,n.jsx)(o.code,{children:"Impostazioni"})," e scegliere la scheda ",(0,n.jsx)(o.code,{children:"Email"}),".\nAttivate l'opzione e compilate i campi necessari:"]}),(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.strong,{children:"SMTP relay host"})," : l'indirizzo del server SMTP."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.strong,{children:"SMTP relay port"})," : La porta utilizzata dal relay SMTP."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.strong,{children:"SMTP relay user"})," : Utente del vostro account sul relay SMTP."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.strong,{children:"SMTP relay password"})," : La password del vostro account sul relay SMTP."]}),"\n"]}),(0,n.jsx)(o.admonition,{type:"warning",children:(0,n.jsxs)(o.p,{children:[(0,n.jsx)(i,{icon:"fa-exclamation-triangle"}),"  Le password contenenti il carattere ",(0,n.jsx)(o.code,{children:"#"})," non funzioneranno correttamente a causa di una regola di postfix (altri caratteri potrebbero non essere riconosciuti, se li scoprite comunicatelo agli sviluppatori di YunoHost affich\xe9 possano aggiornare questa guida)."]})}),(0,n.jsx)(o.p,{children:(0,n.jsx)(o.img,{alt:"Option-Relais-Smtp",src:r(7346).A+"",width:"1722",height:"1246"})})]}),(0,n.jsxs)(s.A,{value:"cli",label:"From the command line",children:[(0,n.jsx)(o.p,{children:"Per configurare YunoHost per usare il relay, bisogna configurare questi quattro punti:"}),(0,n.jsxs)(o.ol,{children:["\n",(0,n.jsxs)(o.li,{children:["L'indirizzo del relay SMTP (per questo documento utilizzeremo ",(0,n.jsx)(o.code,{children:"smtprelay.tld"}),")"]}),"\n",(0,n.jsx)(o.li,{children:"La porta che utilizzeremo per accedere al relay (per questo documento utilizzeremo la porta 2525)"}),"\n",(0,n.jsxs)(o.li,{children:["Il vostro nome utente SMTP (per questo documento utilizzeremo ",(0,n.jsx)(o.code,{children:"username"}),")"]}),"\n",(0,n.jsx)(o.li,{children:"La password SMTP (per questo documento utilizzeremo password)"}),"\n"]}),(0,n.jsx)(o.admonition,{type:"warning",children:(0,n.jsxs)(o.p,{children:[(0,n.jsx)(i,{icon:"fa-exclamation-triangle"}),"  Le password contenenti il carattere ",(0,n.jsx)(o.code,{children:"#"})," non funzioneranno correttamente a causa di una regola di postfix (altri caratteri potrebbero non essere riconosciuti, se li scoprite comunicatelo agli sviluppatori di YunoHost affich\xe9 possano aggiornare questa guida)."]})}),(0,n.jsx)(o.p,{children:"Questi parametri devono essere ovviamente forniti dal provider relay SMTP e dovrebbero trovarsi in un pannello di controllo o che altro."}),(0,n.jsx)(o.p,{children:"Per prima cosa colleghiamoci al proprio server via SSH:"}),(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-bash",children:"ssh admin@domain.tld\n"})}),(0,n.jsx)(o.p,{children:"Aggiorniamo le impostazioni seguenti:"}),(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-bash",children:"sudo yunohost settings set email.smtp.smtp_relay_enabled -v yes\nsudo yunohost settings set smtp.relay.host -v smtprelay.tld\nsudo yunohost settings set smtp.relay.port -v 2525\nsudo yunohost settings set smtp.relay.user -v username\nsudo yunohost settings set smtp.relay.password -v password\n"})}),(0,n.jsx)(o.p,{children:"Possiamo controllare le impostazioni con il comando:"}),(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-bash",children:"sudo yunohost settings list\n"})})]})]}),"\n",(0,n.jsx)(o.p,{children:"La configurazione del relay SMTP \xe8 terminata!"}),"\n",(0,n.jsx)(o.admonition,{type:"warning",children:(0,n.jsxs)(o.p,{children:[(0,n.jsx)(i,{icon:"fa-exclamation-triangle"}),"  Da questo momento il relay SMTP \xe8 in grado di leggere e utilizzare le informazioni contenute nelle mail che inviate, senza il vostro consenso (Ma non sar\xe0 in grado di leggere le informazioni delle mail che riceverete)."]})}),"\n",(0,n.jsx)(o.h4,{id:"relay-all-emails-even-those-from-domains-managed-by-yunohost",children:"Relay all emails, even those from domains managed by YunoHost"}),"\n",(0,n.jsxs)(o.p,{children:["If you have plenty of trust in your SMTP relay, have a second IMAP server that you wish or are forced to use instead of the YunoHost one, you can choose to relay all emails even those from domain names managed by YunoHost by commenting the following two lines in ",(0,n.jsx)(o.code,{children:"/etc/postfix/main.cf"})," :"]}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-text",children:"#virtual_mailbox_domains = ldap:/etc/postfix/ldap-domains.cf\n#virtual_alias_maps = ldap:/etc/postfix/ldap-aliases.cf,ldap:/etc/postfix/ldap-groups.cf\n"})}),"\n",(0,n.jsx)(o.h3,{id:"step-4-check-your-setup",children:"Step 4: Check your setup"}),"\n",(0,n.jsxs)(o.p,{children:["You can check your setup by sending emails and try if everything works.\nSome of the SMTP relay will give you insights about the emails you send so that can also be a good way to check that everythings works as needed.\nOf course, you can always have a try with ",(0,n.jsx)(o.a,{href:"https://www.mail-tester.com/",children:"mail-tester.com"})," to check for any problem or discrepancy."]})]})}function m(e={}){let{wrapper:o}={...(0,a.R)(),...e.components};return o?(0,n.jsx)(o,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},7346:function(e,o,r){r.d(o,{A:()=>i});let i=r.p+"assets/images/relay_smtp_option_webadmin_en-c0d1765ad827013b6b5273b72f3e4750.png"},3703:function(e,o,r){r.d(o,{A:()=>a});var i=r(4848);r(6540);var n=r(9836);function a({children:e,hidden:o,className:r}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,n.A)("tabItem_Ymn6",r),hidden:o,children:e})}},4109:function(e,o,r){r.d(o,{A:()=>x});var i=r(4848),n=r(6540),a=r(9836),t=r(6364),s=r(8251),l=r(6347),c=r(8004),u=r(5580),d=r(2213),p=r(5734);function m(e){return n.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,n.isValidElement)(e)&&function(e){let{props:o}=e;return!!o&&"object"==typeof o&&"value"in o}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h({value:e,tabValues:o}){return o.some(o=>o.value===e)}var v=r(8864);function f({className:e,block:o,selectedValue:r,selectValue:n,tabValues:t}){let l=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),u=e=>{let o=e.currentTarget,i=t[l.indexOf(o)].value;i!==r&&(c(o),n(i))},d=e=>{let o=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{let r=l.indexOf(e.currentTarget)+1;o=l[r]??l[0];break}case"ArrowLeft":{let r=l.indexOf(e.currentTarget)-1;o=l[r]??l[l.length-1]}}o?.focus()};return(0,i.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":o},e),children:t.map(({value:e,label:o,attributes:n})=>(0,i.jsx)("li",{role:"tab",tabIndex:r===e?0:-1,"aria-selected":r===e,ref:e=>{l.push(e)},onKeyDown:d,onClick:u,...n,className:(0,a.A)("tabs__item","tabItem_LNqP",n?.className,{"tabs__item--active":r===e}),children:o??e},e))})}function g({lazy:e,children:o,selectedValue:r}){let t=(Array.isArray(o)?o:[o]).filter(Boolean);if(e){let e=t.find(e=>e.props.value===r);return e?(0,n.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,i.jsx)("div",{className:"margin-top--md",children:t.map((e,o)=>(0,n.cloneElement)(e,{key:o,hidden:e.props.value!==r}))})}function y(e){let o=function(e){let o,{defaultValue:r,queryString:i=!1,groupId:a}=e,t=function(e){let{values:o,children:r}=e;return(0,n.useMemo)(()=>{let e=o??m(r).map(({props:{value:e,label:o,attributes:r,default:i}})=>({value:e,label:o,attributes:r,default:i})),i=(0,d.XI)(e,(e,o)=>e.value===o.value);if(i.length>0)throw Error(`Docusaurus error: Duplicate values "${i.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`);return e},[o,r])}(e),[s,v]=(0,n.useState)(()=>(function({defaultValue:e,tabValues:o}){if(0===o.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:o}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${o.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}let r=o.find(e=>e.default)??o[0];if(!r)throw Error("Unexpected error: 0 tabValues");return r.value})({defaultValue:r,tabValues:t})),[f,g]=function({queryString:e=!1,groupId:o}){let r=(0,l.W6)(),i=function({queryString:e=!1,groupId:o}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!o)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return o??null}({queryString:e,groupId:o});return[(0,u.aZ)(i),(0,n.useCallback)(e=>{if(!i)return;let o=new URLSearchParams(r.location.search);o.set(i,e),r.replace({...r.location,search:o.toString()})},[i,r])]}({queryString:i,groupId:a}),[y,x]=function({groupId:e}){let o=e?`docusaurus.tab.${e}`:null,[r,i]=(0,p.Dv)(o);return[r,(0,n.useCallback)(e=>{o&&i.set(e)},[o,i])]}({groupId:a}),z=h({value:o=f??y,tabValues:t})?o:null;return(0,c.A)(()=>{z&&v(z)},[z]),{selectedValue:s,selectValue:(0,n.useCallback)(e=>{if(!h({value:e,tabValues:t}))throw Error(`Can't select invalid tab value=${e}`);v(e),g(e),x(e)},[g,x,t]),tabValues:t}}(e);return(0,i.jsxs)("div",{className:(0,a.A)(t.G.tabs.container,"tabs-container","tabList__CuJ"),children:[(0,i.jsx)(f,{...o,...e}),(0,i.jsx)(g,{...o,...e})]})}function x(e){let o=(0,v.A)();return(0,i.jsx)(y,{...e,children:m(e.children)},String(o))}},4429:function(e,o,r){r.d(o,{R:()=>t,x:()=>s});var i=r(6540);let n={},a=i.createContext(n);function t(e){let o=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function s(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:t(e.components),i.createElement(a.Provider,{value:o},e.children)}}}]);