"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([["8336"],{8546:function(e,s,i){i.r(s),i.d(s,{frontMatter:()=>o,toc:()=>u,default:()=>c,metadata:()=>n,assets:()=>l,contentTitle:()=>a});var n=JSON.parse('{"id":"admin/tutorials/security","title":"S\xe9curit\xe9","description":"YunoHost a \xe9t\xe9 d\xe9velopp\xe9 dans l\u2019optique de fournir une s\xe9curit\xe9 maximale tout en restant accessible et facilement installable.","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/admin/45.tutorials/60.security.mdx","sourceDirName":"admin/45.tutorials","slug":"/admin/tutorials/security","permalink":"/pr-2672/fr/admin/tutorials/security","draft":false,"unlisted":false,"editUrl":"https://github.com/YunoHost/doc/tree/main/i18n/fr/docusaurus-plugin-content-docs/current/admin/45.tutorials/60.security.mdx","tags":[],"version":"current","sidebarPosition":60,"frontMatter":{"title":"S\xe9curit\xe9"},"sidebar":"admin","previous":{"title":"Move apps storage","permalink":"/pr-2672/fr/admin/tutorials/moving_app_folder"},"next":{"title":"Acc\xe9der aux applications via SFTP","permalink":"/pr-2672/fr/admin/tutorials/sftp_on_apps"}}'),t=i(4848),r=i(4429);let o={title:"S\xe9curit\xe9"},a,l={},u=[{value:"Am\xe9liorer la s\xe9curit\xe9",id:"am\xe9liorer-la-s\xe9curit\xe9",level:2},{value:"Authentification SSH par cl\xe9",id:"authentification-ssh-par-cl\xe9",level:3},{value:"Modifier le port SSH",id:"modifier-le-port-ssh",level:3},{value:"Durcir la s\xe9curit\xe9 de la configuration des services",id:"durcir-la-s\xe9curit\xe9-de-la-configuration-des-services",level:3},{value:"D\xe9sactivation de l\u2019API YunoHost",id:"d\xe9sactivation-de-lapi-yunohost",level:3}];function d(e){let s={a:"a",admonition:"admonition",br:"br",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{FAIcon:i}=s;return i||function(e,s){throw Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("FAIcon",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.p,{children:"YunoHost a \xe9t\xe9 d\xe9velopp\xe9 dans l\u2019optique de fournir une s\xe9curit\xe9 maximale tout en restant accessible et facilement installable."}),"\n",(0,t.jsxs)(s.p,{children:["Tous les protocoles que YunoHost utilise sont ",(0,t.jsx)(s.strong,{children:"chiffr\xe9s"}),", les mots de passe ne sont pas stock\xe9s en clair, et par d\xe9faut chaque utilisateur n\u2019acc\xe8de qu\u2019\xe0 son r\xe9pertoire personnel."]}),"\n",(0,t.jsx)(s.p,{children:"Deux points sont n\xe9anmoins importants \xe0 noter :"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["L\u2019installation d\u2019applications suppl\xe9mentaires ",(0,t.jsx)(s.strong,{children:"augmente le nombre de failles"})," potentielles. Il est donc conseill\xe9 de se renseigner sur chacune d\u2019elle ",(0,t.jsx)(s.strong,{children:"avant l\u2019installation"}),", d\u2019en comprendre le fonctionnement et juger ainsi l\u2019impact que provoquerait une potentielle attaque. N\u2019installez ",(0,t.jsx)(s.strong,{children:"que"})," les applications qui semblent importantes pour votre usage."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Le fait que YunoHost soit un logiciel r\xe9pandu augmente les chances de subir une attaque. Si une faille est d\xe9couverte, elle peut potentiellement ",(0,t.jsx)(s.strong,{children:"toucher toutes les instances YunoHost"})," \xe0 un temps donn\xe9. Nous nous effor\xe7ons de corriger ces failles le plus rapidement possible, pensez donc \xe0 ",(0,t.jsx)(s.strong,{children:"mettre \xe0 jour r\xe9guli\xe8rement"})," votre syst\xe8me."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.admonition,{type:"tip",children:(0,t.jsxs)(s.p,{children:["Si vous avez besoin de conseil, n\u2019h\xe9sitez pas \xe0 ",(0,t.jsx)(s.a,{href:"/community/help",children:"nous demander"}),"."]})}),"\n",(0,t.jsx)(s.admonition,{type:"danger",children:(0,t.jsxs)(s.p,{children:[(0,t.jsx)(i,{icon:"fa-shield"})," Pour discuter d'une faille de s\xe9curit\xe9, contactez l'",(0,t.jsx)(s.a,{href:"/community/security_team",children:"\xe9quipe s\xe9curit\xe9 de YunoHost"}),"."]})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"am\xe9liorer-la-s\xe9curit\xe9",children:"Am\xe9liorer la s\xe9curit\xe9"}),"\n",(0,t.jsx)(s.p,{children:"Si votre serveur YunoHost est dans un environnement de production critique ou que vous souhaitez am\xe9liorer sa s\xe9curit\xe9, il est bon de suivre quelques bonnes pratiques."}),"\n",(0,t.jsx)(s.admonition,{type:"warning",children:(0,t.jsx)(s.p,{children:"L\u2019application des conseils suivants n\xe9cessite une connaissance avanc\xe9e du fonctionnement et de l\u2019administration d\u2019un serveur. Pensez \xe0 vous renseigner avant de proc\xe9der \xe0 cette mise en place."})}),"\n",(0,t.jsx)(s.admonition,{type:"tip",children:(0,t.jsx)(s.p,{children:"Ne fermez jamais votre connexion SSH initiale sans avoir v\xe9rifi\xe9 que vos modifications fonctionnent. Testez vos modifications dans une nouvelle fen\xeatre ou terminal. Ainsi, vous pourrez d\xe9faire vos modifications sans vous retrouver bloqu\xe9s."})}),"\n",(0,t.jsx)(s.h3,{id:"authentification-ssh-par-cl\xe9",children:"Authentification SSH par cl\xe9"}),"\n",(0,t.jsxs)(s.p,{children:["Voici un ",(0,t.jsx)(s.a,{href:"http://doc.ubuntu-fr.org/ssh#authentification_par_un_systeme_de_cles_publiqueprivee",children:"tutoriel plus d\xe9taill\xe9"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"Par d\xe9faut, l\u2019authentification SSH se fait avec le mot de passe d\u2019administration. Il est conseill\xe9 de d\xe9sactiver ce type d\u2019authentification et de le remplacer par un m\xe9canisme de cl\xe9 de chiffrement."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Sur votre ordinateur de bureau :"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"ssh-keygen\nssh-copy-id -i ~/.ssh/id_rsa.pub <nom_utilisateur@votre.domaine.tld>\n"})}),"\n",(0,t.jsx)(s.admonition,{type:"tip",children:(0,t.jsxs)(s.p,{children:["Si vous avez des probl\xe8mes de permissions, donnez \xe0 ",(0,t.jsx)(s.code,{children:"nom_utilisateur"})," la possession du dossier ",(0,t.jsx)(s.code,{children:"~/.ssh"})," avec ",(0,t.jsx)(s.code,{children:"chown"}),". Attention, pour des raisons de s\xe9curit\xe9, ce dossier doit \xeatre en mode 700 !\nSi vous \xeates sur Ubuntu 16.04 vous devez faire  ",(0,t.jsx)(s.code,{children:"ssh-add"})," pour initialiser l'agent SSH."]})}),"\n",(0,t.jsx)(s.p,{children:"Entrez le mot de passe d\u2019administration et votre cl\xe9 publique devrait \xeatre copi\xe9e sur votre serveur."}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Sur votre serveur"}),", l'\xe9dition du fichier de configuration SSH pour d\xe9sactiver l\u2019authentification par mot de passe est g\xe9r\xe9e par un param\xe8tre syst\xe8me :"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"sudo yunohost settings set security.ssh.ssh_password_authentication -v no\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"modifier-le-port-ssh",children:"Modifier le port SSH"}),"\n",(0,t.jsxs)(s.p,{children:["Pour \xe9viter des tentatives de connexion SSH par des robots qui scannent tout Internet pour tenter des connexions SSH avec tout serveur accessible, on peut modifier le port SSH.\nC'est g\xe9r\xe9 par un param\xe8tre syst\xe8me, qui se charge de configurer les services SSH et Fail2Ban.",(0,t.jsx)(s.br,{}),"\n","Il n'est pas utile de modifier ce port si vous avez d\xe9sactiv\xe9 l'authentification par mot de passe."]}),"\n",(0,t.jsx)(s.admonition,{type:"warning",children:(0,t.jsxs)(s.p,{children:["Si vous modifiez quoi que ce soit dans le fichier ",(0,t.jsx)(s.code,{children:"/etc/ssh/sshd_config"}),", m\xeame si ce n'est que le port, YunoHost ne g\xe9rera plus ce fichier. Pour cette raison, utilisez toujours les outils d'administration de YunoHost pour effectuer des changements dans les fichiers de configuration du syst\xe8me !"]})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"sudo yunohost settings set security.ssh.ssh_port -v <votre_numero_de_port_ssh>\n"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Lors de la prochaine connexion SSH"}),", vous devrez ajouter le param\xe8tre ",(0,t.jsx)(s.code,{children:"-p"})," suivi du port SSH."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Exemple"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"ssh -p <votre_numero_de_port_ssh> admin@<votre_serveur_yunohost>\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"durcir-la-s\xe9curit\xe9-de-la-configuration-des-services",children:"Durcir la s\xe9curit\xe9 de la configuration des services"}),"\n",(0,t.jsxs)(s.p,{children:["La configuration TLS par d\xe9faut des services tend \xe0 offrir une bonne compatibilit\xe9 avec les vieux appareils. Vous pouvez r\xe9gler cette politique pour les services SSH et NGINX. Par d\xe9faut, la configuration du NGINX suit la ",(0,t.jsx)(s.a,{href:"https://wiki.mozilla.org/Security/Server_Side_TLS#Intermediate_compatibility_.28default.29",children:"recommandation de compatibilit\xe9 interm\xe9diaire"})," de Mozilla. Vous pouvez choisir de passer \xe0 la configuration \xab moderne \xbb qui utilise des recommandations de s\xe9curit\xe9 plus r\xe9centes, mais qui diminue la compatibilit\xe9, ce qui peut poser un probl\xe8me pour vos utilisateurs et visiteurs qui utilisent de vieux appareils. Plus de d\xe9tails peuvent \xeatre trouv\xe9s sur ",(0,t.jsx)(s.a,{href:"https://wiki.mozilla.org/Security/Server_Side_TLS#Modern_compatibility",children:"cette page"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"Changer le niveau de compatibilit\xe9 n'est pas d\xe9finitif et il est possible de rechanger le param\xe8tre si vous concluez qu'il faut revenir en arri\xe8re."}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Sur votre serveur"}),", modifiez la politique pour NGINX\u202F:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"sudo yunohost settings set security.nginx.nginx_compatibility -v modern\n"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Sur votre serveur"}),", modifiez la politique pour SSH :"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"sudo yunohost settings set security.ssh.ssh_compatibility -v modern\n"})}),"\n",(0,t.jsx)(s.h3,{id:"d\xe9sactivation-de-lapi-yunohost",children:"D\xe9sactivation de l\u2019API YunoHost"}),"\n",(0,t.jsxs)(s.p,{children:["YunoHost est administrable via une ",(0,t.jsx)(s.strong,{children:"API HTTP"}),", servie sur le port 6787 par d\xe9faut (seulement sur ",(0,t.jsx)(s.code,{children:"localhost"}),").\nElle permet d\u2019administrer une grande partie de votre serveur, et peut donc \xeatre utilis\xe9e \xe0 des ",(0,t.jsx)(s.strong,{children:"fins malveillantes"}),".\nLa meilleure chose \xe0 faire si vous \xeates habitu\xe9s \xe0 la ligne de commande est de d\xe9sactiver le service ",(0,t.jsx)(s.code,{children:"yunohost-api"}),", et ",(0,t.jsxs)(s.strong,{children:["utiliser la ",(0,t.jsx)(s.a,{href:"/admin/command_line",children:"ligne de commande"})]})," en SSH."]}),"\n",(0,t.jsx)(s.admonition,{type:"warning",children:(0,t.jsx)(s.p,{children:"Ceci va d\xe9sactiver \xe0 la fois l'API et l'interface d'administration web de YunoHost qui en d\xe9pend.\nNe continuez que si vous \xeates \xe0 l'aise avec la ligne de commande."})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"sudo systemctl disable yunohost-api\nsudo systemctl stop yunohost-api\n"})}),"\n",(0,t.jsxs)(s.p,{children:["As ",(0,t.jsx)(s.code,{children:"yunohost-api"})," is now disabled and not running, Diagnosis will report an error and cannot be ignored from the API.\nIf you want to ignore this error, you can configure YunoHost from the CLI."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"sudo yunohost diagnosis ignore --filter services service=yunohost-api\n"})})]})}function c(e={}){let{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},4429:function(e,s,i){i.d(s,{R:()=>o,x:()=>a});var n=i(6540);let t={},r=n.createContext(t);function o(e){let s=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);