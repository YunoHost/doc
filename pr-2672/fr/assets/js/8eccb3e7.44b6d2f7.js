"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([["3278"],{1558:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>i,toc:()=>c,default:()=>u,metadata:()=>r,assets:()=>l,contentTitle:()=>d});var r=JSON.parse('{"id":"dev/core/ynh_core/ynh_core","title":"Le serveur et la ligne de commande","description":"Avec ynh-dev, lancez dans le conteneur :","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/dev/15.core/20.ynh_core/20.ynh_core.mdx","sourceDirName":"dev/15.core/20.ynh_core","slug":"/dev/core/ynh_core/","permalink":"/doc/pr-2672/fr/dev/core/ynh_core/","draft":false,"unlisted":false,"editUrl":"https://github.com/YunoHost/doc/tree/main/i18n/fr/docusaurus-plugin-content-docs/current/dev/15.core/20.ynh_core/20.ynh_core.mdx","tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"title":"Le serveur et la ligne de commande"},"sidebar":"devpackaging","previous":{"title":"Development environment","permalink":"/doc/pr-2672/fr/dev/core/devenv"},"next":{"title":"Technical details for config panel structure and form option types","permalink":"/doc/pr-2672/fr/dev/core/ynh_core/forms"}}'),t=s(4848),o=s(4429);let i={title:"Le serveur et la ligne de commande"},d="Travailler sur le serveur et la ligne de commande",l={},c=[{value:"L&#39;actionsmap",id:"lactionsmap",level:2},{value:"Style de code",id:"style-de-code",level:2},{value:"R\xe8gles sp\xe9cifiques YunoHost",id:"r\xe8gles-sp\xe9cifiques-yunohost",level:3}];function a(e){let n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"travailler-sur-le-serveur-et-la-ligne-de-commande",children:"Travailler sur le serveur et la ligne de commande"})}),"\n",(0,t.jsxs)(n.p,{children:["Avec ",(0,t.jsx)(n.code,{children:"ynh-dev"}),", lancez dans le conteneur :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"./ynh-dev use-git yunohost\n"})}),"\n",(0,t.jsx)(n.p,{children:"Si vous travaillez aussi sur Moulinette :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"./ynh-dev use-git moulinette\n"})}),"\n",(0,t.jsx)(n.h2,{id:"lactionsmap",children:"L'actionsmap"}),"\n",(0,t.jsxs)(n.p,{children:["Le fichier actionsmap (",(0,t.jsx)(n.code,{children:"data/actionsmap/yunohost.yml"}),") d\xe9finit la ligne de\ncommande ",(0,t.jsx)(n.em,{children:"et"}),' la structure de l\'API. Il est structur\xe9 en "cat\xe9gories",\n"actions" et "arguments".']}),"\n",(0,t.jsxs)(n.p,{children:["Par exemple, dans ",(0,t.jsx)(n.code,{children:"yunohost domain add some.domain.tld"}),", la cat\xe9gorie est ",(0,t.jsx)(n.code,{children:"domain"}),", l'action est ",(0,t.jsx)(n.code,{children:"add"})," et ",(0,t.jsx)(n.code,{children:"some.domain.tld"})," est un argument."]}),"\n",(0,t.jsxs)(n.p,{children:["Moulinette va automatiquement faire le lien entre les commandes de l'actionsmap et les fonctions Python (ainsi que leurs arguments) dans ",(0,t.jsx)(n.code,{children:"src/yunohost/"}),". Par exemple, ",(0,t.jsx)(n.code,{children:"yunohost domain add some.domain.tld"})," d\xe9clenchera un appel de ",(0,t.jsx)(n.code,{children:"domain_add(domainName)"})," dans ",(0,t.jsx)(n.code,{children:"domain.py"}),", avec l'argument  ",(0,t.jsx)(n.code,{children:"domainName"})," qui vaudra ",(0,t.jsx)(n.code,{children:'"some.domain.tld"'}),"."]}),"\n",(0,t.jsxs)(n.admonition,{type:"warning",children:[(0,t.jsx)(n.p,{children:"\xc0 chaque modification de l'actionsmap, il faut red\xe9marrer l'API YunoHost :"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"systemctl restart yunohost-api```\nIl faudra retaper le mot de passe administrateur dans l'interface web.\n"})})]}),"\n",(0,t.jsx)(n.h2,{id:"style-de-code",children:"Style de code"}),"\n",(0,t.jsxs)(n.p,{children:["Veuillez suivre les r\xe8gles standard PEP8, ajouter du ",(0,t.jsx)(n.a,{href:"https://docs.python.org/3/library/typing.html",children:"typage Python"}),",\net lancer les outils habituels de linting pour Python et Bash."]}),"\n",(0,t.jsx)(n.p,{children:"Les Actions Github lanceront les outils de linting et reporteront les erreurs."}),"\n",(0,t.jsx)(n.h3,{id:"r\xe8gles-sp\xe9cifiques-yunohost",children:"R\xe8gles sp\xe9cifiques YunoHost"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Pour g\xe9rer les exceptions, il existe un type ",(0,t.jsx)(n.code,{children:"YunohostError()"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Pour aider avec l'internationalisation des messages, utilisez ",(0,t.jsx)(n.code,{children:"m18n.n('some-message-id')"})," et mettez le message correspondant dans ",(0,t.jsx)(n.code,{children:"locales/en.json"}),". Vous pouvez aussi utiliser des arguments pour construire les messages, avec ",(0,t.jsx)(n.code,{children:"{{some-argument:s}}"}),". Ne modifiez pas de fichiers de locales autres que ",(0,t.jsx)(n.code,{children:"en.json"}),", la traduction sera faite avec ",(0,t.jsx)(n.a,{href:"https://translate.yunohost.org/",children:"Weblate"})," !"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Mettre un ",(0,t.jsx)(n.code,{children:"_"}),' devant les noms des fonctions "priv\xe9es".']}),"\n"]}),"\n"]})]})}function u(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},4429:function(e,n,s){s.d(n,{R:()=>i,x:()=>d});var r=s(6540);let t={},o=r.createContext(t);function i(e){let n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);