---
title: 'Migrer de 11.x vers 12.x'
---

L'objectif cette page est de décrire le processus de migration d'une instance en YunoHost 11.x (tournant sous Debian Bullseye) vers YunoHost 12.x (tournant sous Debian Bookworm).

## Notes importantes

- The YunoHost team did its best to make sure that the migration is as smooth as possible and was tested over the course of several months in several cases.

- Please [backup your data and server](/admin/backups)! This migration is a complex operation and covering every pitfall is quite hard. And in any case, be patient and attentive during the migration.

- Ne vous précipitez pas à vouloir faire une réinstallation de votre système en pensant que cela serait "plus simple" (sigh). (Une attitude qui revient régulièrement est de vouloir réinstaller son système à la moindre complication...). À la place, si vous rencontrez des problèmes, nous vous encourageons à investiguer, chercher à comprendre et [trouver de l'aide sur le chat ou le forum](/community/help).

- **You should watch the known issues at the bottom of this page, to be sure your migrations will work properly.**

## Procédure de migration

Vous devez d'abord vous assurer que votre système est à jour. La migration est disponible à partir de la version 11.3.

Il est recommendé de lancer la migration depuis la ligne de commande, mais elle peut très bien être effectuée depuis la webadmin.

### Depuis la webadmin

Allez dans Outils > Migrations pour accéder à l'interface de migration. Il vous faudra ensuite lire l'avertissement attentivement et l'accepter pour lancer la migration.

Notez que même si vous fermez la page d'admin, la migration continuera (par contre l'interface d'admin sera partiellement indisponible).

### Depuis la ligne de commande

Lancez simplement :

```bash
sudo yunohost tools migrations run
```

puis lisez attentivement l'avertissement et les instructions.

## Pendant la migration

En fonction de votre matériel et des paquets installés, la migration peut prendre jusqu'à une ou deux heures.

Les logs seront affichés dans la barre de message au centre de la page (vous pouvez approcher la souris dessus pour voir l'historique en entier). Ils seront également consultable après coup (comme les autres opérations) dans Outils > Journaux.

## Si la migration échoue

Si la migration a échoué a un moment donné, la première chose à faire est de tenter de la relancer. Si cela ne fonctionne toujours pas, il vous faut [trouver de l'aide](/community/help) (prière de fournir le/les messages correspondants ou tout élément qui vous fait penser que ça n'a pas marché).

## Après la migration

### Vérifier la version de Debian et YunoHost

Pour cela allez dans l'outil de diagnostics ou regardez en bas à droite de la webadmin pour trouver la version de YunoHost.

En ligne de commande vous pouvez utiliser `lsb_release -a` et `yunohost --version`.

### Exécuter les nouvelles migrations

Après la mise à niveau, de nouvelles migrations sont apparues :

- Rebuilding the virtualenvs of your Python apps
- Migrate from PostgreSQL 13 to 15

Vous devez les lancer le plus tôt possible pour garantir le bon fonctionnement de vos applis.

#### Agreeing to the new Terms of Service via command line

YunoHost 12.x now requires that you agree to the new [Terms of Service](https://doc.yunohost.org/terms_of_services/). After reading and accepting them you can run:

```
yunohost tools migrations run 0031_terms_of_services --accept-disclaimer
```

### Vérifiez que le diagnostic ne rapporte pas de problème particulier

Dans l'outil de diagnostics de la webadmin, vérifiez qu'il n'y a pas de problème apparu suite à la migration (par exemple un service qui ne tournerais plus...)

### Vérifiez que les applications fonctionnent

Vérifiez que vos applications installées fonctionnent... Si elles ne fonctionnent pas, il est recommandé de tenter de les mettre à jour. (ou bien de manière générale, il est recommandé de les mettre à jour même si elles fonctionnent !).

Si votre app est cassée et que vous étiez déjà sur la dernière version d'une application, vous pouvez relancer la mise à jour grâce à l'option `--force`:

```bash
yunohost app upgrade --force APP_NAME
```

## Soucis connus après la migration

Veuillez consulter [la FAQ des problèmes de migration](/admin/upgrade/12.0-bookworm/issues_faq/) (en anglais).
