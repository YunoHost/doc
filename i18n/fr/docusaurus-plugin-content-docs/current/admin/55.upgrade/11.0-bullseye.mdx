---
title: 'Migrating from 4.x to 11.x'
---

This page is dedicated to help you migrating an instance from YunoHost 4.4.x (running on Debian Buster/10.x) to YunoHost 11.x (running on Debian Bullseye/11.x). Note: we decided to skip the version numbers from 5 to 10 to follow the Debian version numbers.

## #-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
Notes importantes

- #-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
  #-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
  L'équipe de YunoHost a fait de son mieux pour que cette migration se passe autant en douceur que possible. Elle a été testée durant plusieurs mois et sur plusieurs types d'installations.


- With that said, please be aware that this is a delicate operation. System administration is a complicated topic and covering every particular case is quite hard. Therefore, if you host critical data and services, please [make backups](/admin/backups). And in any case, be patient and attentive during the migration.


- #-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
  #-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
  Ne vous précipitez pas à vouloir faire une réinstallation de votre système en pensant que cela serait "plus simple" (sigh). (Une attitude qui revient régulièrement est de vouloir réinstaller son système à la moindre complication...). À la place, si vous rencontrez des problèmes, nous vous encourageons à investiguer, chercher à comprendre et [trouver de l'aide sur le chat ou le forum](/community/help).


- #-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
  #-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
  **You should watch the known issues at the bottom of this page, to be sure your migrations will work properly.**


## #-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
Procédure de migration

### #-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
Depuis la webadmin
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
Depuis la webadmin

After upgrading to 4.4.x, go to Tools > Migrations to access the migrations interface. You will have to read carefully and accept the disclaimer then launch the migration.

### #-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
Depuis la ligne de commande
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
Depuis la ligne de commande

After upgrading to 4.4.x, run:

```bash
sudo yunohost tools migrations run
```

#-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
puis lisez attentivement l'avertissement et les instructions.

## #-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
Pendant la migration

Depending on your hardware and packages installed, the migration might take up to a few hours.

The logs will be shown in the message bar (you can hover it to see the whole history). They will also be available after the migration (like any other operations) in Tools > Logs.

#-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
Notez que même si vous fermez la page d'admin, la migration continuera (par contre l'interface d'admin sera partiellement indisponible).

### If the migration crashed / failed at some point

If the migration failed at some point, it should be possible to relaunch it. If it still doesn't work, you can try to [get help](/community/help) (please provide the corresponding messages or whatever makes you say that it's not working).

## What to do after the upgrade

### Check that you actually are on Debian Bullseye and YunoHost 11.x

For this, go to Diagnosis (category Base system) or look at the footer of the webadmin. In the command line, you can use `lsb_release -a` and `yunohost --version`.

### Run the migration to repair your python app

After upgrading, your python apps should be unavailable because their virtual environment (venv) needs to be rebuilt.

To do that you can run the pending migrations in `Webadmin > Update`. The apps below won't be automatically repaired, you need to force-upgrade them manually instead with `yunohost app upgrade -F APP`.

Apps which won't be automatically repaired and need a force upgrade:

- calibreweb

- django-for-runners

- ffsync (this app is in python2 and no longer maintained, no guarantee)

- jupiterlab

- librephotos

- mautrix

- mediadrop

- mopidy

- pgadmin

- tracim

- synapse

- weblate


:::tip
If needed, you can disable the automatic rebuild for a specific python app, by removing the dedicated file ending with `.requirements_backup_for_bullseye_upgrade.txt` before applying the migration. You can find this file near the venv (Python virtual environment) of your app inside `/opt` or `/var/www`.
:::

### Check that no issue appeared in the diagnosis

Also in the webadmin Diagnosis section, make sure that no specific issue appeared after running the migration (for example a service that crashed for some reason).

If the service `php7.3-fpm` appears to be dead, you should upgrade your PHP apps like the custom web app. Next, you can run `apt autoremove`.

### #-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
Vérifiez que les applications fonctionnent

#-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
Vérifiez que vos applications installées fonctionnent... Si elles ne fonctionnent pas, il est recommandé de tenter de les mettre à jour. (ou bien de manière générale, il est recommandé de les mettre à jour même si elles fonctionnent !).

#-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
Si votre app est cassée et que vous étiez déjà sur la dernière version d'une application, vous pouvez relancer la mise à jour grâce à l'option `--force`:

```bash
yunohost app upgrade --force APP_NAME
```

## #-#-#-#-#  fr.po (YunoHost documentation VERSION)  #-#-#-#-#
#-#-#-#-#  fr.po (PACKAGE VERSION)  #-#-#-#-#
Soucis connus après la migration

### Can't run the migration due to `libc6-dev : Breaks: libgcc-8-dev issue`

Note: This issue should be resolved in `yunohost_version`: `4.4.2.13`
You have an app that depends on the `build-essential` package.

See this [solution](https://forum.yunohost.org/t/migration-to-11-wont-start-libc6-dev-breaks-libgcc-8-dev/20617/42) to fix it manually

### DNSmasq is not running anymore

We haven't yet found  solution for this issue.

### No ethernet connexion after rebooting following a migration on a Raspberry Pi 4

:::warning
If you have not yet rebooted your server, don't do it (we are looking for a solution). This will avoid you the use of a keyboard and screen.
:::

We found this in the Raspberry Pi documentation

> when the dhcpcd5 package is updated to the latest version (1:8.1.2-1+rpt1 -> 1:8.1.2-1+rpt2), the Raspberry Pi will fail to obtain a DHCP IP address following the next reboot or startup. This problem can be avoided by disabling and re-enabling the "System Options -> Network at Boot" option using the latest raspi-config after the dhcpcd5 package has been updated and prior to the system being shutdown or rebooted

If you are using a Raspberry Pi 4 (or maybe 3), see this [solution](https://forum.yunohost.org/t/aucun-acces-a-internet-suite-a-migration-4-4-to-11-depuis-raspberry-pi-4-pi-400/20652/17)

### Restore ynh4 backup onto a fresh ynh11

If you can't restore your app but your system has been restored, you probably should use the regen conf to fix the nginx issues:

```bash
yunohost tools regenconf nginx --force
```

After that you should be able to restore your apps. Don't forget to force upgrade them if you have 502 errors.
